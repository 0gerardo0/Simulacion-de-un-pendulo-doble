(window.webpackJsonpMsb=window.webpackJsonpMsb||[]).push([[125],{1119:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));function i(){for(var e=o();e&&"LI"!==e.nodeName&&e.parentElement;)e=e.parentElement;return e||void 0}function o(){return document&&document.getElementsByClassName("bw-ScopeItem")&&document.getElementsByClassName("bw-ScopeItem")[0]}function a(){return document&&document.getElementById("bw-Scope_bingatwork_iconDot")}function r(){return document&&document.getElementsByClassName("b_searchboxForm")&&document.getElementsByClassName("b_searchboxForm")[0]}},1374:function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return b})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return p}));var i=n(1538),o=n(526),a=n(692),r=Object(o.a)((function(e,t){return Object(a.a)(e)?Object(i.a)(e,t):[]})),c=n(1357),l=n(477),s=n(376),u=n(427);function d(e){var t;if(e.classList)null===(t=e.classList)||void 0===t||t.remove("bw-ScopeItemHide");else{var n=Object(c.a)(e.getAttribute("class")||""," ");e.setAttribute("class",Object(l.a)(r(n,"bw-ScopeItemHide")," "))}}function b(e){return e.classList?e.classList.contains("bw-ScopeItemHide"):Object(c.a)(e.getAttribute("class")||""," ").indexOf("bw-ScopeItemHide")>0}function m(e){switch(e){case"BookmarkCampaign":return u.c;case"AdminCampaign":return u.b;default:return u.f}}function p(e){switch(e){case"Acronym":return"Acronym";case"Conversation":return"Conversation";case"File":return"File";case"Building":return"Buildings";case"Site":return"Site";case"FloorPlan":return"FloorPlan";case"Person":return"Person";case"Privacy":case"Customization":case"Organization":case"Qna":case"WorkVertical":case"PersonConnect":case"PersonLearn":case"PersonMeet":case"School":case"Assignment":case"Class":case"BookmarkAnswers":case"BookmarkDiscover":case"BookmarkLocate":case"WorkForAdmin":return"None";default:return Object(s.b)(e,"None")}}},1645:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(94),o=n(1566),a=n(93),r=n(1668),c=function(e){return a.createElement(r.a,Object(i.__assign)({},e,{hasDefaultHeightInCollapse:!1,collapsedContentMinHeight:140}))},l=function(e){return a.createElement(r.a,Object(i.__assign)({},e,{hasDefaultHeightInCollapse:!1}))},s=function(){return{entityType:"Acronym",components:{Answer:{MainLine:{Hero:l,Shy:c}}},redux:{selectors:{getResults:o.c,getHeroResult:o.e,getTopCandidates:o.b,getFeedbackSymptom:function(){return"SearchAnswerAcronym"},getExpansion:o.d,getHeader:o.a}}}}},2637:function(e,t,n){e.exports=n.p+"bingchatlogo_4e24c8b4e9075a9aad73984b8db01957.png"},2638:function(e,t,n){
/*!
 * Fuse.js v3.6.1 - Lightweight fuzzy-search (http://fusejs.io)
 * 
 * Copyright (c) 2012-2017 Kirollos Risk (http://kiro.me)
 * All Rights Reserved. Apache Software License 2.0
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 */
e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=n(1),r=n(7),c=r.get,l=(r.deepValue,r.isArray),s=function(){function e(t,n){var i=n.location,o=void 0===i?0:i,a=n.distance,r=void 0===a?100:a,l=n.threshold,s=void 0===l?.6:l,u=n.maxPatternLength,d=void 0===u?32:u,b=n.caseSensitive,m=void 0!==b&&b,p=n.tokenSeparator,f=void 0===p?/ +/g:p,g=n.findAllMatches,v=void 0!==g&&g,h=n.minMatchCharLength,O=void 0===h?1:h,j=n.id,E=void 0===j?null:j,x=n.keys,S=void 0===x?[]:x,C=n.shouldSort,y=void 0===C||C,k=n.getFn,w=void 0===k?c:k,_=n.sortFn,N=void 0===_?function(e,t){return e.score-t.score}:_,L=n.tokenize,M=void 0!==L&&L,T=n.matchAllTokens,I=void 0!==T&&T,F=n.includeMatches,P=void 0!==F&&F,A=n.includeScore,B=void 0!==A&&A,R=n.verbose,D=void 0!==R&&R;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={location:o,distance:r,threshold:s,maxPatternLength:d,isCaseSensitive:m,tokenSeparator:f,findAllMatches:v,minMatchCharLength:O,id:E,keys:S,includeMatches:P,includeScore:B,shouldSort:y,getFn:w,sortFn:N,verbose:D,tokenize:M,matchAllTokens:I},this.setCollection(t),this._processKeys(S)}var t,n;return t=e,(n=[{key:"setCollection",value:function(e){return this.list=e,e}},{key:"_processKeys",value:function(e){if(this._keyWeights={},this._keyNames=[],e.length&&"string"==typeof e[0])for(var t=0,n=e.length;t<n;t+=1){var i=e[t];this._keyWeights[i]=1,this._keyNames.push(i)}else{for(var o=null,a=null,r=0,c=0,l=e.length;c<l;c+=1){var s=e[c];if(!s.hasOwnProperty("name"))throw new Error('Missing "name" property in key object');var u=s.name;if(this._keyNames.push(u),!s.hasOwnProperty("weight"))throw new Error('Missing "weight" property in key object');var d=s.weight;if(d<0||d>1)throw new Error('"weight" property in key must bein the range of [0, 1)');a=null==a?d:Math.max(a,d),o=null==o?d:Math.min(o,d),this._keyWeights[u]=d,r+=d}if(r>1)throw new Error("Total of weights cannot exceed 1")}}},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{limit:!1};this._log('---------\nSearch pattern: "'.concat(e,'"'));var n=this._prepareSearchers(e),i=n.tokenSearchers,o=n.fullSearcher,a=this._search(i,o);return this._computeScore(a),this.options.shouldSort&&this._sort(a),t.limit&&"number"==typeof t.limit&&(a=a.slice(0,t.limit)),this._format(a)}},{key:"_prepareSearchers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=[];if(this.options.tokenize)for(var n=e.split(this.options.tokenSeparator),i=0,o=n.length;i<o;i+=1)t.push(new a(n[i],this.options));return{tokenSearchers:t,fullSearcher:new a(e,this.options)}}},{key:"_search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=this.list,i={},o=[];if("string"==typeof n[0]){for(var a=0,r=n.length;a<r;a+=1)this._analyze({key:"",value:n[a],record:a,index:a},{resultMap:i,results:o,tokenSearchers:e,fullSearcher:t});return o}for(var c=0,l=n.length;c<l;c+=1)for(var s=n[c],u=0,d=this._keyNames.length;u<d;u+=1){var b=this._keyNames[u];this._analyze({key:b,value:this.options.getFn(s,b),record:s,index:c},{resultMap:i,results:o,tokenSearchers:e,fullSearcher:t})}return o}},{key:"_analyze",value:function(e,t){var n=this,i=e.key,o=e.arrayIndex,a=void 0===o?-1:o,r=e.value,c=e.record,s=e.index,u=t.tokenSearchers,d=void 0===u?[]:u,b=t.fullSearcher,m=t.resultMap,p=void 0===m?{}:m,f=t.results,g=void 0===f?[]:f;!function e(t,o,a,r){if(null!=o)if("string"==typeof o){var c=!1,s=-1,u=0;n._log("\nKey: ".concat(""===i?"--":i));var m=b.search(o);if(n._log('Full text: "'.concat(o,'", score: ').concat(m.score)),n.options.tokenize){for(var f=o.split(n.options.tokenSeparator),v=f.length,h=[],O=0,j=d.length;O<j;O+=1){var E=d[O];n._log('\nPattern: "'.concat(E.pattern,'"'));for(var x=!1,S=0;S<v;S+=1){var C=f[S],y=E.search(C),k={};y.isMatch?(k[C]=y.score,c=!0,x=!0,h.push(y.score)):(k[C]=1,n.options.matchAllTokens||h.push(1)),n._log('Token: "'.concat(C,'", score: ').concat(k[C]))}x&&(u+=1)}s=h[0];for(var w=h.length,_=1;_<w;_+=1)s+=h[_];s/=w,n._log("Token score average:",s)}var N=m.score;s>-1&&(N=(N+s)/2),n._log("Score average:",N);var L=!n.options.tokenize||!n.options.matchAllTokens||u>=d.length;if(n._log("\nCheck Matches: ".concat(L)),(c||m.isMatch)&&L){var M={key:i,arrayIndex:t,value:o,score:N};n.options.includeMatches&&(M.matchedIndices=m.matchedIndices);var T=p[r];T?T.output.push(M):(p[r]={item:a,output:[M]},g.push(p[r]))}}else if(l(o))for(var I=0,F=o.length;I<F;I+=1)e(I,o[I],a,r)}(a,r,c,s)}},{key:"_computeScore",value:function(e){this._log("\n\nComputing score:\n");for(var t=this._keyWeights,n=!!Object.keys(t).length,i=0,o=e.length;i<o;i+=1){for(var a=e[i],r=a.output,c=r.length,l=1,s=0;s<c;s+=1){var u=r[s],d=u.key,b=n?t[d]:1,m=0===u.score&&t&&t[d]>0?Number.EPSILON:u.score;l*=Math.pow(m,b)}a.score=l,this._log(a)}}},{key:"_sort",value:function(e){this._log("\n\nSorting...."),e.sort(this.options.sortFn)}},{key:"_format",value:function(e){var t=[];if(this.options.verbose){var n=[];this._log("\n\nOutput:\n\n",JSON.stringify(e,(function(e,t){if("object"===i(t)&&null!==t){if(-1!==n.indexOf(t))return;n.push(t)}return t}),2)),n=null}var o=[];this.options.includeMatches&&o.push((function(e,t){var n=e.output;t.matches=[];for(var i=0,o=n.length;i<o;i+=1){var a=n[i];if(0!==a.matchedIndices.length){var r={indices:a.matchedIndices,value:a.value};a.key&&(r.key=a.key),a.hasOwnProperty("arrayIndex")&&a.arrayIndex>-1&&(r.arrayIndex=a.arrayIndex),t.matches.push(r)}}})),this.options.includeScore&&o.push((function(e,t){t.score=e.score}));for(var a=0,r=e.length;a<r;a+=1){var c=e[a];if(this.options.id&&(c.item=this.options.getFn(c.item,this.options.id)[0]),o.length){for(var l={item:c.item},s=0,u=o.length;s<u;s+=1)o[s](c,l);t.push(l)}else t.push(c.item)}return t}},{key:"_log",value:function(){var e;this.options.verbose&&(e=console).log.apply(e,arguments)}}])&&o(t.prototype,n),e}();e.exports=s},function(e,t,n){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=n(2),a=n(3),r=n(6),c=function(){function e(t,n){var i=n.location,o=void 0===i?0:i,a=n.distance,c=void 0===a?100:a,l=n.threshold,s=void 0===l?.6:l,u=n.maxPatternLength,d=void 0===u?32:u,b=n.isCaseSensitive,m=void 0!==b&&b,p=n.tokenSeparator,f=void 0===p?/ +/g:p,g=n.findAllMatches,v=void 0!==g&&g,h=n.minMatchCharLength,O=void 0===h?1:h,j=n.includeMatches,E=void 0!==j&&j;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={location:o,distance:c,threshold:s,maxPatternLength:d,isCaseSensitive:m,tokenSeparator:f,findAllMatches:v,includeMatches:E,minMatchCharLength:O},this.pattern=m?t:t.toLowerCase(),this.pattern.length<=d&&(this.patternAlphabet=r(this.pattern))}var t,n;return t=e,(n=[{key:"search",value:function(e){var t=this.options,n=t.isCaseSensitive,i=t.includeMatches;if(n||(e=e.toLowerCase()),this.pattern===e){var r={isMatch:!0,score:0};return i&&(r.matchedIndices=[[0,e.length-1]]),r}var c=this.options,l=c.maxPatternLength,s=c.tokenSeparator;if(this.pattern.length>l)return o(e,this.pattern,s);var u=this.options,d=u.location,b=u.distance,m=u.threshold,p=u.findAllMatches,f=u.minMatchCharLength;return a(e,this.pattern,this.patternAlphabet,{location:d,distance:b,threshold:m,findAllMatches:p,minMatchCharLength:f,includeMatches:i})}}])&&i(t.prototype,n),e}();e.exports=c},function(e,t){var n=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;e.exports=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:/ +/g,o=new RegExp(t.replace(n,"\\$&").replace(i,"|")),a=e.match(o),r=!!a,c=[];if(r)for(var l=0,s=a.length;l<s;l+=1){var u=a[l];c.push([e.indexOf(u),u.length-1])}return{score:r?.5:1,isMatch:r,matchedIndices:c}}},function(e,t,n){var i=n(4),o=n(5);e.exports=function(e,t,n,a){for(var r=a.location,c=void 0===r?0:r,l=a.distance,s=void 0===l?100:l,u=a.threshold,d=void 0===u?.6:u,b=a.findAllMatches,m=void 0!==b&&b,p=a.minMatchCharLength,f=void 0===p?1:p,g=a.includeMatches,v=void 0!==g&&g,h=c,O=e.length,j=d,E=e.indexOf(t,h),x=t.length,S=[],C=0;C<O;C+=1)S[C]=0;if(-1!==E){var y=i(t,{errors:0,currentLocation:E,expectedLocation:h,distance:s});if(j=Math.min(y,j),-1!==(E=e.lastIndexOf(t,h+x))){var k=i(t,{errors:0,currentLocation:E,expectedLocation:h,distance:s});j=Math.min(k,j)}}E=-1;for(var w=[],_=1,N=x+O,L=1<<(x<=31?x-1:30),M=0;M<x;M+=1){for(var T=0,I=N;T<I;)i(t,{errors:M,currentLocation:h+I,expectedLocation:h,distance:s})<=j?T=I:N=I,I=Math.floor((N-T)/2+T);N=I;var F=Math.max(1,h-I+1),P=m?O:Math.min(h+I,O)+x,A=Array(P+2);A[P+1]=(1<<M)-1;for(var B=P;B>=F;B-=1){var R=B-1,D=n[e.charAt(R)];if(D&&(S[R]=1),A[B]=(A[B+1]<<1|1)&D,0!==M&&(A[B]|=(w[B+1]|w[B])<<1|1|w[B+1]),A[B]&L&&(_=i(t,{errors:M,currentLocation:R,expectedLocation:h,distance:s}))<=j){if(j=_,(E=R)<=h)break;F=Math.max(1,2*h-E)}}if(i(t,{errors:M+1,currentLocation:h,expectedLocation:h,distance:s})>j)break;w=A}var H={isMatch:E>=0,score:0===_?.001:_};return v&&(H.matchedIndices=o(S,f)),H}},function(e,t){e.exports=function(e,t){var n=t.errors,i=void 0===n?0:n,o=t.currentLocation,a=void 0===o?0:o,r=t.expectedLocation,c=void 0===r?0:r,l=t.distance,s=void 0===l?100:l,u=i/e.length,d=Math.abs(c-a);return s?u+d/s:d?1:u}},function(e,t){e.exports=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[],i=-1,o=-1,a=0,r=e.length;a<r;a+=1){var c=e[a];c&&-1===i?i=a:c||-1===i||((o=a-1)-i+1>=t&&n.push([i,o]),i=-1)}return e[a-1]&&a-i>=t&&n.push([i,a-1]),n}},function(e,t){e.exports=function(e){for(var t={},n=e.length,i=0;i<n;i+=1)t[e.charAt(i)]=0;for(var o=0;o<n;o+=1)t[e.charAt(o)]|=1<<n-o-1;return t}},function(e,t){var n=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},i=function(e){return null==e?"":function(e){if("string"==typeof e)return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(e)},o=function(e){return"string"==typeof e},a=function(e){return"number"==typeof e};e.exports={get:function(e,t){var r=[];return function e(t,c){if(c){var l=c.indexOf("."),s=c,u=null;-1!==l&&(s=c.slice(0,l),u=c.slice(l+1));var d=t[s];if(null!=d)if(u||!o(d)&&!a(d))if(n(d))for(var b=0,m=d.length;b<m;b+=1)e(d[b],u);else u&&e(d,u);else r.push(i(d))}else r.push(t)}(e,t),r},isArray:n,isString:o,isNum:a,toString:i}}])},91:function(e,t,n){"use strict";n.r(t),n.d(t,"init",(function(){return ls}));var i=n(305),o=n.n(i),a=n(112),r=n.n(a),c=n(293),l=n(174),s=n.n(l),u=n(184),d=n.n(u),b=n(191),m=n(132),p=n(729),f=n(93),g=n(386),v=n(795),h=n(268),O=n(103),j=n(420),E=n(161),x=Object(v.a)((function(e,t){return Object(E.K)({frame:{boxShadow:"0 0 0 1px rgba(0,0,0,.05), 0 2px 3px 0 rgba(0,0,0,.1)",width:"452px",borderRadius:"6px",paddingLeft:"20px",paddingBottom:"20px",paddingTop:t?"18px":"24px",display:"flex",flex:"row"},title:[Object(O.o)(e),j.e,{whiteSpace:"normal",fontWeight:"500",wordWrap:"break-word",fontStyle:"normal",fontSize:"18px",color:e.palette.black,lineHeight:"22px",width:"318px",verticalAlign:"top",marginTop:t?"16px":null,marginBottom:"12px"}],qrcode:{marginLeft:t?"25px":"32px",marginTop:t?"30px":"null",marginRight:"20px"},body:[Object(O.o)(e),j.e,{whiteSpace:"normal",fontFamily:O.x,marginTop:"12px",fontWeight:"400",wordWrap:"break-word",fontStyle:"normal",fontSize:"13px",color:e.palette.neutralPrimary,lineHeight:"20px",width:"318px"}],greeting:[Object(O.o)(e),j.e,{whiteSpace:"normal",fontFamily:O.x,fontWeight:"500",fontStyle:"normal",fontSize:"14px",color:e.palette.neutralDark,lineHeight:"20px",width:"100%",marginBottom:"16px"}],boldText:{fontWeight:"bold",color:h.i},container:{marginBottom:"60px"},learnMore:{fontStyle:"normal",fontWeight:"400",fontSize:"13px",lineHeight:"20px",color:e.palette.neutralPrimary},dismissNotification:{marginTop:"5px",textAlign:"right",selectors:{"&:hover":{cursor:"pointer"}}}})})),S=function(e){var t=e.onShown,n=e.useExtendedGreeting,i=e.onCloseClick,o=e.onEngagementClick,a=Object(p.a)(),r=x(a,n),c=Object(g.d)("SerpMobilePromotion",n),l=f.createElement("div",{className:r.greeting},Object(b.Ib)()),s=f.createElement("span",{className:r.title},n&&Object(b.Kb)(),!n&&Object(b.Jb)());return f.useEffect(t,[]),f.createElement(f.Fragment,null,f.createElement("div",{className:r.container},f.createElement("div",{className:r.frame},f.createElement("div",null,n&&l,f.createElement("span",{className:r.title},s),f.createElement("div",{className:r.body},f.createElement("span",{className:r.boldText},Object(b.Gb)()),Object(b.Hb)(),f.createElement("a",{className:r.learnMore,href:"https://spdocs.blob.core.windows.net/search/06-Be-productive-from-anywhere.pdf",target:"_blank",onClick:function(){o()}},Object(b.U)()))),f.createElement("div",{className:r.qrcode},f.createElement("img",{src:c,alt:Object(b.T)()}))),i&&f.createElement("label",{role:"button",onClick:i,onKeyPress:function(e){Object(m.o)(e,i)},className:r.dismissNotification},Object(b.o)())))},C=Object(v.a)((function(e){return Object(E.K)({frame:{boxShadow:"0 0 0 1px rgba(0,0,0,.05), 0 2px 3px 0 rgba(0,0,0,.1)",borderRadius:"6px",paddingBottom:"20px"},headerContent:{display:"inline-flex",fontFamily:O.x,fontStyle:"normal",fontSize:"18px",fontWeight:"500",width:"257px",paddingBottom:"16px",justifyContent:"space-between",paddingTop:"24px",paddingLeft:"20px",paddingRight:"20px"},title:[Object(O.r)(e),j.e,{verticalAlign:"top",lineHeight:"24px",display:"inline-block",color:e.palette.black}],line:{borderBottom:"1px solid ".concat(e.palette.neutralLight)},body:[Object(O.o)(e),j.e,{fontFamily:O.x,color:e.palette.neutralPrimary,lineHeight:"18px",paddingBottom:"10px",paddingLeft:"20px",paddingRight:"20px"}],dismissNotification:{marginTop:"5px",textAlign:"right",selectors:{"&:hover":{cursor:"pointer"}}},header:{height:"44px",paddingLeft:"20px",paddingRight:"20px"},headerText:{fontFamily:O.x,color:e.palette.neutralDark,lineHeight:"20px",fontStyle:"normal",fontSize:"14px",fontWeight:"500",paddingTop:"13px",paddingBottom:"11px",display:"inline-block"},commonButton:[Object(O.o)(e),{display:"block",border:"0",backgroundColor:e.palette.blueMid,color:e.palette.white,height:"32px",minWidth:"161px",borderRadius:"2px",padding:"8px 20px 8px 20px",marginLeft:"20px",textAlign:"center",lineHeight:"16px",selectors:{"&:hover":{cursor:"pointer"}}}]})})),y=function(e){var t=e.onShown,n=e.onCloseClick,i=e.onEngagementClick,o=e.url,a=e.treatmentVariation,r=e.notificationKind,c=Object(p.a)(),l=C(c),s=Object(b.Fb)(r,a),u=f.createElement("button",{className:l.commonButton,role:"button",onClick:function(){i(),window.open(o)},"aria-label":s},s);return f.useEffect(t,[]),f.createElement(f.Fragment,null,f.createElement("div",{className:l.frame},f.createElement("div",{className:l.header},f.createElement("div",{className:l.headerText},Object(b.m)())),f.createElement("div",null,f.createElement("div",{className:l.line})),f.createElement("div",{className:l.headerContent},f.createElement("div",{className:l.title},Object(b.Nb)(r,void 0,void 0,a))),f.createElement("div",{className:l.body},Object(b.Lb)(r,void 0,void 0,void 0,void 0,void 0,a)),o&&u),n&&f.createElement("label",{role:"button",onClick:n,onKeyPress:function(e){Object(m.o)(e,n)},className:l.dismissNotification},Object(b.o)()))},k=n(137),w=n(107),_=n(115),N=n(105),L=n(857),M=n(339),T=n(99),I=n(255),F=n(142),P=n(186),A=n(502),B=n(462),R=n(232),D=n(273),H=function(){var e=Object(T.useSelector)(I.t),t=Object(R.a)("DiscoverabilityPill"),n=t.hasNotificationKind,i=t.notificationConfig,o=Object(R.a)("DiscoverabilityPillSubsequent"),a=o.hasNotificationKind,r=o.notificationConfig,c=Object(R.a)("DiscoverabilityPillFre"),l=c.hasNotificationKind,s=c.notificationConfig,u=Object(D.a)("DiscoverabilityPill","DiscoverabilityPillContainer").logDismissClick;return{isEnabled:l||n||a,activeNotificationKind:l?"DiscoverabilityPillFre":n?"DiscoverabilityPill":"DiscoverabilityPillSubsequent",activeNotificationConfig:l?s:n?i:r,onFirstDismiss:function(){n&&e&&u()}}},W=Object(v.a)((function(){return Object(E.K)({notificationListItem:["ms-search-mainline-notification",{display:"flex",flexDirection:"column"}]})})),z=n(123),K=n(294),Q=n(1868),q=n(765),U=n(460),V=n(108),G=n(1906),J=n(1012),Y=n(1293),X=n(1572),$=n(173),Z=n(210),ee=n(272),te=n(862),ne=n(315),ie=n(400),oe=n(539),ae=n(826),re=n(206),ce=n(153),le=n(1009),se=n(1997),ue=n(189),de=n(118),be=n(433),me=n(355),pe=n(202),fe=Object(v.a)((function(e){return Object(E.K)({card:{padding:"28px 18px 8px 18px"},lastModifiedBy:{fontSize:"13px",fontWeight:"400",lineHeight:"20px",color:e.palette.black},lastModifiedName:{fontSize:"14px"},lastModifiedAt:{fontWeight:"400",fontSize:"11px",lineHeight:"13px",color:e.palette.neutralPrimary},file:{display:"flex",height:"88px",justifyContent:"flex-start",alignItems:"center",padding:"12px",backgroundColor:e.palette.white,boxSizing:"border-box",border:"1px solid #DDDDDD",borderRadius:"6px",cursor:"pointer",userSelect:"text",marginTop:"19px",selectors:{":hover":[{boxShadow:Object(me.f)(e),textDecoration:"none"}]}},iconContainer:{marginRight:"12px",background:e.palette.neutralLighterAlt,height:"64px",width:"64px",borderRadius:"8px"},iconContent:{margin:"12px"},fileContent:[j.g,{display:"flex",flexDirection:"column",justifyContent:"space-around",gap:"4px"}],fileName:[j.g,{fontSize:"14px",color:e.palette.neutralDark,lineHeight:"20px"}],fileUrl:[j.g,{fontSize:"14px",lineHeight:"20px",color:e.palette.green}],footer:{padding:"14px 0px"},link:[Object(pe.x)(e),{marginTop:"14px"}]})})),ge=function(e){var t=e.onEngagementClick,n=e.file,i=e.link,o=e.onFooterClick,a=Object(p.a)(),r=fe(a),c=n.fileName,l=n.lastModifiedByFullName,s=n.lastModifiedTime,u=n.url,d=n.extension,m=n.fileType,g=l?f.createElement(f.Fragment,null,f.createElement("b",null,l),Object(b.G)()):f.createElement(f.Fragment,null,Object(b.q)());return f.createElement("div",{className:r.card},f.createElement("div",{className:r.lastModifiedBy},g),f.createElement("div",{className:r.lastModifiedAt},s),f.createElement("a",{className:r.file,href:u,onClick:function(){t()}},f.createElement("div",{className:r.iconContainer},f.createElement(be.a,{iconSize:40,fileExtension:d,fileType:m,className:r.iconContent})),f.createElement("div",{className:r.fileContent},f.createElement("div",{className:r.fileName},c),u&&f.createElement("div",{className:r.fileUrl},u))),f.createElement("div",{className:r.footer},f.createElement("a",{className:r.link,onClick:function(){null==o||o()},href:i},Object(b.Bb)())))},ve=n(1011),he=n(1841),Oe=n(119),je=n(451),Ee=Object(he.b)((function(e){return Object(E.K)({container:[je.a,Object(Oe.o)(e),{height:"240px",display:"flex",flexDirection:"column",justifyContent:"space-evenly"}],longGhostText:{width:"75%",margin:"0px 19px"},shortGhostText:{width:"25%",margin:"0px 19px"}})})),xe=n(327),Se=Object(ve.a)((function(e){var t=Ee(e.theme),n=f.createElement(xe.a,{lineClassName:t.shortGhostText,numLines:1});return f.createElement("div",{className:t.container},f.createElement("div",null,f.createElement(xe.a,{lineClassName:t.longGhostText,numLines:1}),n),f.createElement(xe.a,{lineClassName:t.longGhostText,numLines:2}),n)})),Ce=n(3016),ye=n(642),ke=n(1573),we=n(402),_e=n(1292),Ne=n(164),Le=Object(v.a)((function(e,t,n){var i;return Object(E.K)({container:{background:e.palette.white,borderRadius:me.a,boxShadow:"0px 0px 0px 1px rgba(0, 0, 0, 0.05), 0px 2px 3px rgba(0, 0, 0, 0.1)"},frame:{height:"4px",borderTopLeftRadius:me.a,borderTopRightRadius:me.a,background:t?n:e.palette.blueMid,selectors:(i={},i[E.h]={"-ms-high-contrast-adjust":"none","forced-color-adjust":"none"},i)}})})),Me=function(e){var t=e.notificationKind,n=e.useAdminTheme,i=e.navBarColor,o=e.onExampleClick,a=e.onFooterClick,r=e.containerName,c=Object(p.a)(),l=Object(k.a)(),s=Object(w.c)(),u=Object(ke.a)(),d=Object(T.useDispatch)(),m=null==u?void 0:u.items,g=null==u?void 0:u.hasFetched,v=Object(w.y)().buildBingWorkVerticalUrl,h=Le(c,n,i),O=f.useState(!1),j=O[0],E=O[1],x=Object(ne.a)(),S=f.useState(-1),C=S[0],y=S[1],_=Object(Ce.a)("RecentFiles",C>=0&&x,["SeeMore"],r,C),N=function(){x&&_.logSecondaryClick("SeeMore"),null==a||a()},L=f.createElement(Se,null),M=v&&v({query:Object(b.V)()||"my files"},void 0,De),I=function(){x?_.logEngagementClick():Object(_e.c)(l,s,"RecentFiles",t.toString(),t),null==o||o()},F=g?Object(de.a)(m)?null:Object(z.a)(Object(ue.a)(m,1),(function(e,t){return f.createElement(f.Fragment,{key:t},f.createElement(ge,{onEngagementClick:I,onFooterClick:N,file:Object(we.a)(e),link:M}))})):L;return f.useEffect((function(){g&&(F?j||(x||Object(Ne.k)(l,s,"RecentFiles",t.toString(),t),y(1),E(!0),d(Object(ye.b)({successExampleType:"RecentFiles"}))):d(Object(ye.a)({disabledExampleType:"RecentFiles"})))}),[g,F]),F?f.createElement("div",{className:h.container},f.createElement("div",{className:h.frame}),F):null},Te=n(144),Ie=Object(v.a)((function(e,t,n,i,o,a,r){var c,l,s,u;return Object(E.K)({mainContainer:{display:"flex",flexDirection:"column",fontFamily:i?void 0:e.fonts.mediumPlus.fontFamily,fontWeight:"400",maxWidth:"440px"},headerRow:{display:"flex",flexDirection:"row",backgroundColor:t?n:e.palette.black,borderTopLeftRadius:me.a,borderTopRightRadius:me.a,paddingLeft:"20px",selectors:(c={},c[E.h]={"-ms-high-contrast-adjust":"none","forced-color-adjust":"none"},c)},masthead:{position:"relative",display:"flex",flexDirection:"column",overflow:"hidden",height:"auto",paddingTop:r?"".concat(r,"px"):"auto",paddingBottom:r?"".concat(r,"px"):"auto",color:e.palette.white,fontSize:"16px",lineHeight:"24px",fontWeight:"700",selectors:(l={},l[".".concat(U.a)]={verticalAlign:"top",minHeight:"".concat(U.b,"px"),maxWidth:"".concat(Te.F,"px"),width:o?"100%":void 0,minWidth:o?"120px":void 0},l)},headerRowRight:{marginLeft:"auto",position:"relative",padding:a?"auto":"13px 19px 0px 0px",selectors:(s={},s[E.h]={"-ms-high-contrast-adjust":"none","forced-color-adjust":"auto"},s)},profilePhoto:{position:a?"absolute":"static",border:a?"4px solid ".concat(t?n:e.palette.black):"none",borderRadius:a?"72px":"auto",marginTop:a?"-10px":"auto",marginLeft:a?"-40px":"auto",backgroundColor:a?t?n:e.palette.black:void 0},subtitleContainer:{padding:"28px 24px 20px 24px"},subtitle:[Object(j.f)(2),{overflow:"hidden",fontSize:"16px",lineHeight:"22px",color:e.palette.neutralDark}],title:[Object(j.f)(3),{overflow:"hidden",fontSize:"24px",lineHeight:"28px",color:e.palette.black,paddingBottom:"8px"}],content:{background:"linear-gradient(122deg, ".concat(t&&n?n+"05":"rgba(229, 235, 255, 0.03)"," 0%, ").concat(t&&n?n+"0d":"rgba(226, 238, 255, 1)"," 99%),\n          linear-gradient(0deg, ").concat(e.palette.white,", ").concat(e.palette.white,")"),boxShadow:"0px 0px 0px 1px rgba(0, 0, 0, 0.05), 0px 2px 3px rgba(0, 0, 0, 0.1)",borderRadius:"0px 0px 6px 6px",paddingBottom:"24px"},privacyContent:{padding:"0px 24px 8px 4px",fontSize:"13px",selectors:(u={},u["#".concat(q.a)]={backgroundColor:"inherit"},u)},fileCard:{padding:"0px 24px 8px 24px"},peopleCard:{padding:"8px 24px 8px 24px"},button:{display:"flex",justifyContent:"center",padding:"0px 24px"},seeMoreButton:[Object(O.o)(e),j.g,{marginTop:"16px",padding:"10px 21px 10px 18px",border:"0",backgroundColor:t?n:e.palette.blueMid,color:e.palette.white,height:"36px",borderRadius:"24px",textAlign:"center",lineHeight:"16px",selectors:{"&:hover":{cursor:"pointer"}}}],seeMoreChevron:{marginLeft:"12px"},dismissNotification:{marginTop:"5px",paddingRight:"16px",textAlign:"right",fontSize:"12px",lineHeight:"15px",color:e.palette.neutralPrimary,selectors:{"&:hover":{cursor:"pointer"}}}})})),Fe=n(1991),Pe=["RecentFiles","RecentPeople"],Ae=function(e){var t=e.onShown,n=e.onCloseClick,i=e.onEngagementClick,o=e.headerHeight,a=Object(p.a)(),r=Object(k.a)(),c=ce.a?Object(J.a)({clickEventId:"Learn_More_Click",eventScope:"Page",impressionEventId:void 0,logCondition:!1}):void 0,l=Object(w.c)(),s=Object($.d)(),u=Object(T.useSelector)(N.L),d=Object(V.a)(),g=Object(Z.b)(),v=Object(Z.e)(),h=Object($.g)(),O=Object(V.e)(h),j=Object(ee.a)(),E=Object(ee.b)(),x=Object(ne.a)(),S=f.useState(!1),C=S[0],y=S[1],_=Object(ee.c)(),L=Object(w.y)().buildBingWorkVerticalUrl,M=Object(T.useSelector)(I.B),F=Object(T.useSelector)(I.n),P=o?(o-U.b)/2:void 0,A=Ie(a,u,g,d,u&&d&&O,M,P),B=Object(X.a)(Pe),R=B.activeTypes,D=B.pendingTypes,H=B.failedTypes,W=Object(K.a)(R,Pe)||0===Object(Q.a)(D,Pe).length;Object(Y.a)(H,"SerpDormantChurn",W);var ue=Object(z.a)(R,(function(e){return{notificationFeatureId:new ae.a(e,"ExampleQuery"),engagementLinkCount:1,dismissLinkCount:0,secondaryClickTypes:"RecentFiles"===e?["SeeMore"]:void 0}})),de=Object(te.a)({containerProps:{containerName:"SerpDormantChurn",dismissLinkCount:0,engagementLinkCount:0},cards:ue},!x);Object(G.a)({name:"SerpDormantChurn",featureKind:"Container",children:[],secondaryTypes:[]},{engagementFeatureEventScope:"Mainline"},x,{oldLoggerSupportProps:{impressionEventId:"SerpDormantChurnContainer_Impression"}});var be=function(e){i(),x||de.logChildEngagementClick(new ae.a(e,"ExampleQuery"),0)};f.useEffect((function(){W&&!C&&(de.logImpression(),y(!0))}),[W,C,de]);var me=j&&_&&f.createElement(ie.a,{fullName:j,photoId:_,size:M?le.c.size72:le.c.size24}),pe=Object(b.Lb)("SerpDormantChurn"),fe=Object(b.Nb)("SerpDormantChurn",void 0,void 0,void 0,void 0,E),ge=L&&L({query:1===F?Object(b.W)()||"my profile":""},void 0,De),ve=Object(b.Fb)("SerpDormantChurn",F);return f.useEffect(t,[]),f.createElement("div",{className:A.mainContainer},f.createElement("div",{className:A.headerRow},f.createElement("div",{className:A.masthead},f.createElement(oe.a,{borderBottom:P,tenantLogoSrc:h,tenantDisplayName:s,textIconColor:v,maxLines:3})),me&&f.createElement("div",{className:A.headerRowRight},f.createElement("div",{className:A.profilePhoto},me))),f.createElement("div",{className:A.content},f.createElement("div",{className:A.subtitleContainer},f.createElement("div",{className:A.title},fe),f.createElement("div",{className:A.subtitle},pe)),f.createElement("div",{className:A.privacyContent},f.createElement(q.b,{tenantName:s,onClickLogger:function(){c?c.clickLogger():Object(re.n)(r,"Learn_More_Click",{clientSize:l,eventScope:"Page"})},isEduEnabled:!1,isLeftAligned:!1})),f.createElement("div",{className:A.fileCard},f.createElement(Me,{notificationKind:"SerpDormantChurn",useAdminTheme:u,navBarColor:g,onExampleClick:function(){return be("RecentFiles")},onFooterClick:function(){i(),x||de.logChildSecondaryClick(new ae.a("RecentFiles","ExampleQuery"),"SeeMore")},containerName:"SerpDormantChurn"})),f.createElement("div",{className:A.peopleCard,id:"b_bfb_NotificationPeopleCard"},f.createElement(Fe.a,{notificationKind:"SerpDormantChurn",maxItems:4,useAdminTheme:u,navBarColor:g,onExampleClick:function(){return be("RecentPeople")},containerName:"SerpDormantChurn"})),f.createElement("div",{className:A.button},f.createElement("button",{className:A.seeMoreButton,role:"button",onClick:function(){i(),window.open(ge)},"aria-label":ve},ve,f.createElement(se.a,{className:A.seeMoreChevron,iconName:"chevronright"})))),n&&f.createElement("label",{role:"button",onClick:n,onKeyPress:function(e){Object(m.o)(e,n)},className:A.dismissNotification},Object(b.o)()))},Be=function(e,t,n,i){return new(n||(n=r.a))((function(o,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function c(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}l((i=i.apply(e,t||[])).next())}))},Re=function(e,t){var n,i,o,a,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof s.a&&(a[d.a]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(r=0)),r;)try{if(n=1,i&&(o=2&c[0]?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){r=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){r.label=c[1];break}if(6===c[0]&&r.label<o[1]){r.label=o[1],o=c;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(c);break}o[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(e){c=[6,e],i=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},De="MSBCRN",He=["MainlineFirstRun","NoConfident","DiscoverabilityPill","DiscoverabilityPillSubsequent"],We=["SerpMobilePromotion","MessageSearch","SerpNonMsbMessage","SerpDormantChurn","AadMsbUpsell"],ze=function(e){var t,n,i,o=e.onHideContainer,a=e.isShownContainer,r=Object(R.a)().hasFetchedNotification,c=Object(k.a)(),l=Object(w.c)(),s=Object(w.y)().buildBingWorkVerticalUrl,u=Object(T.useSelector)(N.L),d=(t=He,n=Object(A.a)(),i=Object(T.useSelector)((function(e){return Object(B.e)(e,t)})),Object(T.useSelector)((function(e){return Object(P.a)(i,(function(t){return Object(F.a)(We,t)&&Object(I.C)(e,t,n)}))}))),m=Object(_.M)(),p=Object(T.useSelector)(I.i),g=Object(T.useSelector)(I.A),v=Object(_.n)(),h=u?48:60,O=W(),j=f.useState(!1),E=j[0],x=j[1],C=f.useState(!1),H=C[0],z=C[1],K=d.length>0?Math.floor(Math.random()*d.length):-1,Q=f.useState(K),q=Q[0],U=Q[1],V=p||(v&&q>=0?d[q]:void 0),G=Object(D.a)(V||"None","MainlineRightRailNotificationContainer",void 0,!0),J=G.logImpression,Y=G.logDismissClick,X=G.logEngagementClick,$=Object(R.a)(V).notificationConfig,Z=Object(T.useSelector)(I.a);if(f.useEffect((function(){q<0&&K>=0&&U(K)}),[q,K]),f.useEffect((function(){r&&z(!0)}),[r]),f.useEffect((function(){V||!H&&v||o()}),[H]),V&&!E){var ee=function(){X()},te=function(){x(!0),o(),Y()},ne=function(){return Be(void 0,void 0,void 0,(function(){return Re(this,(function(e){switch(e.label){case 0:return $&&Object(M.b)(c,$,"Impression"),[4,a()];case 1:return e.sent()&&J(),[2]}}))}))},ie=null;switch(V){case"SerpMobilePromotion":ie=f.createElement(S,{onShown:ne,useExtendedGreeting:g,onCloseClick:te,onEngagementClick:function(){Object(L.a)(c,l,"LearnMore_En_Click",V,"None")}});break;case"MessageSearch":case"SerpNonMsbMessage":var oe=s&&s({query:"*"},m?"Message":"Conversation","MSBCRN",m?"conversations":void 0);ie=f.createElement(y,{onShown:ne,onCloseClick:te,onEngagementClick:ee,url:oe,notificationKind:V});break;case"AadMsbUpsell":var ae=s&&s({query:Object(b.W)()},"Work",2===Z?"MSBCR2":"MSBCR1",void 0);ie=f.createElement(y,{onShown:ne,onCloseClick:te,onEngagementClick:ee,url:ae,treatmentVariation:Z,notificationKind:V});break;case"SerpDormantChurn":ie=f.createElement(Ae,{onShown:ne,onCloseClick:te,onEngagementClick:ee,headerHeight:h});break;default:ie=null}return ie?f.createElement("div",{className:O.notificationListItem,key:V},ie):null}return null},Ke=n(236),Qe=n(1883),qe=n(1242),Ue=function(){return f.createElement(Qe.a,null,f.createElement(Ke.a,{codeLocation:"MainlineRightRailContainer.Bing"},f.createElement(ze,{onHideContainer:qe.d,isShownContainer:qe.e})))},Ve=Object(v.a)((function(e){return Object(E.K)({title:{margin:e?"8px 16px 8px 16px":"20px 0px 12px 24px",fontSize:e?"13px":"16px",lineHeight:e?"":"22px",color:e?"white":"#666666",fontWeight:e?"400":"500"},body:{padding:"0px 24px 20px 24px",fontSize:"14px",lineHeight:"20px",color:e?"white":"#666666"}})})),Ge=function(e){var t=e.title,n=e.body,i=e.isHoverStyle,o=Ve(i);return f.createElement("div",null,(null==t?void 0:t.length)>0&&f.createElement("div",{className:o.title}," ",t," "),(null==n?void 0:n.length)>0&&f.createElement("div",{className:o.body}," ",n," "))},Je=function(e){var t=e.isLowConfidenceQuery,n=e.isEdu,i=t?n?Object(b.zb)():Object(b.yb)():n?Object(b.xb)():Object(b.wb)(),o=t?n?Object(b.vb)():Object(b.ub)():n?Object(b.tb)():Object(b.sb)();return f.createElement(Ge,{title:i,body:o})},Ye=n(163),Xe=Object(v.a)((function(){return Object(E.K)({cancelButton:[Ye.c,{position:"absolute",right:"16px",top:"16px",zIndex:"10",selectors:{"&:hover":{cursor:"pointer"}}}]})})),$e=function(e){var t=e.onCloseClick,n=Xe();return f.createElement(se.a,{className:n.cancelButton,iconName:"cancel",role:"button",onClick:t,onKeyPress:function(e){Object(m.o)(e,t)},tabIndex:0})},Ze=n(260),et=Object(v.a)((function(e,t,n,i,o,a,r){return Object(E.K)({bubbleContainer:{position:"absolute",maxWidth:"364px",width:null!=o?o:"364px",height:null!=i?i:"114px",top:t?"".concat(window.pageYOffset+t.bottom+1+(r||0),"px"):"200px",left:t?"".concat(window.pageXOffset+t.left+7,"px"):"200px",filter:"drop-shadow(0px 4.8px 14.4px rgba(0, 0, 0, 0.1)) drop-shadow(0px 25.6px 57.6px rgba(0, 0, 0, 0.13))",backgroundColor:Object(Ze.a)()?e.palette.white:null!=a?a:e.palette.white,borderRadius:"6px",zIndex:"100"},bubble:{overflow:"hidden",textAlign:"left",borderRadius:"6px",backgroundColor:Object(Ze.a)()?e.palette.white:null!=a?a:e.palette.white},bubbleArrow:["Top"===n?{margin:0,top:"-8px",left:"11px"}:"Left"===n?{margin:"auto 0",top:"calc(50% - 8px)",left:"-8px"}:{margin:"auto 0",top:"calc(50% - 8px)",right:"-8px"},{position:"absolute",transform:"rotate(-45deg)",width:"16px",height:"16px",backgroundColor:Object(Ze.a)()?e.palette.white:null!=a?a:e.palette.white,zIndex:"-1",filter:"drop-shadow(0px 4.8px 14.4px rgba(0, 0, 0, 0.1)) drop-shadow(0px 25.6px 57.6px rgba(0, 0, 0, 0.13))"}]})})),tt=function(e){var t=f.useState(!1),n=t[0],i=t[1],o=e.arrowPosition,a=e.hideCloseButton,r=e.referenceElement,c=e.onDismissClick,l=e.bubbleHeight,s=e.bubbleWidth,u=e.backgroundColor,d=e.offsetTop,b=Object(p.a)(),m=null==r?void 0:r.getBoundingClientRect(),g=et(b,m,o,l,s,u,d),v=!a&&f.createElement($e,{onCloseClick:function(){i(!0),c()}});return n?f.createElement(f.Fragment,null):f.createElement("div",{className:g.bubbleContainer,"data-priority":"2"},f.createElement("div",{className:g.bubbleArrow}),f.createElement("div",{className:g.bubble},v,e.children))},nt=n(1119),it=n(1374),ot=Object(v.a)((function(e){return Object(E.K)({text:{margin:"20px 24px 20px 24px",fontSize:"16px",lineHeight:"22px",color:e.palette.neutralPrimary,fontWeight:"500"}})})),at=function(e){var t=e.tenantDisplayName,n=e.tenantFriendlyName,i=n||t,o=Object(b.rb)({tenantName:i}),a=Object(p.a)(),r=ot(a);return f.createElement("div",null,(null==o?void 0:o.length)>0&&f.createElement("div",{className:r.text}," ",o," "))},rt=function(){var e=Object($.d)(),t=Object($.e)(),n=Object(nt.c)(),i=Object(T.useSelector)(I.G),o=f.useState(i),a=o[0],r=o[1];return i||(null==n||n.addEventListener("mouseenter",(function(){r(!0)})),null==n||n.addEventListener("mouseleave",(function(){r(!1)}))),f.useEffect((function(){if(i){var e=setTimeout((function(){r(!1)}),5e3);return function(){return clearTimeout(e)}}}),[]),a?f.createElement(tt,{referenceElement:ut(),offsetTop:dt()?-112:0,arrowPosition:"Top",bubbleHeight:"0",bubbleWidth:"undefined",hideCloseButton:!0,onDismissClick:function(){}},f.createElement(at,{tenantDisplayName:e,tenantFriendlyName:t})):null},ct=function(e){var t=e.isLowConfidenceQuery,n=e.isEdu,i=t?n?Object(b.zb)():Object(b.yb)():n?Object(b.xb)():Object(b.wb)();return f.createElement(Ge,{title:i,body:"",isHoverStyle:!0})},lt=function(){var e=Object(k.a)(),t=Object(nt.c)(),n=Number(null===localStorage||void 0===localStorage?void 0:localStorage.getItem("ScopeTabOverlayHoverImpressionCount")),i=f.useState(!1),o=i[0],a=i[1],r=f.useState(n<=3),c=r[0],l=r[1],s=Object(D.a)("ScopeTabOverlayHover","ScopeTabToolTipContainer",void 0,!0,!1).logImpression,u={notificationKind:"ScopeTabOverlayHover",notificationCampaign:"None"},d=function(){Object(M.b)(e,u,"Impression"),s(),localStorage.setItem("ScopeTabOverlayHoverImpressionCount",(n+1).toString()),m(),l(!1),a(!1)},b=function(){a(!0)},m=function(){null==t||t.removeEventListener("mouseenter",b),null==t||t.removeEventListener("mouseleave",d)},p=Object(_.t)();return f.useEffect((function(){c?(null==t||t.addEventListener("mouseenter",b),null==t||t.addEventListener("mouseleave",d),l(!1)):m()}),[c]),o?f.createElement(tt,{referenceElement:ut(),offsetTop:dt()?-112:0,bubbleHeight:"36px",bubbleWidth:"190px",arrowPosition:"Top",hideCloseButton:!0,backgroundColor:"#666666",onDismissClick:function(){}},f.createElement(ct,{isLowConfidenceQuery:!1,isEdu:p})):null},st=function(){var e=f.useState(!1),t=e[0],n=e[1],i=f.useState(!1),o=i[0],a=i[1],r=f.useState(!1),c=r[0],l=r[1],s=f.useState(!1),u=s[0],d=s[1],b=Object(k.a)(),m=Object(R.a)("ScopeTab"),p=m.hasNotificationKind,g=m.notificationConfig,v=Object(R.a)("WorkScopeDotChurn"),h=v.hasNotificationKind,O=v.notificationConfig,j=Object(R.a)("ScopeTabOverlay"),E=j.hasNotificationKind,x=j.notificationConfig,S=Object(R.a)("ScopeTabFriendlyName"),C=S.hasNotificationKind,y=S.notificationConfig,w=Object(A.a)(),N=Object(A.b)(),L=!w&&!N,F=Object(T.useSelector)(I.z),P=Object(T.useSelector)(I.E),B=Object(T.useSelector)(I.F),H=Object(T.useSelector)(I.H),W=Object(T.useSelector)(I.G),z=Object(T.useSelector)(I.J),K=h&&P?"WorkScopeDotChurn":"ScopeTab",Q="WorkScopeDotChurn"===K?O:g,q=Object(D.a)(K,"ScopeTabNotificationContainer",void 0,!0),U=q.logImpression,V=q.logEngagementClick,G=Object(D.a)("ScopeTabOverlay","ScopeTabNotificationContainer",void 0,!0),J=G.logImpression,Y=G.logEngagementClick,X=G.logDismissClick,$=Object(D.a)("ScopeTabFriendlyName","ScopeTabNotificationContainer",void 0,!0),Z=$.logImpression,ee=$.logEngagementClick,te=Object(nt.c)(),ne=Object(nt.b)(),ie=ne&&!Object(it.c)(ne),oe=te&&ne&&(h&&P||p&&!(F&&w)),ae=te&&(ie||oe)&&(L||!z)&&E,re=te&&C&&!w,ce=function(){V(!0)},le=function(){Y(!0)},se=function(){ee()},ue=function e(){Z(),d(!0),null==te||te.removeEventListener("mouseenter",e)},de=Object(_.t)();return f.useEffect((function(){oe&&(Object(it.d)(ne),t?te.addEventListener("click",ce):(Q&&Object(M.b)(b,Q,"Impression"),U(),n(!0)))}),[te,oe,t]),f.useEffect((function(){ae&&(o?te.addEventListener("click",le):(x&&Object(M.b)(b,x,"Impression"),J(),a(!0)))}),[te,ae,o]),f.useEffect((function(){re&&(W&&y?Object(M.b)(b,y,"Impression"):y&&te.addEventListener("mouseenter",(function(){return Object(M.b)(b,y,"Impression")})),H&&y&&(u&&te.addEventListener("click",se),W?c||(Z(),l(!0),d(!0)):te.addEventListener("mouseenter",ue)))}),[te,u,H,re,W]),ae?f.createElement(f.Fragment,null,f.createElement(tt,{referenceElement:ut(),offsetTop:dt()?-112:0,arrowPosition:"Top",onDismissClick:X},f.createElement(Je,{isLowConfidenceQuery:w,isEdu:de}))):B&&(ie||oe)?f.createElement(lt,null):re&&H?f.createElement(rt,null):null};function ut(){return document&&document.getElementById("b-scopeListItem-bingatwork")&&document.getElementById("b-scopeListItem-bingatwork")||void 0}function dt(){return document&&document.getElementById("b_sydHeadBg")&&document.getElementById("b_sydHeadBg")||void 0}var bt=n(2732),mt=window.BingAtWork.Mainline;window.BingAtWork.Ribbon;function pt(e,t){mt&&mt.showOrHide(!0,e,mt.hideLoadingState,!1,t)}function ft(e,t,n){mt&&mt.showOrHide(!1,e,mt.hideLoadingState,null==t||t,n)}function gt(){mt&&mt.hideLcgLoadingState()}var vt=n(735),ht=n(338),Ot=n(285),jt=n(149),Et=n(1531),xt=n(767),St=n(961),Ct=n(2264),yt=n(584),kt=n(490),wt=n(124),_t=n(158),Nt=n(208),Lt=n(212),Mt=["EmployeeOffer"],Tt={EmployeeOffer:3},It=Object(v.a)((function(e,t,n,i,o,a){if(e&&!t)return{shownDomainResultsCount:[]};var r,c=i&&o?3:2,l=Object(ue.a)(i&&i.candidates,c);if(i){var s=Object(_t.a)(n,(function(e){return e.domain===i.domain})),u=Bt(i.domain,null==s?void 0:s.resultsCount);c=o&&!u?3:2,l=Object(ue.a)(l,u?0:c);var d=u?0:Object(Nt.a)(l);if(s&&s.resultsCount&&s.resultsCount>d&&!Rt(s.domain,a)){var b=Object(ue.a)(Object(P.a)(n,(function(e){return e.domain!==i.domain})),c-1);r=u?[s].concat(b):[s]}else r=Object(ue.a)(Object(P.a)(n,(function(e){return e.domain!==i.domain})),c-d)}else r=Object(ue.a)(n,c);return{shownCandidates:i&&{domain:i.domain,candidates:l},shownDomainResultsCount:r}})),Ft=Object(v.a)((function(e,t){return!Object(de.a)(e&&e.candidates)||Object(Lt.a)(t,(function(e){return!!e.resultsCount&&e.resultsCount>0}))})),Pt=Object(v.a)((function(e){return!!e&&Object(F.a)(Mt,e)})),At=Object(v.a)((function(e){return Pt(e)?2:1})),Bt=Object(v.a)((function(e,t){var n=Tt[e];return!(!n||!t)&&t<=n}));function Rt(e,t){return"Acronym"===e||!!t&&"Bookmark"===e}var Dt=n(151),Ht=n(447),Wt=n(254),zt=function(){var e=Object(w.c)(),t=Object(k.a)(),n=f.useState(Object(Ct.d)())[0],i=Object(xt.a)(),o=Object(Wt.a)(i),a=Object(yt.a)(),r=Object(A.b)(),c=Object(A.a)(),l=Object(T.useSelector)((function(e){return Object(wt.e)(e)})),s=Object(kt.a)({domain:l,isHero:!1}),u=At(l);return f.useEffect((function(){var d;if("EmployeeOffer"===l&&Object(de.a)(o)&&!Object(de.a)(i)){if(r){var b=Object(ue.a)(i,u);Object(z.a)(b,(function(n,i){Object(Ne.p)(t,l,!0,e,i,n.queryType)})),i&&(null==i?void 0:i.length)>u&&Object(Ne.p)(t,l,!1,e,u)}else c||Object(Ne.u)(t,i,"Tile_Carousel_Offer_Impression","Tile",e,!0);(null===(d=null===ce.a||void 0===ce.a?void 0:ce.a.flightParams)||void 0===d?void 0:d.isSharedLoggerEnabled)?Object(St.a)({entities:Object(z.a)(Object(Et.a)(i,null==i?void 0:i.length),(function(e){return Object(Dt.b)(e,s,"EmployeeOffer")})),loggerProps:{layout:{entity:{isAnswer:!1,cardType:"Tile"}},position:1},oldLoggerSupport:{impressionEventId:void 0}},r||c?"Mainline_RichPill_Impression":"Tile_Carousel_Offer_Impression",!1):Object(Ht.i)({logger:t,entities:Object(Et.a)(i,null==i?void 0:i.length),domain:l,isHero:!1,traceId:s,latency:n.calculateEndTime().duration,eventId:r||c?"Mainline_RichPill_Impression":"Tile_Carousel_Offer_Impression",layoutProps:{childPlacementType:"Hidden"}}),Object(Ne.q)(t,e,a,"None")}}),[t,e,i,o,l,a,c,r]),null},Kt=n(2341),Qt=n(1296),qt=n(500),Ut=n(169),Vt=n(643),Gt=n(252),Jt=function(){return Promise.all([n.e(1),n.e(8),n.e(169)]).then(n.bind(null,3356)).then((function(e){return{default:e.NotificationSlidingBar}}))},Yt=function(e){return Object(Gt.b)(Jt,{chunkName:"serpfre"},Object(k.a)())(e)},Xt=function(){return n.e(134).then(n.bind(null,3355)).then((function(e){return{default:e.NotificationSlidingBarVNext}}))},$t=function(e){return Object(Gt.b)(Xt,{chunkName:"mobilefre"},Object(k.a)())(e)},Zt=function(e){var t=e.profileButton,n=e.isMobile,i=e.hideTeaser,o=Object(k.a)(),a=Object(yt.b)(),r=Object(T.useSelector)(Ot.b),c=Object(T.useDispatch)(),l=Object(_.t)(),s=Object(R.a)("MainlineFirstRun"),u=s.hasNotificationKind,d=s.notificationConfig,m=Object(qt.c)(),p=Object(T.useSelector)(wt.k),g=Object(T.useSelector)(N.L),v=Object(T.useSelector)(I.r),h=Object(Ut.a)(),O=Object(Z.e)(),j=Object(Z.b)(),E=h.searchOptions.buildBingWorkVerticalUrl,x=Object(T.useSelector)(I.u),S=Object(T.useSelector)(I.f),C=Object(T.useSelector)(I.l),y=Object(D.a)("MainlineFirstRun","MainlineFirstRunNotificationContainer",r,!0),w=function(){d&&Object(M.b)(o,d,"Impression"),y.logImpression()},L=null==d?void 0:d.notificationCampaign,F=0;"RetentionCampaign"===L&&(F=C);var P=Object(T.useSelector)(I.d),A=Object(T.useSelector)(jt.d),B="Person"===A&&P>0;if(!u||i)return f.createElement(f.Fragment,null,t);var H=!n&&v&&!l&&("SearchCampaign"===L||"EduCampaign"===L),W=Object(it.a)(L||""),z=!a||H,K=function(){y.logEngagementClick(),z&&E&&p?window.location.href=E({query:p},void 0,W):c(Object(Vt.a)({isTourOpen:!0}))},Q=Object(b.Mb)(L,F,l,B,P,A,n,x?S:0),q=f.createElement(f.Fragment,null,Q);return n?f.createElement($t,{notificationKind:"MainlineFirstRun",message:q,logImpression:w,onClick:K,shouldAnimate:m,isAdminThemeEnabled:g,navBarColor:j}):f.createElement(Yt,{notificationKind:"MainlineFirstRun",profileButton:t,message:Q,logImpression:w,onClick:K,shouldAnimate:m,isAdminThemeEnabled:g,textIconColor:O,disableProfileImage:x})},en=n(835);function tn(e){var t=Object(en.c)(e);return t&&t.provenance}var nn=n(376),on=n(1181),an=n(532),rn=n(2761),cn=n(2728),ln=n(2738),sn=n(407),un=n(1348),dn=n(655),bn=n(1335),mn=n(94),pn=n(768),fn=n(782),gn=n(2782),vn=n(1338),hn=n(148),On=n(251),jn=n(434),En=n(1081),xn=n(337),Sn=n(150),Cn=Sn.h,yn={boxSizing:"border-box",width:"".concat(120,"px"),height:"".concat(Cn,"px"),borderRadius:me.a},kn=Object(he.b)((function(e,t,n,i){return Object(E.K)({scopeCardFrame:[Object(Oe.f)(e),yn,{borderBottom:t?"4px solid ".concat(n):void 0,backgroundColor:e.palette.white,cursor:i?"pointer":void 0,padding:"8px",selectors:{":hover":t?void 0:{boxShadow:Object(Oe.j)(e)}}}]})})),wn=n(280),_n=n(226),Nn=n(147),Ln=n(589),Mn=n(1866),Tn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onKeyPress=function(e){Object(m.o)(e,t.props.onClick)},t}return Object(mn.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.ariaLabel,n=e.className,i=e.isSelected,o=e.selectionAccentColor,a=e.onClick,r=e.theme,c=e.children,l=kn(r,i,o,!!a);return f.createElement("div",{role:"button",className:Object(Mn.a)(l.scopeCardFrame,n),onClick:a,onKeyPress:this.onKeyPress,"aria-label":t,"aria-expanded":i,tabIndex:0},c)},t}(f.Component),In=Object(ve.a)(Tn),Fn=Object(he.b)((function(e,t,n,i){var o=n===Te.J||n===Te.E;return Object(E.K)({circleContainer:{margin:"12px 0 17px",height:"72px",textAlign:"center"},circle:{display:"inline-block",width:"72px",height:"72px",border:"1px solid ".concat(e.palette.neutralQuaternaryAlt),borderRadius:"50%",backgroundColor:e.palette.white},icon:[o?Ye.h:Ye.g,{position:"relative",top:o?"16px":"20px",display:"inline-block",color:i||t},{selectors:{svg:{selectors:{"> path":{fill:i||t}}}}}],title:[Object(O.n)(e),j.j],detail:[m.b,Object(pe.j)(e),j.j,{marginTop:"2px",height:"68px",whiteSpace:"normal"}]})})),Pn=function(e){var t=e.className,n=e.title,i=e.subtitle,o=e.tenantThemeColor,a=e.iconName,r=e.iconColorOverride,c=e.isSelected,l=e.onClick,s=Object(p.a)(),u=Fn(s,o,a,r);return f.createElement(In,{ariaLabel:Object(Nn.w)({scopeCardTitle:n}),className:t,isSelected:c,selectionAccentColor:o,onClick:l},f.createElement("div",{className:u.circleContainer},f.createElement("div",{className:u.circle},a&&f.createElement(se.a,{className:u.icon,iconName:a}))),f.createElement("div",{className:u.title},n),f.createElement("div",{className:u.detail},i))},An=n(431),Bn=n(200),Rn=n(336),Dn=n(221),Hn=n(239),Wn=n(170),zn=n(483),Kn=n(947),Qn=n(100),qn=n(1835),Un=n(799),Vn=(Object(Qn.declareStringWithPlaceholders)("search-hostapp.search.expandableScopeCard.countWithPlus")),Gn=(Object(Qn.declareStringWithPlaceholders)("search-hostapp.search.expandableScopeCard.domainCountSummary")),Jn=n(423),Yn=n(590),Xn="-".concat("10px"),$n=Object(v.a)((function(e,t){var n;return Object(E.K)({scopeCardSummaryWrapper:{display:"inline-block",verticalAlign:"top",position:"relative",pointerEvents:t?"none":void 0},scopeCardContentWrapper:{display:"inline-block",verticalAlign:"top",position:"relative",marginBottom:"-".concat(me.h+Yn.b,"px"),marginLeft:"".concat(-120,"px"),pointerEvents:t?void 0:"none"},seeMoreLink:{float:"right"},footerContentWrapper:{paddingTop:"16px"},privacyInfoButton:{position:"absolute",top:"4px",right:"4px",cursor:"pointer",selectors:(n={i:{color:e.palette.black}},n[".".concat(Jn.b)]={marginTop:Xn,marginRight:Xn,padding:"10px"},n[".".concat(Jn.c)]={marginTop:Xn},n)},scopeContentCollapseButton:{position:"absolute",top:"20px",right:"20px"},privacyMessage:{marginBottom:"8px"}})})),Zn=n(646),ei=n(849),ti=n(159),ni=n(848),ii=Object(v.a)((function(e,t){var n=[Object(Ye.j)("".concat((t-2)/2,"px")),{position:"absolute",fontWeight:800}];return Object(E.K)({arrowExpansionButton:[ni.a,{height:"".concat(t,"px"),width:"".concat(t,"px"),color:e.palette.neutralPrimaryAlt,cursor:"pointer"}],topIcon:[n,{top:0,right:0}],bottomIcon:[n,{bottom:0,left:0,transform:"rotate(180deg)"}]})})),oi=function(e){var t=e.isExpanded,n=e.onSetExpanded,i=e.size,o=e.className,a=e.ariaLabel,r=f.useCallback((function(){n(!t)}),[t,n]),c=Object(p.a)();if(!t)return null;var l=ii(c,i);return f.createElement("button",{"aria-label":a,"aria-expanded":t,tabIndex:0,className:Object(Mn.a)(o,l.arrowExpansionButton),onClick:r},f.createElement(se.a,{className:l.topIcon,iconName:"ArrowDownRightMirrored8"}),f.createElement(se.a,{className:l.bottomIcon,iconName:"ArrowDownRightMirrored8"}))},ai=n(1378),ri=n(453),ci=f.forwardRef((function(e,t){var n=e.title,i=e.resultCountSubTitle,o=e.breadCrumbSubTitle,a=e.items,r=e.renderItem,c=e.footerContent,l=e.expansionButtonAriaLabel,s=e.hideTenantBranding,u=e.onExpansionButtonClick,d=e.hideExpansionArrows,b=e.onTitleClick,m=e.titleHref,g=e.processedQuery,v=e.verticalTitle,h=e.noListTitle,O=e.isSmall,j=e.isMiniSerp,E=e.isTitleDisabled,x=e.privacyMessageNode,S=e.isEduEnabled,C=Object(p.a)(),y=Object(ri.f)(C,s,O),k=Object(Nn.l)(g,n);f.useEffect((function(){ti.a.capturePerformance({currentComponent:"ScopeContentList.web"})}),[]);var w={title:k,resultCountSubTitle:i,onTitleClick:b,titleHref:m,verticalTitle:v||n,breadcrumbs:!j,isSmall:O,isEduEnabled:S},_=h?f.createElement("h2",{className:y.title},n):f.createElement(ai.a,Object(mn.__assign)({},w));return f.createElement(f.Fragment,null,!s&&f.createElement(vt.a,null),f.createElement("div",{ref:t,className:y.scopeContentList},!d&&u&&f.createElement(oi,{ariaLabel:l,className:y.scopeContentCollapseButton,size:16,isExpanded:!0,onSetExpanded:u}),E?x:_,o&&f.createElement("h3",{className:y.textSubTitle},o),Object(z.a)(a,(function(e,t){return f.createElement("div",{key:t,className:y.listItem},r(e,t))})),c))})),li=n(204),si=Object(v.a)((function(){return Object(E.K)({expandable:{paddingBottom:"".concat(me.h+Yn.b,"px")}})})),ui=function(e){var t=Object(li.a)("ExpandableScopeCardContent"),n=t[0],i=t[1],o=e.isVisible,a=e.scopeContentListProps,r=si();return f.createElement(Zn.a.Provider,{value:{isTabStopEnabled:o}},f.createElement(ei.a,{className:r.expandable,duration:500,isExpanded:o,initialHeight:Cn,initialWidth:120,expandedWidth:o?i.offsetWidth:120,expandedHeight:o?i.offsetHeight:Cn,transitionTimingFunction:di},f.createElement(ci,Object(mn.__assign)({},a,{ref:n}))))},di="cubic-bezier(0.3,0.55,0.1,1.0)",bi=Object(Ln.c)(500,di),mi=Object(Ln.b)(500,di),pi=function(e){var t=e.showSeeMoreLink,n=e.seeMoreLinkText,i=e.query,o=e.domain,a=e.isSelected,r=e.showMediumExpansionButton,c=e.isMediumExpanded,l=e.onExpandLinkClick,s=e.onSeeMoreLinkClick,u=Object(p.a)(),d=$n(u,a);return f.createElement("div",{className:d.footerContentWrapper},r&&f.createElement(xn.a,{isExpanded:!c,onClick:l}),t&&i&&f.createElement(wn.a,{iconName:"ChevronRight",url:Object(Dn.a)(i,o),className:d.seeMoreLink,onClick:s,text:n||Object(Nn.C)()}))},fi=Object(T.connect)((function(e,t){var n=t.domain,i=t.title,o=t.conversationProvenance,a=t.seeMoreLinkQueryOverride;return{isSelected:Object(Hn.q)(e,n,i),isMediumExpanded:Object(Hn.i)(e,n,o),query:a||Object(N.w)(e),userUpn:Object(Wn.n)(e)}}),(function(e,t){return{toggleSelectScopeCardActions:function(n,i){var o=t.domain,a=t.title,r=t.conversationProvenance;e(Object(Bn.p)({source:"UserExplicit",selectedScopeCardDomain:n?o:void 0,selectedConnectorProvenance:"Connectors"===o&&n?a:void 0,selectedConversationProvenance:r})),e(Object(Bn.r)({elementId:n?i:void 0}))},setIsMediumExpanded:function(t){e(Object(Bn.u)({isMediumExpanded:t}))},scrollToCardAction:function(t){e(Object(Bn.r)({elementId:t}))},setCarouselScrollTargetToCarousel:function(){return e(Object(Bn.s)())}}}))(Object(Rn.a)((function(e){var t=e.items,n=e.className,i=e.domain,o=e.conversationProvenance,a=e.title,r=e.shortTitle,c=e.isSelected,l=e.isMediumExpanded,s=e.scrollToCardAction,u=e.renderScopeListItem,d=e.seeMoreLinkText,b=e.query,m=e.userUpn,g=e.tenantThemeColor,v=e.toggleSelectScopeCardActions,h=e.setIsMediumExpanded,O=e.setCarouselScrollTargetToCarousel,j=e.isFirstItemEnhanced,E=e.isHero,x=e.impressionEventId,S=e.clickEventId,C=e.groupClickEventId,y=e.traceId,N=e.eventScope,L=e.scopeContentListLoggerProps,M=Object(Nt.a)(t),I=Object(En.a)();f.useEffect((function(){c&&s(I)}),[c]);var F=Object(p.a)(),P=Object(zn.d)(i,M,"List",l,j),A=P.shownCount,B=P.showSeeMoreLink,R=function(e,t,n){var i=String(e),o=t?Vn({count:i}):String(i);if("Turing"===n||"PowerBi"===n||"Connectors"===n)return Object(Nn.u)({count:e,showPlus:t});var a=Object(qn.a)(Object(Un.a)(n,void 0,1===e&&!t));return Gn({countWithOptionalPlus:o,domainStr:a})}(A,B,i),D=$n(F,c),H=Object(zn.c)(i),W=Object(zn.b)(i),z=Object(w.c)(),K=Object(k.a)(),Q=Object(T.useSelector)((function(e){return Object(wt.i)(e,i)})),q=Object(An.d)({entities:t,domain:i,isHero:!!E,impressionEventId:x,clickEventId:S,cardType:"Scope",traceId:y,eventScope:N,layoutProps:Object(mn.__assign)({childPlacementType:c?"Visible":"Partial"},L)}),U={title:r||a,subtitle:R,iconName:H,iconColorOverride:W,tenantThemeColor:g,isSelected:c,onClick:function(){v(!c,I),q.nonEntityActions.onSearchActionClick(C)}},V=Object(_.t)(),G=c?mi:bi,J=c?bi:mi,Y=f.useCallback((function(){v(!1,I);var e=I&&document.getElementById(I);e&&e.offsetLeft+120<document.documentElement.clientWidth&&O()}),[v,O,I]),X=function(e,t){q.entityActions.onEntityClick(e,void 0,{url:t,clientSize:z},"File_Modifier_Profile_Click")},$=f.useCallback((function(e){h(!e)}),[]);if(0===M)return null;var Z=j?M>1:M>zn.a,ee=f.createElement(pi,{query:b,domain:i,showSeeMoreLink:B,seeMoreLinkText:d,conversationProvenance:o,userUpn:m,isSelected:c,showMediumExpansionButton:Z,isMediumExpanded:l,onExpandLinkClick:$,onSeeMoreLinkClick:function(){var e;(null===(e=ce.a.flightParams)||void 0===e?void 0:e.isDeprecateOldLoggerEnabled)?q.nonEntityActions.onSearchActionClick("ScopeCard_SeeMore_Click",{eventScope:Object(Kn.a)(i),target:"ScopeCard"}):Object(re.m)(K,i,z)}}),te=Object(_n.b)(Object(Nn.w)({scopeCardTitle:a}),Object(Nn.e)()),ne={title:a,items:Object(ue.a)(t,A),footerContent:ee,renderItem:function(e,t){return u(e,t,(function(){return q.entityActions.onEntityClick(e,t)}),(function(n){return q.entityActions.onActionClick(e,n,t)}),Y,(function(e,t){return q.entityActions.onEntityClick(e,void 0,void 0,t)}),X)},expansionButtonAriaLabel:te,hideTenantBranding:!c,onExpansionButtonClick:Y,processedQuery:Q,isEduEnabled:V};return f.createElement(Ke.a,{codeLocation:"ExpandableScopeCard.".concat(i)},f.createElement("li",{id:I,className:Object(Mn.a)(n,"ms-search-scopeCard")},f.createElement("div",{className:Object(Mn.a)(D.scopeCardSummaryWrapper,G)},f.createElement(Pn,Object(mn.__assign)({},U))),f.createElement("div",{className:Object(Mn.a)("ms-search-scopeCardContent",D.scopeCardContentWrapper,J)},f.createElement(ui,{isVisible:c,scopeContentListProps:ne}))))}))),gi=n(618),vi=n(461),hi=n(548),Oi=n(609),ji=n(621),Ei=n(1309),xi=function(e){var t=Object(Ei.a)(),n=e.className,i=e.isSmall,o=e.onClickLearnMore;return f.createElement(ji.a,{className:n,message:t,isSmall:i,onClickLearnMore:o})},Si=n(417),Ci=function(e){var t=Object(Si.b)(),n=e.className,i=e.isSmall,o=e.onClickLearnMore;return f.createElement(ji.a,{className:n,message:t,isSmall:i,onClickLearnMore:o})},yi=n(2402),ki=n(353),wi=function(e){var t=Object(ki.j)(),n=e.className,i=e.isSmall,o=e.onClickLearnMore;return f.createElement(ji.a,{className:n,message:t,isSmall:i,onClickLearnMore:o})},_i=n(381),Ni=function(e){var t=Object(_i.e)(),n=e.className,i=e.isSmall,o=e.onClickLearnMore;return f.createElement(ji.a,{className:n,message:t,isSmall:i,onClickLearnMore:o})},Li=function(e){var t=e.domain,n=e.className,i=e.isSmall,o=e.onClickLearnMore;switch(t){case"File":return f.createElement(yi.a,{className:n,isSmall:i,onClickLearnMore:o});case"Site":return f.createElement(Ni,{className:n,isSmall:i,onClickLearnMore:o});case"Connectors":return f.createElement(xi,{className:n,isSmall:i,onClickLearnMore:o});case"Message":return f.createElement(Ci,{className:n,isSmall:i,onClickLearnMore:o});case"PowerBi":return f.createElement(wi,{className:n,isSmall:i,onClickLearnMore:o});default:return null}};function Mi(e){return"EducationAssignment"===e}var Ti="-".concat("10px"),Ii=Object(v.a)((function(e,t){var n,i,o;return Object(E.K)({scopeCardContentWrapper:{display:"inline-block",verticalAlign:"top",position:"relative",marginBottom:t?"0px":"-".concat(me.h+Yn.b,"px"),selectors:(n={},n[".".concat(ri.a)]={border:"none",borderRadius:"unset"},n),width:"100%"},noResults:{margin:"0px 24px 16px",selectors:(i={},i[".".concat(gi.c)]={fontSize:"16px"},i)},privacyInfoButton:{position:"absolute",top:"4px",right:"4px",cursor:"pointer",selectors:(o={i:{color:e.palette.black}},o[".".concat(Jn.b)]={marginTop:Ti,marginRight:Ti,padding:"10px"},o[".".concat(Jn.c)]={marginTop:Ti},o)},privacyMessage:{marginBottom:"8px"}})})),Fi=function(e){var t=e.items,n=e.domain,i=e.title,o=e.showSubTitle,a=void 0!==o&&o,r=e.renderScopeListItem,c=e.className,l=e.verticalTitle,s=e.isHero,u=e.impressionEventId,d=e.clickEventId,b=e.traceId,m=e.eventScope,g=e.isTitleDisabled,v=e.isMarginDisabled,h=e.scopeContentListLoggerProps,O=e.titleHrefOverride,j=e.processedQueryOverride,E=e.maxItemsShown,x=e.breadCrumbSubTitle,S=Object(Nt.a)(t),C=Object(Ut.a)().searchOptions.buildBingWorkVerticalUrl,y=Object(T.useSelector)(vi.k),N=Math.min(S,void 0!==E?E:3),L=Object(p.a)(),I=Object(Oi.c)(),F=Ii(L,v),P=Object(k.a)(),A=Object(w.c)(),B=Object(jn.d)(),R=Object(T.useSelector)((function(e){return Object(wt.i)(e,n)}));R=j||R;var D=Object(w.p)(),H=Object(w.k)(),W=Object(ht.d)(),z=Object(T.useSelector)((function(e){return Object(Ot.c)(e)}));z=z||"Pole";var K=Object(T.useSelector)(Ot.b),Q=Object(T.useSelector)(Ot.e);Q=Q||"Mop-3";var q=Object(An.d)({entities:Object(ue.a)(t,N),domain:n,isHero:!!s,impressionEventId:u,clickEventId:d,cardType:"Scope",traceId:b,eventScope:m,layoutProps:h}),U=Object(_.t)(),V=Object(hi.b)(Object(hi.a)("High"),!0),G=f.useState(!1),J=G[0],Y=G[1];f.useEffect((function(){W&&!J&&S>0&&(Object(Ne.o)(P,A,z),Object(Ne.q)(P,A,"High",void 0,z),Object(M.a)(P,Object(hi.a)("High"),"ScopeContentListContainerImpression"),V.logImpression(),Y(!0))}),[W,P,A,S]);var X=void 0;if(O?X=O:B&&(X=C?D&&!H?C(B,n,l):C(B,n):void 0),W&&!y)return f.createElement(f.Fragment,null);if(W&&y&&0===S)return ft(z,void 0,K),f.createElement(f.Fragment,null);if(0===S&&!W)return I?f.createElement(gi.d,{query:I,className:F.noResults,isMainline:!0}):null;var $=function(e,t){q.entityActions.onEntityClick(e,void 0,{url:t,clientSize:A},"File_Modifier_Profile_Click")},Z=f.createElement(Li,{className:F.privacyMessage,domain:n,isSmall:!0}),ee={title:i,resultCountSubTitle:a?t&&Object(Nn.u)({count:t.length}):void 0,breadCrumbSubTitle:x,items:Object(ue.a)(t,N),renderItem:function(e,t){return r(e,t,(function(){return q.entityActions.onEntityClick(e,t)}),(function(n){return q.entityActions.onActionClick(e,n,t)}),void 0,(function(e,t){return q.entityActions.onEntityClick(e,void 0,void 0,t)}),$)},hideTenantBranding:!0,hideExpansionArrows:!0,processedQuery:R,onTitleClick:function(){var e;(null===(e=ce.a.flightParams)||void 0===e?void 0:e.isDeprecateOldLoggerEnabled)?q.nonEntityActions.onSearchActionClick("Mainline_Scope_List_Title_Click",{eventScope:Object(Kn.a)(n),isHero:s}):Object(re.c)(P,A,n,s)},titleHref:X,verticalTitle:l,noListTitle:Mi(n),isSmall:D,isMiniSerp:H,isTitleDisabled:g,privacyMessageNode:Z,isEduEnabled:U};return f.createElement(Ke.a,{codeLocation:"ScopeContentList.".concat(n)},f.createElement("div",{className:Object(Mn.a)(c,"ms-search-scopeCardContent",F.scopeCardContentWrapper)},f.createElement(ci,Object(mn.__assign)({},ee))))},Pi=function(e){var t=e.className,n=e.isMainline,i=e.renderLoadingState,o=e.scopeContentListLoggerProps,a=e.title,r=e.titleHref,c=Object(jn.d)(),l=Object(T.useSelector)((function(e){return Object(On.m)(e,void 0,hn.b,void 0)})),s=Object(w.y)().buildBingWorkVerticalUrl,u=Object(T.useSelector)(On.l),d=Object(vn.b)(void 0,!1,hn.b,hn.c,void 0,void 0,void 0),b=Object(T.useSelector)((function(e){return Object(On.b)(e,void 0,hn.b,void 0)})),m=Object(T.useSelector)(N.m);a=(null==b?void 0:b.VerticalDisplayName)||a;var p=null==b?void 0:b.VerticalLogicalId;p&&c&&(r=s&&s(Object(mn.__assign)(Object(mn.__assign)({},c),{normalizedQuery:m}),"Connectors-"+p,void 0));if(l)return i();var g={className:t,domain:"Connectors",title:a,titleHrefOverride:r,items:d,renderScopeListItem:function(e,t,n){if(Object(pn.b)(e.layout.LayoutId)){var i={file:Object(pn.a)(e),onClick:n};return f.createElement(gn.a,Object(mn.__assign)({},i))}return f.createElement(fn.a,{data:e.Source,layout:e.layout,key:t,onClick:n,hitHighlightedSummary:e.HitHighlightedSummary})},seeMoreLinkQueryOverride:m||void 0,processedQueryOverride:m||void 0,isHero:u,impressionEventId:u?"Scope_AutoExpanded_Connectors_Impression":"Scope_Connectors_Impression",clickEventId:u?"Connectors_AutoExpanded_Insight_Click":"Connectors_Insight_Click",groupClickEventId:u?"Connectors_AutoExpanded_ScopeCard_Click":"Connectors_ScopeCard_Click",isMainline:n,scopeContentListLoggerProps:o};return n?f.createElement(Fi,Object(mn.__assign)({},g)):f.createElement(fi,Object(mn.__assign)({},g))},Ai=n(190),Bi=n(242),Ri=n(1354),Di=n(192),Hi=n(244),Wi=n(247),zi=n(166),Ki=n(125),Qi=n(231),qi=n(241),Ui=n(388);function Vi(e,t,n,i,o){void 0===i&&(i=!0),void 0===o&&(o=new Date);var a=o.getTime(),r=new Date(t),c=a-r.getTime(),l=Math.floor(c/qi.c),s=!i,u=Object(Ui.a)(r,o,s);if("Link"===e||"Attachment"===e)return Object(zi.l)(o,r)?i?Object(Bi.q)({name:n}):Object(Bi.p)({name:n}):Object(Ki.v)(r,o)?i?Object(Bi.s)({name:n}):Object(Bi.r)({name:n}):l<o.getDay()?i?Object(Bi.m)({name:n,day:Object(Qi.a)(r.getDay())}):Object(Bi.l)({name:n,day:Object(Qi.a)(r.getDay())}):l<qi.J/qi.c+o.getDay()?i?Object(Bi.k)({name:n}):Object(Bi.j)({name:n}):r.getMonth()===o.getMonth()&&r.getFullYear()===o.getFullYear()?i?Object(Bi.o)({name:n}):Object(Bi.n)({name:n}):i?Object(Bi.m)({name:n,day:u}):Object(Bi.l)({name:n,day:u});var d=new Date(t),b=new Date,m=Object(Ui.b)(d,b),p=Object(Bi.w)(m,n,!0);return m?p:Yi(p)}function Gi(e,t){return(t.getTime()-e.getTime())/qi.E}function Ji(e,t){return e.setHours(0,0,0,0),t.setHours(0,0,0,0),Math.floor((t.getTime()-e.getTime())/qi.c)}function Yi(e){var t;return(null===(t=e[0])||void 0===t?void 0:t.toUpperCase())+e.substr(1)}function Xi(e,t,n){var i,o,a,r,c,l=e.propertyHits,s=e.dateAccessed,u=e.dateCreated,d=e.sender,b=e.author,m=e.authorEmail,p=e.lastModifiedByFullName,f=e.lastModifiedTime,g=e.lastModifiedByEmail,v=e.sharedDateTime,h=e.userRelationshipType;if(l){var O=Yi(Object(Bi.N)());if("None"===h&&d&&d.emailAddress.name&&d.emailAddress.address&&v)c=d.emailAddress.name===n?O:d.emailAddress.name,r=d.emailAddress.name,a=d.emailAddress.address,o=Vi("Link",v,"");else if(Object(F.a)(l,"EmailSenderName")&&d&&d.emailAddress.name&&d.emailAddress.address&&u)r=c=null===(i=d.emailAddress)||void 0===i?void 0:i.name,a=d.emailAddress.address,o=Vi("Link",u,"");else if(Object(F.a)(l,"Author")&&b&&m&&u)c=b===n?O:b,o=function(e,t){void 0===t&&(t=new Date);var n=new Date(e),i=Gi(n,t),o=Ji(n,t);if(i<qi.g/qi.E){var a=Math.ceil(i*qi.E/qi.p);return Object(Bi.d)({minutes:a.toString()})}if(i<qi.c/qi.E){var r=Math.ceil(i*qi.E/qi.g);return Object(Bi.c)({hours:r.toString()})}return Object(Ki.v)(n,t)?Object(Bi.f)():o<7?Object(Bi.b)({days:o.toString()}):Object(zi.a)(n,t)?Object(Bi.e)({date:Object(Ui.a)(n,t)}):Object(Bi.e)({date:n.toDateString()})}(u),a=m,r=b;else if(s&&t&&n)c=O,a=t,o=function(e,t){void 0===t&&(t=new Date);var n=new Date(e),i=Gi(n,t),o=Ji(n,t);if(i<qi.g/qi.E){var a=Math.ceil(i*qi.E/qi.p);return Object(Bi.F)({minutes:a.toString()})}if(i<qi.c/qi.E){var r=Math.ceil(i*qi.E/qi.g);return Object(Bi.E)({hours:r.toString()})}return Object(Ki.v)(n,t)?Object(Bi.G)():o<7?Object(Bi.D)({days:o.toString()}):Object(zi.a)(n,t)?Object(Bi.C)({date:Object(Ui.a)(n,t)}):Object(Bi.C)({date:n.toDateString()})}(s),r=n;else{if(!(f&&g&&t&&n&&p===n))return;c=O,a=t,o=Object(Bi.w)(f),r=n}return{subtitle:o,fullName:c,subtitleLinkEmail:a,subtitleLinkName:r}}}var $i=function(e){var t=e.className,n=e.isMainline,i=e.renderLoadingState,o=e.scopeContentListLoggerProps,a=Object(T.useSelector)(N.E),r=Object(T.useSelector)(Hn.a),c=Object(T.useSelector)(N.Tb),l={pageNumber:hn.b,pageSize:hn.c,aggregations:void 0,refiningQueries:void 0,extendedQueryTemplate:void 0,isEnabled:!0,isNLFileSearchEnabled:!1,is3SFileRequired:c?a&&!r:a},s=Object(Ri.a)(l).items,u=Object(T.useSelector)(Wi.e),d=Object(T.useSelector)(Wi.j),b=Object(T.useSelector)((function(e){return Object(Wi.i)(e,void 0,void 0,void 0,a)})),m=Object(T.useSelector)(wt.D),p=Object(T.useSelector)(N.F),g=Object($.i)(),v=Object($.h)(),h=Object(Hi.a)(),O=h.buildRequeryUrl,j=h.requery,E=Object(Di.b)(hn.b,void 0),x=Object(w.k)()&&a;if(d?b:m)return i();var S={className:t,domain:"File",title:Object(Bi.h)(),items:s,renderScopeListItem:function(e,t,i,o,a,r,c){var l,s,u=Object(we.a)(e),b=u.lastModifiedByFullName,m=u.lastModifiedByEmail;if(d&&n&&p){var h=Xi(u,g,v);(null==h?void 0:h.subtitle)&&h.fullName&&h.subtitleLinkEmail&&h.subtitleLinkName&&(l=h.subtitle,b=h.subtitleLinkName,m=h.subtitleLinkEmail,s=h.fullName)}var E=!!b&&O(b,Ai.f,m);return f.createElement(gn.a,{key:t,file:u,onClick:i,subtitleLink:E||void 0,onAuthorClick:function(t){c&&c(e,E||void 0),b&&j(t,b,Ai.f,m)},subtitle:l,subtitleLinkFullName:s})},seeMoreLinkQueryOverride:u,isHero:d,impressionEventId:a&&d?"Hero_AutoExpanded_File_Answer_Impression":d?"Scope_AutoExpanded_File_Impression":"Scope_File_Impression",clickEventId:d?"File_AutoExpanded_Insight_Click":"File_Insight_Click",groupClickEventId:d?"File_AutoExpanded_ScopeCard_Click":"File_ScopeCard_Click",isMainline:!1,scopeContentListLoggerProps:o},C=Object(mn.__assign)(Object(mn.__assign)({},S),{verticalTitle:Object(Bi.t)(),isMainline:!0,traceId:E,isTitleDisabled:x,isMarginDisabled:x});return n?f.createElement(Fi,Object(mn.__assign)({},C)):f.createElement(fi,Object(mn.__assign)({},S))},Zi=function(e){var t=e.domain;switch(ti.a.startAnswerProfiling(t),t){case"Acronym":case"Calendar":case"MeetingRoomProposal":case"Person":case"TuringQnA":return f.createElement(dn.a,{domain:t});case"Topic":return f.createElement(bn.a,null,f.createElement(dn.a,{domain:t}));case"Building":return f.createElement(cn.a,null);case"Bookmark":return f.createElement(rn.a,null);case"Group":return f.createElement(un.a,null);case"Qna":return f.createElement(ln.a,null);case"File":return f.createElement($i,{isMainline:!0,renderLoadingState:function(){return f.createElement(sn.a,{isHeroExpanded:!0})},scopeContentListLoggerProps:{isAnswer:!0}});case"PeopleAlsoAsk":return null;case"CalendarAvailability":case"External":case"FileEntity":case"FileInferenceAnswer":case"Flight":case"Link":case"Message":case"Notification":case"PowerBi":case"Site":case"Turing":return f.createElement(Pi,{isMainline:!0,renderLoadingState:function(){return f.createElement(sn.a,{isHeroExpanded:!0})},scopeContentListLoggerProps:{isAnswer:!0},title:"Connector"});case"Connectors":case"EducationAssignment":case"EducationClass":case"EmployeeOffer":case"EnterpriseLearning":case"FederatedSearch":case"FloorPlan":case"QueryReformulation":case"SharePoint":case"VivaQnA":return null;default:return Object(nn.a)(t)}},eo=n(109),to=n.n(eo),no=n(957),io=n(1373),oo=n(1355),ao=n(211),ro=n(762),co=n(1336),lo=function(e){var t=e.className,n=e.isFederatedSearch,i=e.isMainline,o=e.modifiedQuery,a=e.renderLoadingState,r=e.scopeContentListLoggerProps,c=e.title,l=e.titleHref,s=e.onRenderAllItems,u=Object(T.useSelector)(wt.D),d=Object(T.useSelector)(ao.h),b=Object(w.y)(),m=0,p=n?5:3,g=function(){if(d){var e=Math.min(p,d.length);(m+=1)>=e&&s&&s()}},v=Object(ro.a)().connectorAsyncScopeCardContainer;if(u)return a();var h={className:t,domain:"Connectors",title:c,titleHrefOverride:l,items:d,renderScopeListItem:function(e,t,n){if(Object(pn.b)(e.layout.LayoutId)){var i={file:Object(pn.a)(e),onClick:n};return f.createElement(gn.a,Object(mn.__assign)({},i))}return f.createElement(fn.a,{data:e.Source,layout:e.layout,key:t,onClick:n,onRender:g,hitHighlightedSummary:e.HitHighlightedSummary,onAnchorClickedOverride:function(e,t){if(!b.navigateToVertical)return!1;var n=Object(co.a)(t,b.isDisabledCustomVertical);return!!n&&(b.navigateToVertical(n),!0)}})},seeMoreLinkQueryOverride:o||void 0,isHero:!0,impressionEventId:"Scope_AutoExpanded_Connectors_Impression",clickEventId:"Connectors_AutoExpanded_Insight_Click",groupClickEventId:"Connectors_AutoExpanded_ScopeCard_Click",isMainline:i,scopeContentListLoggerProps:r,isTitleDisabled:n,maxItemsShown:p};return i?f.createElement("div",{className:v},f.createElement("div",{id:"connectorAsyncScopeCardContainer"},f.createElement(Fi,Object(mn.__assign)({},h)))):f.createElement(fi,Object(mn.__assign)({},h))},so=function(e){var t=e.className,n=e.renderLoadingState,i=e.scopeContentListLoggerProps,o=Object(T.useSelector)(Kt.a),a=Object(T.useSelector)(Wi.e),r=Object(T.useSelector)(Kt.b),c=Object(T.useSelector)(Kt.f),l=Object(Hi.a)(),s=l.buildRequeryUrl,u=l.requery;if(c)return n();var d={className:t,domain:"File",title:Object(Bi.h)(),items:o,isHero:!0,renderScopeListItem:function(e,t,n,i,o,a,r){var c=Object(we.a)(e),l=c.lastModifiedByFullName,d=c.lastModifiedByEmail,b=!!l&&s(l,Ai.f,d);return f.createElement(gn.a,{key:t,file:c,onClick:n,subtitleLink:b||void 0,onAuthorClick:function(t){r&&r(e,b||void 0),l&&u(t,l,Ai.f,d)},subtitle:void 0,subtitleLinkFullName:void 0})},seeMoreLinkQueryOverride:a,impressionEventId:"QF_File_Impression",traceId:r,clickEventId:"QF_File_Insight_Click",groupClickEventId:"QF_File_Scopecard_Click",isMainline:!0,scopeContentListLoggerProps:i},b=Object(mn.__assign)(Object(mn.__assign)({},d),{verticalTitle:Object(Bi.t)(),isMainline:!0});return f.createElement(Fi,Object(mn.__assign)({},b))},uo=function(){return(uo=to.a||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},bo=function(e){var t=e.domain,n=e.onRender,i=Object(jn.d)(),o=Object(T.useSelector)(ao.b),a=Object(T.useSelector)(ao.e),r=Object(T.useSelector)(ao.a),c=Object(T.useSelector)(ao.f),l=Object(T.useSelector)(N.lc),s=Object(T.useSelector)(_.B),u=Object(T.useSelector)(A.a),d=s&&u,b=Object(T.useSelector)(N.wc),m=Object(T.useSelector)((function(e){return Object(wt.i)(e,t)})),p=Object(T.useSelector)(ao.r),g=Object(T.useSelector)(ao.p),v=Object(T.useSelector)(ao.k),h=Object(w.y)().buildBingWorkVerticalUrl,O=Object(T.useSelector)((function(e){return Object(ao.A)(e,"Connectors")})),j=null==p?void 0:p.VerticalLogicalId,E="Connector"===v?"Connectors":"FederatedSearch"===v?"FederatedSearch":t,x=function(){return f.createElement(sn.a,{isHeroExpanded:!0})};if(!("Connector"===v&&l||"FederatedSearch"===v&&b)||Object(no.a)(o)||Object(no.a)(a)){if(d&&"File"===t){var S=void 0;i&&(S=h&&h(uo(uo({},i),{normalizedQuery:O}),"Files",void 0));k={title:"File",titleHref:S,modifiedQuery:m,isMainline:!0,renderLoadingState:x,onRenderAllItems:n,isFederatedSearch:!1};return f.createElement(so,uo({},k))}return f.createElement(oo.HeroAdaptiveContainer,{adaptiveTemplateResponse:r,asyncAnswerEntity:c,domain:E,useHostAppStyles:!0,useHostConfigJson:!0,externalSourceType:v,onRender:n})}var C=(null==p?void 0:p.VerticalDisplayName)||"Connector",y=void 0;i&&(y=h&&h(uo(uo({},i),{normalizedQuery:O}),j?"Connectors-"+j:g,void 0));var k={title:C,titleHref:y,modifiedQuery:m,isMainline:!0,renderLoadingState:x,onRenderAllItems:n,isFederatedSearch:"FederatedSearch"===v};return f.createElement(lo,uo({},k))},mo=function(e){var t=e.domain,n=e.onRender;return f.createElement(io.a,null,f.createElement(bo,{domain:t,onRender:n}))},po=window.BingAtWork.Mainline,fo=function(){var e=Object(T.useSelector)(jt.d),t=Object(T.useSelector)(_.B),n=Object(A.a)(),i=t&&n;i&&(e="File");var o=Object(_.i)(),a=Object(T.useSelector)((function(t){return Object(jt.e)(t,e,!0,o,!0,i)})),r=Object(T.useSelector)(an.d),c=Object(T.useSelector)(Kt.d);i&&(r=r||i&&c);return e&&a?f.createElement(Ke.a,{codeLocation:"HeroCardRouterContainer.Bing.".concat(e)},f.createElement(go,{heroDomain:e,renderingCardType:a,onAsyncResultsRendered:function(){r&&po&&po.unpreexpandIfHeightMismatched()}})):null},go=function(e){var t=e.heroDomain,n=e.renderingCardType,i=e.onAsyncResultsRendered;switch(n){case"AsyncCard":return f.createElement(on.a,{domain:t,displayAsCard:!0,isTall:"External"===t,onNoAsyncResultsRender:i});case"HeroCard":return f.createElement(Zi,{domain:t});case"AdaptiveCard":return f.createElement(mo,{domain:t,onRender:i});default:return Object(nn.a)(n)}},vo=n(335),ho=n(553),Oo=n(982),jo=n(755),Eo=n(2743),xo=function(e){var t=e.className,n=e.isMainline,i=e.scopeContentListLoggerProps,o=Object(jo.a)(hn.b),a=Object(w.p)(),r=Object(w.e)(),c=Object(T.useSelector)(Oo.d),l=Object(T.useSelector)(N.wd),s=Object(T.useSelector)(N.S),u=Object(vo.j)()+" > "+Object(vo.e)(),d={className:t,domain:"EducationAssignment",title:Object(vo.i)(),breadCrumbSubTitle:u,items:o,renderScopeListItem:function(e,t,i){var o=Object(ho.a)(e,r,void 0,!1,!1,!1,s);return f.createElement(Eo.a,{key:t,assignment:o,onClick:i,isSmall:a,isMainline:n,isSmallClickableTitle:l})},isHero:c,impressionEventId:c?"Scope_AutoExpanded_EducationAssignment_Impression":"Scope_EducationAssignment_Impression",clickEventId:c?"EducationAssignment_AutoExpanded_Insight_Click":"EducationAssignment_Insight_Click",groupClickEventId:c?"EducationAssignment_AutoExpanded_ScopeCard_Click":"EducationAssignment_ScopeCard_Click",isMainline:n,scopeContentListLoggerProps:i};return n?f.createElement(Fi,Object(mn.__assign)({},d)):null},So=n(2764),Co=n(2019),yo=n(278),ko=n(1118),wo=function(e){var t=e.className,n=e.isMainline,i=e.renderLoadingState,o=e.scopeContentListLoggerProps,a=Object(T.useSelector)(N.Od),r=Object(ht.d)(),c=Object(Co.a)({pageNumber:hn.b,pageSize:r?hn.d:hn.c,showResultCluster:!1,aggregations:void 0,refiningQueries:void 0,isEnabled:!0,isSerpUsingSubstrateUnifiedSearch:!1,isNLFileSearchEnabled:!1,isTuringMarkerEnabled:a}).items,l=Object(T.useSelector)(vi.l),s=Object(T.useSelector)(wt.D),u=Object(T.useSelector)(yo.i),d=Object(T.useSelector)(Ot.b),b=Object(T.useSelector)(N.wd),m=u||r&&"High"===d,p=Object(Co.b)(hn.b,!1,void 0),g=Object(Hi.a)(),v=g.buildRequeryUrl,h=g.requery,O=f.useCallback((function(e,t,n,i,o,a,r){if("Site"===e.domain){var c={site:Object(ko.a)(e),onClick:n,isSmallClickableTitle:b};return f.createElement(So.a,Object(mn.__assign)({},c))}var l=Object(we.a)(e),s=l.lastModifiedByFullName&&l.lastModifiedByEmail&&v(l.lastModifiedByFullName,Ai.f,l.lastModifiedByEmail),u={file:l,onClick:n,subtitleLink:s,onAuthorClick:function(t){r&&r(e),l.lastModifiedByFullName&&l.lastModifiedByEmail&&h(t,l.lastModifiedByFullName,Ai.f,l.lastModifiedByEmail)},isSmallClickableTitle:b};return f.createElement(gn.a,Object(mn.__assign)({},u))}),[p,m]),j=Object(ko.b)(c);if(m?l:s)return i();var E={className:t,domain:"Site",title:Object(Nn.K)(),items:j,renderScopeListItem:O,isHero:m,impressionEventId:m?"Scope_AutoExpanded_FilesAndSites_Impression":"Scope_FilesAndSites_Impression",clickEventId:m?"FilesAndSites_AutoExpanded_Insight_Click":"FilesAndSites_Insight_Click",groupClickEventId:m?"FilesAndSites_AutoExpanded_ScopeCard_Click":"FilesAndSites_ScopeCard_Click",traceId:p,eventScope:"FilesAndSites",isMainline:n,scopeContentListLoggerProps:o};if(n){var x=Object(mn.__assign)({verticalTitle:Object(Nn.a)()},E);return f.createElement(Fi,Object(mn.__assign)({},x))}return f.createElement(fi,Object(mn.__assign)({},E))},_o=n(878),No=n(367),Lo=n(1642),Mo=n(1951),To=n(661),Io=function(e){var t=e.className,n=e.isMainline,i=e.scopeContentListLoggerProps,o=Object(xt.a)(),a=Object(p.a)(),r=Object(T.useSelector)(N.wd),c={className:t,domain:"EmployeeOffer",title:Object(No.j)(),items:o,renderScopeListItem:function(e,t,n,i){var o=Object(_o.a)(e),c=Object(Lo.a)(a).imageIcon,l=f.createElement(To.a,{imageId:o.imageId,title:o.provider,className:c});return f.createElement(Mo.a,{offer:o,offerIcon:l,onClick:n,onLocateStoreClick:function(){return i("Offer_LocateStore_Click")},isSmallClickableTitle:r})},impressionEventId:"Scope_Offer_Impression",clickEventId:"Offer_Insight_Click",groupClickEventId:"Offer_ScopeCard_Click",isMainline:n,scopeContentListLoggerProps:i};return n?f.createElement(Fi,Object(mn.__assign)({},c)):null},Fo=n(2759),Po=n(2807),Ao=n(1364),Bo=n(657),Ro=n(298),Do=n(1387),Ho=function(e){var t=e.className,n=e.isMainline,i=e.renderLoadingState,o=e.scopeContentListLoggerProps,a=Object(Ao.a)().items,r=Object(T.useSelector)(Ro.e),c=Object(T.useSelector)(Ro.i),l=Object(T.useSelector)(wt.D),s=Object(T.useSelector)(Ro.h),u=Object(Nn.B)({source:Object(ki.c)()}),d=Object(Bo.a)(),b=Object(T.useSelector)(N.wd);if(c?s:l)return i();var m={className:t,domain:"PowerBi",title:Object(ki.c)(),items:a,seeMoreLinkText:u,renderScopeListItem:function(e,t,n){var i=Object(Do.a)(e);return f.createElement(Fo.a,{key:t,powerBi:i,onClick:n,isSmallClickableTitle:b})},seeMoreLinkQueryOverride:r,isHero:c,impressionEventId:c?"Scope_AutoExpanded_PowerBi_Impression":"Scope_PowerBi_Impression",clickEventId:c?"PowerBi_AutoExpanded_Insight_Click":"PowerBi_Insight_Click",groupClickEventId:c?"PowerBi_AutoExpanded_ScopeCard_Click":"PowerBi_ScopeCard_Click",isMainline:n,scopeContentListLoggerProps:o};return d?f.createElement(Po.a,{isMainline:n}):n?f.createElement(Fi,Object(mn.__assign)({},m)):f.createElement(fi,Object(mn.__assign)({},m))},Wo=n(162),zo=n(1386);function Ko(e){return{keyword:Object(yo.e)(e),isFetchingSites:Object(yo.h)(e),sites:Object(yo.d)(e)}}var Qo=function(e,t){return{fetchSites:function(n,i,o){return Object(mn.__awaiter)(void 0,void 0,void 0,(function(){return Object(mn.__generator)(this,(function(a){switch(a.label){case 0:return[4,e(Object(zo.a)(t.appContext,n,o,i))];case 1:return[2,a.sent()]}}))}))}}};var qo,Uo,Vo=Object(T.connect)((function(e){return{isFetchingSites:Object(yo.h)(e),isFetchingAnyAsyncResults:Object(wt.D)(e),isHero:Object(yo.i)(e)}}))(Object(Wo.a)((qo=function(e){var t=e.className,n=e.isHero,i=e.isFetchingSites,o=e.isFetchingAnyAsyncResults,a=e.isMainline,r=e.renderLoadingState,c=e.sites,l=e.keyword,s=e.scopeContentListLoggerProps,u=Object(T.useSelector)(N.wd);if(n?i:o)return r();var d={className:t,domain:"Site",title:Object(_i.c)(),items:c,seeMoreLinkQueryOverride:l,renderScopeListItem:function(e,t,n){return f.createElement(So.a,{key:t,site:Object(ko.a)(e),onClick:n,isSmallClickableTitle:u})},isHero:n,impressionEventId:n?"Scope_AutoExpanded_Site_Impression":"Scope_Site_Impression",clickEventId:n?"Site_AutoExpanded_Insight_Click":"Site_Insight_Click",groupClickEventId:n?"Site_AutoExpanded_ScopeCard_Click":"Site_ScopeCard_Click",isMainline:a,scopeContentListLoggerProps:s};return a?f.createElement(Fi,Object(mn.__assign)({},d)):f.createElement(fi,Object(mn.__assign)({},d))},Uo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(mn.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=(e.fetchSites,Object(mn.__rest)(e,["fetchSites"])),n=Object(mn.__assign)({},t);return f.createElement(qo,Object(mn.__assign)({},n))},t.prototype.componentDidMount=function(){this.initializeData()},t.prototype.componentDidUpdate=function(e){this.initializeData(e)},t.prototype.initializeData=function(e){var t=this.props,n=t.keyword,i=t.keywordOverride,o=t.fetchSites,a=t.sites,r=t.isFetchingSites,c=t.pageSize,l=t.pageNumber,s=i||n,u=e&&(e.keywordOverride||e.keyword),d=Object(de.a)(a);!r&&d&&s&&s!==u&&o(s,c,l)},t}(f.Component),Object(T.connect)(Ko,Qo)(Uo)))),Go=function(){return(Go=to.a||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Jo=function(e){var t=e.className,n=e.domain,i=Object(_.R)(),o=Object(_.t)(),a=Object(ht.d)(),r={className:t,isMainline:!0,renderLoadingState:function(){return f.createElement(sn.a,{isHeroExpanded:!0})},page:"Mainline",scopeContentListLoggerProps:{isAnswer:!0}};switch(ti.a.startAnswerProfiling(n),n){case"EducationAssignment":return o?f.createElement(xo,Go({},r)):null;case"File":return f.createElement($i,Go({},r));case"Site":return a?f.createElement(wo,Go({},r)):f.createElement(Vo,Go({},r));case"PowerBi":return i?f.createElement(Ho,Go({},r)):null;case"EmployeeOffer":return f.createElement(Io,Go({},r));case"Acronym":case"Bookmark":case"Building":case"Calendar":case"CalendarAvailability":case"Connectors":case"EducationClass":case"EnterpriseLearning":case"External":case"FederatedSearch":case"FileEntity":case"FileInferenceAnswer":case"Flight":case"FloorPlan":case"Group":case"Link":case"MeetingRoomProposal":case"Message":case"Notification":case"PeopleAlsoAsk":case"Person":case"Qna":case"QueryReformulation":case"SharePoint":case"Topic":case"Turing":case"TuringQnA":case"VivaQnA":return null;default:return Object(nn.a)(n)}};function Yo(e,t){if(!Object(wt.C)(e)&&!window.BingAtWork.isMainlineAnswerPreExpanded)return!1;if(Object(jt.l)(e))return!0;if(!Object(wt.o)(e))return!1;var n=Object(N.C)(e),i=Object(Ot.g)(e),o=Object(Ot.f)(e);if(n&&!(i||o)&&!t)return!1;if(!function(e){if(N.ee)return"Low"===Object(Ot.b)(e);var t=Object(wt.o)(e);return!t||"Suppress"===t||!Object(N.Nc)(e)&&"Ribbon"===t}(e))return!0;var a=Object(N.jc)(e),r=Object(N.ic)(e),c=Object(Ot.b)(e),l=Object(Ot.d)(e);if(a)return!r||"Low"!==c||"High"===l;var s=Object(B.h)(e),u=Object(B.g)(e)||Object(B.j)(e)||Object(B.i)(e)||Object(B.m)(e);return s&&u}var Xo=function(e){var t=Object(wt.o)(e);return!(!t||"RichRibbon"!==t&&"Carousel"!==t)&&("EmployeeOffer"===Object(wt.e)(e)&&Object(N.mc)(e))};var $o=function(e){var t=Object(jt.d)(e),n=Object(wt.e)(e);return"EnterpriseLearning"===t||"EnterpriseLearning"===n},Zo=function(e){var t=Object(N.Ab)(e),n=Object(ao.j)(e),i=Object(wt.l)(e),o=Object(jt.d)(e);return t&&(i&&"EducationAssignment"===i||o&&"EducationAssignment"===o)?i||o:n||void 0},ea=function(e){var t=Object(Nn.g)(),n=Object(Wn.a)(e),i=Object(ao.t)(e);return Object(On.i)(e)||i||n||t},ta=function(e){return!!Object(ao.O)(e)},na=n(776),ia=O.z,oa=Object(v.a)((function(e){var t=e.palette,n=t.blueMid,i=t.white,o=t.black,a=t.neutralQuaternary,r={content:"''",position:"absolute",top:"0px",right:"-2px",borderBottom:"7px solid transparent",borderTop:"".concat(9,"px solid transparent"),borderLeft:"".concat(9,"px solid ").concat(i),background:o};return Object(E.K)({cardContent:[{position:"static",width:"197px",height:"214px"}],learningImage:[j.g,{maxHeight:"100%",verticalAlign:"middle",display:"inline-block",fontSize:"10px",width:"197px",height:"214px"}],bottomContainer:{position:"absolute",width:"197px",height:"106px",left:"0px",top:"148px",background:o,borderRadius:"0px 0px 6px 6px"},courseTitle:{position:"absolute",width:"165px",height:"40px",left:"16px",bottom:"86px",verticalAlign:"middle",lineHeight:"20px",fontSize:"".concat(13,"px"),color:i,display:"block",overflow:"hidden"},titleContent:{textDecoration:"none",display:"block",verticalAlign:"middle",lineHeight:"20px",fontSize:"".concat(13,"px"),color:e.palette.white},authorAndDuration:[Object(pe.t)(e),{position:"absolute",width:"165px",height:"13px",left:"16px",bottom:"65px",textDecoration:"none",display:"block",verticalAlign:"middle",color:a}],domainContent:[Object(pe.t)(e),{position:"absolute",width:"87px",height:"13px",left:"16px",bottom:"16px",color:a}],arrowButton:[Object(pe.t)(e),{borderRadius:"2px",cursor:"pointer",background:i,fontWeight:"bold",color:n,paddingRight:"10px",alignItems:"center",paddingLeft:"4px",position:"relative",height:"16px",left:"16px",top:"56px",fontSize:"".concat(13,"px"),lineHeight:"13px",marginRight:"4px",selectors:{"::after":[r]}}],tenantLabel:[Object(pe.t)(e),{color:i,height:"13px",top:"55px",bottom:"34px",position:"relative",left:"18px"}],bottomGradient:{position:"absolute",height:"40px",left:"0px",right:"0px",bottom:"104px",background:"linear-gradient(180deg, rgba(17, 17, 17, 0.6) 0%, ".concat(o," 100%)"),borderRadius:"0px"},topGradient:{position:"absolute",height:"24px",left:"0px",right:"0px",bottom:"144px",background:"linear-gradient(180deg, rgba(17, 17, 17, 0) 0%, rgba(17, 17, 17, 0.6) 100%)",borderRadius:"0px"}})})),aa=Object(v.a)((function(e){return Object(E.K)({backgroundImage:{position:"static",width:"197px",height:"148px",background:"url(".concat(e,")"),backgroundSize:"cover"}})})),ra=n(592),ca=n(898),la=n(3014),sa=n(2455),ua=n(2370),da=Object(la.a)((function(e){if(null==e.children)return null;e.block,e.className;var t=e.as,n=void 0===t?"span":t,i=(e.variant,e.nowrap,Object(mn.__rest)(e,["block","className","as","variant","nowrap"])),o=Object(sa.b)(e,{root:n});return Object(sa.c)(o.root,Object(mn.__assign)({},Object(ua.h)(i,ua.i)))}),{displayName:"Text",styles:function(e,t){var n=e.as,i=e.className,o=e.block,a=e.nowrap,r=e.variant,c=t.fonts,l=t.semanticColors,s=c[r||"medium"];return{root:[s,{color:s.color||l.bodyText,display:o?"td"===n?"table-cell":"block":"inline",mozOsxFontSmoothing:s.MozOsxFontSmoothing,webkitFontSmoothing:s.WebkitFontSmoothing},a&&{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},i]}}}),ba=n(838),ma=function(e){var t,n=e.course,i=e.onClick,o=e.tenantName,a=e.courseThumbnail,r=n.id,c=n.url,l=n.author,s=n.visualTitle,u=n.duration,d=Object(p.a)(),b=oa(d),m=function(e){if(e){var t=e.split("/")[2].split(".");return t[1].charAt(0).toUpperCase()+t[1].slice(1)}return""}(c),g=(t=l)&&t.length>1?" + "+(t.length-1).toString():"",v=function(e,t){return"popular"===e?Object(ba.g)():!1===t?Object(ba.e)():""}(n.decoration,n.isCoursePaid),h={fontSize:13,fontFamily:ia},O={fontSize:11,fontFamily:ia},j=Object(ra.a)(s,h,165,2,"{0}..."),E=u?100:140,x=Object(ra.a)(l[0],O,E,1,"{0}..."),S=Object(ra.a)(o,O,58,1,"{0}..."),C=f.createElement(da,{className:b.courseTitle},j.text),y=f.createElement(se.a,{ariaLabel:"Separator",iconName:"LocationDot",title:j.text}),k="popular"===n.decoration?Object(ba.h)({tenantName:S.text}):"",w=u?Object(ba.d)({duration:u}):"",_=f.createElement(da,{className:b.authorAndDuration},Object(ba.a)()," ",x.text," ",g," ",u&&y," ",w),N=f.createElement(da,{className:b.domainContent},m),L=f.createElement("div",null,a,f.createElement("div",{className:b.topGradient}),f.createElement("div",{className:b.bottomGradient}),f.createElement("div",{className:b.bottomContainer},C,_,""!==v&&f.createElement("span",{className:b.arrowButton},v),f.createElement("span",{className:b.tenantLabel},k),N));return f.createElement(ca.a,{cardContent:L,width:197,height:254,href:n.url,onClick:i?function(){return i(r)}:void 0})};function pa(e){return Object(jt.b)(e,"EnterpriseLearning",10)}var fa=n(651),ga=n(867),va=Object(v.a)((function(e){var t;return Object(E.K)({scrollable:{selectors:(t={},t[".".concat(Na)]={overflow:"visible",margin:"0px 8px",top:"4px",background:e.palette.white,borderRadius:"6px",width:"610px",height:"280px"},t[".".concat(fa.b)]={lineHeight:0},t[".".concat(ga.a)]={left:"-10px",boxShadow:"0px 2px 3px rgba(0, 0, 0, 0.1)",boxSizing:"border-box",border:Object(Oe.n)(e)},t[".".concat(ga.b)]={right:"-10px",boxShadow:"0px 2px 3px rgba(0, 0, 0, 0.1)",boxSizing:"border-box",border:Object(Oe.n)(e)},t)},courseHeading:{width:"608px",height:"22px",marginLeft:"14px",fontSize:"18px",lineHeight:"22px",color:e.palette.neutralDark},LearningCarouselList:{position:"relative",display:"inline-block",height:"254px",overflow:"hidden",whiteSpace:"nowrap",selectors:{">li":{display:"inline-block",marginRight:"3px",marginLeft:"3px"}}}})})),ha=n(240),Oa=n(111),ja=n(178),Ea=n(160);function xa(e){return{key:e}}var Sa=Object(Ea.a)("LearningImage",(function(e,t){return Object(ha.b)(this,void 0,void 0,(function(){var n;return Object(ha.c)(this,(function(i){switch(i.label){case 0:return"image",n=e.createRequestUrl("image"),[4,e.makeRequest(n,"POST",t)];case 1:return[2,i.sent()]}}))}))}),!0),Ca=Object(Oa.c)("LearningImageStore",Sa);function ya(e,t){var n=e.monitorStarter,i=e.msbRestProvider,o=e.logger,a=function(e,t){return{clientContext:Object(ja.g)(t),Id:e}}(t,e),r={monitorStarter:n,msbRestProvider:i,logger:o,rttName:"EnterpriseLearning_LearningImage_RoundTripTime"},c=xa(t);return Object(Oa.a)(Sa)(r,c,a)}function ka(e,t){var n=function(e,t){return Ca.getSelectors(e).getLatestSuccess(xa(t))}(e,t);return n&&n.bytes}function wa(e){var t=this,n=Object(Ut.a)(),i=Object(T.useDispatch)(),o=Object(T.useSelector)((function(t){return e&&ka(t,e)})),a=Object(T.useSelector)((function(t){return!!e&&function(e,t){return Ca.getSelectors(e).isLoading(xa(t))}(t,e)})),r=Object(T.useSelector)((function(t){return!!e&&function(e,t){return Ca.getSelectors(e).hasError(xa(t))}(t,e)})),c=Object(Wt.a)(e);return f.useEffect((function(){var l;a||r||o||!e||c===e||(l=e,Object(ha.b)(t,void 0,void 0,(function(){return Object(ha.c)(this,(function(e){switch(e.label){case 0:return[4,i(ya(n,l))];case 1:return[2,e.sent()]}}))})))}),[a,o,e,c]),Object(Dn.b)(o)}var _a=function(e){var t=wa(e.imageId),n=void 0!==t?aa(t).backgroundImage:void 0;return f.createElement("div",{className:n}," ")},Na="ms-search-tile-card-carousel",La=function(e){var t=e.className,n=e.query,i=Object(T.useSelector)((function(e){return pa(e)})),o=Object(Di.e)(),a=Object(p.a)(),r=Object($.d)(),c=Object(An.d)({entities:i,domain:"EnterpriseLearning",isHero:!0,impressionEventId:"Tile_Carousel_Learning_Impression",clickEventId:"Tile_Carousel_Card_Click",cardType:"Tile",traceId:o,eventScope:"EnterpriseLearning"});if(Object(no.a)(i))return null;var l=va(a),s=function(){return Object(z.a)(i,(function(e,t){var n=function(e){return{id:e.id,url:e.url,visualTitle:e.visualTitle,staticRank:e.staticRank,domainRank:e.domainRank,descriptionSnippet:e.descriptionSnippet,imageId:e.imageId,author:e.author,duration:e.duration,isCoursePaid:e.isCoursePaid,decoration:e.decoration}}(e),i=oa(a).learningImage,o=f.createElement(_a,{imageId:n.imageId,className:i});return f.createElement("li",{key:t},f.createElement(ma,{course:n,tenantName:r,courseThumbnail:o,onClick:c.entityActions.onEntityClickId}))}))},u=void 0!==n&&f.createElement(da,{className:l.courseHeading}," ",Object(ba.b)({query:n}));return f.createElement("div",{className:Object(Mn.a)(l.scrollable,t)},u,f.createElement(na.a,{className:Na,"data-test-id":"LearningCarousel",scrollAnimationDuration:500,carouselType:"HalfBleed",getScrollAmount:Ma,renderCarouselContent:function(e){return f.createElement("ul",{id:e,"aria-label":Object(ba.f)(),className:l.LearningCarouselList},s())},onArrowScrollClick:function(e){c.nonEntityActions.onSearchActionClick("Tile_Carousel_Arrow_Click",{value:e})}}))},Ma=function(e){return 203*Math.floor(e.offsetWidth/203)},Ta=n(1383);var Ia=Object(he.b)((function(){return Object(E.K)({container:[je.a,{width:"100%"}],ghostText:{width:"90%",marginLeft:"5%"}})})),Fa=function(){var e=Ia();return f.createElement(xe.a,{className:e.container,lineClassName:e.ghostText,numLines:3})},Pa=function(){return(Pa=to.a||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Aa=function(e){var t=e.className,n=e.domain;ti.a.startAnswerProfiling(n);var i=Object(Oi.b)(),o=Object(_.x)(),a={className:t,renderLoadingState:function(){return f.createElement(Fa,null)},page:"Mainline",query:i};switch(n){case"EmployeeOffer":return f.createElement(Ta.a,Pa({},a));case"EnterpriseLearning":return o?f.createElement(La,Pa({},a)):null;case"Acronym":case"Bookmark":case"Building":case"Calendar":case"CalendarAvailability":case"Connectors":case"EducationAssignment":case"EducationClass":case"External":case"FederatedSearch":case"File":case"FileEntity":case"FileInferenceAnswer":case"Flight":case"FloorPlan":case"Group":case"Link":case"MeetingRoomProposal":case"Message":case"Notification":case"PeopleAlsoAsk":case"Person":case"PowerBi":case"Qna":case"QueryReformulation":case"SharePoint":case"Site":case"Topic":case"Turing":case"TuringQnA":case"VivaQnA":return null;default:return Object(nn.a)(n)}},Ba=n(263),Ra=n(2006);var Da=n(654);function Ha(){var e=Object(T.useSelector)(tn),t=Object(T.useSelector)(N.Q),n=Object(T.useSelector)(N.Vb),i=Object(w.c)();return(Object(T.useSelector)((function(e){return Object(Da.a)(e,void 0)}))&&!e&&t||n)&&"Small"!==i||!1}var Wa=n(1894),za=n(2750),Ka=n(856),Qa=Object(v.a)((function(){return{hasSolidIcons:!Object(Ze.a)()}})),qa=Object(v.a)((function(e){return Object(E.K)({root:{height:"16px",padding:"0px",verticalAlign:"top",selectors:{"&:focus":{outline:"3px solid ".concat(e.palette.black)},".ms-Fabric--isFocusVisible &:focus:after":{border:"none",outline:"none"}}},label:[Object(pe.t)(e),{color:e.palette.themePrimary,margin:"0px",lineHeight:"16px",selectors:{":hover":{textDecoration:"underline"}}}]})})),Ua=function(e){return{buttonLabel:Object(Wa.a)(),buttonStyles:qa(e),hideIcon:!0}},Va=function(){var e=Object(T.useSelector)((function(e){return Object(Da.a)(e,void 0)})),t=Qa(),n=Object(T.useSelector)(N.Vb);return e?f.createElement(za.a,{symptomName:e,answerFeedbackStyles:t}):n?f.createElement(Ka.a,{overrideGeneralFeedbackDefaultStyles:Ua}):null},Ga=Object(v.a)((function(e,t,n){return Object(E.K)({mainlineFooter:[{float:"right",margin:t?"4px 18px 12px 20px":"8px 20px 12px",whiteSpace:"nowrap"},n?{display:"flex",flexWrap:"wrap",width:"90%",padding:"0px 3px",justifyContent:"flex-end"}:void 0],privacyContainer:{backgroundClip:"padding-box",height:"14px",paddingTop:"9px",paddingBottom:"9px",width:"100%",color:e.palette.neutralPrimary},privacyMessage:[Object(pe.t)(e),{display:"inline-block",lineHeight:t?"16px":"13px",verticalAlign:t?"top":"unset"}],feedback:{display:"inline-block",marginLeft:"4px",selectors:{"> div > a":[e.fonts.tiny,{display:"inline-block"}]}},dotSeparator:{lineHeight:"16px",display:"inline-block",verticalAlign:"top",marginLeft:"4px",color:e.palette.blackTranslucent40,fontSize:"13px"}})})),Ja=n(243),Ya=n(1512),Xa=(Object(Qn.declareString)("search-hostapp-msb-mainline.search.shared.seeAllResults")),$a=(Object(Qn.declareStringWithPlaceholders)("search-hostapp-msb-mainline.search.shared.seeAllResultsFrom")),Za=(Object(Qn.declareStringWithPlaceholders)("search-hostapp-msb-mainline.search.shared.seeMoreDomainEntitiesFrom")),er=(Object(Qn.declareString)("search-hostapp-msb-mainline.search.shared.signedIntoWork")),tr=(Object(Qn.declareString)("search-hostapp-msb-mainline.search.shared.signedIntoEdu")),nr=(Object(Qn.declareString)("search-hostapp-msb-mainline.search.shared.signedIn")),ir=(Object(Qn.declareString)("search-hostapp-msb-mainline.search.shared.signOut")),or=Object(v.a)((function(e,t,n){return Object(E.K)({buttonWithIcon:{height:"calc(100% - ".concat("12px",")"),width:"calc(100% - ".concat("24px",")"),paddingTop:"12px",paddingLeft:"24px",selectors:{":focus":{textDecoration:"underline",outlineOffset:"-1px"}}},footerContent:{overflow:"hidden",borderRadius:"0 0 ".concat(me.a," ").concat(me.a),backgroundColor:n?e.palette.white:t?t.color:e.palette.neutralPrimary,height:"40px",borderTop:n?"1px solid ".concat(e.palette.neutralLight):void 0,selectors:{"span,i":{fontWeight:n?E.g.bold:E.g.regular,color:n?e.palette.themePrimary:e.palette.white},":hover span":{textDecoration:n?"underline":void 0}}}})})),ar=function(){return(ar=to.a||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},rr=function(e){var t=e.className,n=e.onSeeMoreResultsClick,i=e.footerLinkDomain,o=Object(p.a)(),a=Object(Ja.b)(),r=Object($.d)(),c=Object(w.o)(),l=Object(_.t)(),s=Object(T.useSelector)(N.L),u=Object(jn.d)(),d=Object(w.y)().buildBingWorkVerticalUrl,b=or(o,a,s),m=i&&Object(Un.a)(i),g=Object(T.useSelector)(ea),v=Object(T.useSelector)(ao.u),h=Object(T.useSelector)(ta),O=m&&!h?Za({domainEntities:m.toLocaleLowerCase(),tenantName:r}):$a({resultSource:g}),j=c?"ChevronLeftIcon":"ChevronRightIcon",E=Object(T.useSelector)((function(e){return Object(ao.A)(e,"Connectors")})),x=l?"MSBEFT":Ya.c;return f.createElement("div",{className:Object(Mn.a)(t,b.footerContent),id:"b_bfb-footerContent"},u&&f.createElement(wn.a,{className:b.buttonWithIcon,iconName:j,text:O,url:d&&d(ar(ar({},u),{normalizedQuery:E}),i,x,v),onClick:n,target:"_self"}))},cr=n(432),lr=Object(v.a)((function(e,t,n){return Object(E.K)({workResultIndicator:{display:"flex",flexDirection:"row",alignItems:"center",padding:"0px 8px",position:"absolute",width:"auto",height:"24px",backgroundColor:"".concat(t),border:"none",color:e.palette.black,textDecoration:"none",borderRadius:"12px"},workResultIndicatorText:{position:"static",fontFamily:"Roboto",fontStyle:"normal",fontWeight:"normal",fontSize:"13px",lineHeight:"16px",padding:"4px 0px 4px 8px",color:"".concat(n)},iconLock:[Ye.a,{width:"10px",padding:"6px 0px",color:"".concat(n)}]})})),sr=function(e){var t=e.className,n=e.iconName,i=e.indicatorColor,o=e.indicatorTextColor,a=Object(p.a)(),r=lr(a,i,o),c=f.createElement(se.a,{className:r.iconLock,iconName:n});return f.createElement("div",null,f.createElement("button",{"aria-label":Object(Nn.L)(),className:Object(Mn.a)(r.workResultIndicator,t)},c,f.createElement("span",{className:r.workResultIndicatorText},Object(Nn.L)())))},ur=n(454),dr=n(1356),br=Object(he.b)((function(e,t,n,i){var o,a,r,c;return Object(E.K)({headerRow:{display:"flex",height:"".concat(n?48:60,"px"),paddingLeft:"20px",backgroundColor:n?i:t.palette.white,borderTopLeftRadius:n?me.a:void 0,borderTopRightRadius:n?me.a:void 0,selectors:(o={},o[E.h]={"-ms-high-contrast-adjust":"none","forced-color-adjust":"none"},o)},masthead:{maxWidth:"400px",selectors:(a={},a[".".concat(U.a)]={maxWidth:"360px"},a)},headerRowRight:{display:"inline-block",verticalAlign:"middle",float:"right",marginTop:"12px",paddingLeft:"".concat(20,"px"),paddingRight:"".concat(13,"px"),marginLeft:"auto",height:"100%",selectors:(r={"> div":{display:"inline-block"}},r[E.h]={"-ms-high-contrast-adjust":"none","forced-color-adjust":"auto"},r)},persona:{display:"inline-block",cursor:"pointer",selectors:(c={":not(:first-child)":{marginLeft:"16px"}},c[".".concat(Jn.a," > div")]=e?{top:"-4px"}:void 0,c)},headerRowNotification:{marginRight:"20px",verticalAlign:"top"},workResultIndicator:{marginTop:"12px",marginLeft:"30px"}})})),mr=n(551),pr=function(e){var t=e.onSignOutClick,n=e.customButton,i=e.className,o=e.buttonClassName,a=e.ariaLabel,r=e.setVisibility,c=f.useRef(null),l="orgid/signout?ru=".concat(encodeURIComponent(window.location.href));return f.createElement("form",{ref:c,action:l,method:"post",className:i},f.createElement("button",{role:"link",onClick:function(){t();var e=c.current;e&&e.submit()},className:o,onBlur:function(){r&&r(!1)},"aria-label":a},n))},fr=n(1006),gr=Object(v.a)((function(e,t){return Object(E.K)({signOutMenu:{whiteSpace:"nowrap"},profilePhoto:{marginLeft:"".concat("7px")},userEmail:[Object(O.o)(e),{margin:t?"5px":"".concat("3px"," ").concat("7px")}],signOut:{margin:t?"0 0 0 auto":"".concat("3px"," 0 ").concat("3px"," auto")},signOutButton:[Object(O.o)(e),Object(pe.s)(e),fr.h,{background:"none",margin:"0",padding:t?"5px 15px":"1px 6px",border:t?Object(Oe.k)(e):"none",borderRadius:t?"15px":void 0}],title:[Object(O.n)(e),{margin:"".concat("3px"," ").concat("7px")}],description:[Object(pe.j)(e),{margin:"".concat("3px"," ").concat("7px")}],learnMorePrivacyLink:[Object(pe.s)(e),j.e,{margin:"7px ".concat("7px")}],topContent:{padding:t?"15px ".concat("12px"," 5px ").concat("12px"):void 0,display:t?"block":"flex",alignItems:t?void 0:"center"},bottomContent:{padding:"10px ".concat("12px"),borderTop:Object(Oe.k)(e),display:"flex",alignItems:"center"}})})),vr=function(e){var t,n=e.description,i=e.className,o=e.isFullVersion,a=e.onSignOutClick,r=e.setVisibility,c=Object(p.a)(),l=Object(ee.a)(),s=Object(ee.c)(),u=Object(ee.d)(),d=Object(k.a)(),b=Object(w.c)(),m=Object($.d)(),g=(null===(t=ce.a.flightParams)||void 0===t?void 0:t.isDeprecateOldLoggerEnabled)?Object(J.a)({clickEventId:"Learn_More_Click",eventScope:"Page",impressionEventId:void 0,logCondition:!1}):void 0,v=gr(c,o),h=f.createElement(f.Fragment,null,f.createElement("div",{className:v.topContent},f.createElement("div",{className:v.userEmail},u),f.createElement(pr,{customButton:ir(),onSignOutClick:a,className:v.signOut,buttonClassName:v.signOutButton,setVisibility:r,ariaLabel:ir()})),f.createElement("div",{className:v.description},f.createElement("span",null,n))),O=l&&s&&f.createElement(ie.a,{fullName:l,photoId:s,size:le.c.size24,className:v.profilePhoto}),j=f.createElement(f.Fragment,null,f.createElement("div",{className:v.topContent},f.createElement("div",{className:v.title},Object(Nn.I)({tenantName:m})),f.createElement("div",{className:v.description},f.createElement("span",null,n)),f.createElement("div",{className:v.learnMorePrivacyLink},f.createElement(mr.a,{text:Object(Nn.k)(),onClick:function(){g?g.clickLogger():Object(re.n)(d,"Learn_More_Click",{clientSize:b,eventScope:"Page"})}}))),f.createElement("div",{className:v.bottomContent},O,f.createElement("div",{className:v.userEmail},u),f.createElement(pr,{customButton:ir(),onSignOutClick:a,className:v.signOut,buttonClassName:v.signOutButton,setVisibility:r,ariaLabel:ir()})));return f.createElement("div",{className:Object(Mn.a)(v.signOutMenu,i)},o?j:h)},hr=function(e){var t=e.onProfilePictureClick,n=e.onSignOutClick,i=e.hideTeaser,o=Object(w.r)(),a=Object(_.t)(),r=Object(_.jb)(),c=Object(p.a)(),l=Object(T.useSelector)(N.L),s=Object(Z.b)(),u=Object(Z.e)(),d=l?48:60,b=br(o,c,l,s),m=f.createElement(ur.a,{className:b.persona,size:le.c.size24}),g=a?tr():er(),v=f.createElement(cr.a,{isSmall:!1,buttonId:"b_bfb-signOutButton",customButton:m,renderInfoButtonContent:function(e,t){return f.createElement(vr,{description:g,onSignOutClick:n,setVisibility:t})},showInfoBubbleOnHover:!0,onClick:t,ariaLabel:nr()}),h=f.createElement(Ke.a,{codeLocation:"MainlineFirstRunNotificationContainer.Bing"},f.createElement(Zt,{profileButton:v,hideTeaser:i})),O=r&&f.createElement(sr,{className:b.workResultIndicator,indicatorColor:u,indicatorTextColor:s,iconName:"LockSolid"});return f.createElement("div",{className:b.headerRow},f.createElement(dr.a,{isPrivacyMessageEnabled:!1,className:b.masthead,selectedHeight:d}),O,f.createElement("div",{className:b.headerRowRight},h))},Or=function(e){var t,n=e.showFrameHeader,i=e.showFrameFooter,o=e.showPrivacyContainer,a=e.customizeFooter,r=e.children,c=e.notification,l=e.footerLinkDomain,s=e.hideTeaser,u=e.hideFeedbackButton,d=e.overwrittenConfidence,b=Object(p.a)(),m=Object(k.a)(),g=Object(w.c)(),v=Object(yt.a)(),h=d||v,O=(null===(t=ce.a.flightParams)||void 0===t?void 0:t.isDeprecateOldLoggerEnabled)?Object(J.a)({clickEventId:"Mainline_Profile_Picture_Click",eventScope:"Mainline",impressionEventId:"NoConfident"===c?"FRE_Low_Confidence_See_Results_Impression":"Mainline_".concat(h,"_Confidence_See_Results_Impression"),logCondition:!0}):void 0,j=Object(_.t)(),E=Object(_.jb)(),x=Object(T.useSelector)(jt.d),S=Ha(),C=Object($.d)(),y=Object(yt.e)(),N=Ga(b,S,y),L=Object(V.c)(x),I=Object(ht.d)(),F=Object(Wt.a)(h),P=Object(hi.b)(Object(hi.a)(h),!0);f.useEffect((function(){h&&!F&&i&&!I&&(!O&&Object(Ne.q)(m,g,h,c),Object(M.a)(m,Object(hi.a)(h),"MainlineFrameImpression"),P.logImpression())}),[m,g,h,F,c,I,i,P]);var A=f.createElement("div",{className:N.feedback},S&&f.createElement(Va,null)),B=f.createElement(f.Fragment,null,f.createElement(Ra.a,{className:N.privacyMessage,isMessageSmall:!!y}),S&&f.createElement("div",{className:N.dotSeparator},f.createElement(Ba.a,{isLarge:!0}))),R=a?f.createElement(f.Fragment,null,a):o?f.createElement(f.Fragment,null,A):f.createElement(f.Fragment,null,B,A);return f.createElement(f.Fragment,null,n&&f.createElement(hr,{onProfilePictureClick:function(){return Object(re.b)(m,g)},onSignOutClick:function(){return O?O.clickLogger("Mainline_Sign_Out_Click"):function(e,t){Object(re.d)(e,t);var n={clientSize:t,eventScope:"Mainline"};Object(Dt.E)(e,{eventId:"Mainline_Sign_Out",properties:n})}(m,g)},hideTeaser:s}),o&&f.createElement(q.b,{className:N.privacyContainer,tenantName:C,onClickLogger:function(){O?O.clickLogger("Learn_More_Click",{eventScope:"Page"}):Object(re.n)(m,"Learn_More_Click",{clientSize:g,eventScope:"Page"})},isEduEnabled:j,isWorkWebDifferentiationEnabled:E,workResultString:L}),r,i&&f.createElement(rr,{onSeeMoreResultsClick:function(){P.logClick()},footerLinkDomain:l}),!u&&f.createElement("div",{className:N.mainlineFooter},R))},jr=function(){var e=Object(T.useSelector)(wt.l),t=Object(T.useSelector)(tn),n=Object(T.useSelector)(wt.n),i=Object(qt.b)(),o=Object(ht.b)(),a=Object(T.useSelector)($o),r=f.createElement("div",{className:lc},void 0===e&&o&&"EducationAssignment"===o?f.createElement(Jo,{domain:o,conversationProvenance:t}):e&&"Connectors"!==e?f.createElement(Jo,{domain:e,conversationProvenance:t}):n?f.createElement(Aa,{domain:n}):f.createElement(fo,null)),c=Object(T.useSelector)(Zo),l=Object(yt.e)();return i?f.createElement(Or,{showFrameHeader:!1,showPrivacyContainer:!0,showFrameFooter:!1},f.createElement(Ke.a,{codeLocation:"TourContainer.Bing"},f.createElement(Qt.a,{notificationKind:"MainlineFirstRun"}))):a?f.createElement(Or,{showFrameHeader:!1,showPrivacyContainer:!1,showFrameFooter:!1,hideFeedbackButton:!0},r):f.createElement(Or,{showFrameHeader:!0,showPrivacyContainer:!0,showFrameFooter:!l,footerLinkDomain:c},r)},Er=function(){return Promise.all([n.e(1),n.e(8),n.e(169)]).then(n.bind(null,3262)).then((function(e){return{default:e.NoConfidentNotification}}))},xr=function(e){return Object(Gt.b)(Er,{chunkName:"serpfre"},Object(k.a)())(e)},Sr=function(e){var t=e.onDismiss,n=Object(k.a)(),i=Object(T.useDispatch)(),o=Object(Ut.a)(),a=Object(w.c)(),r=Object(w.r)(),c=Object(w.k)(),l=Object(Hi.a)().requery,s=Object(T.useSelector)(I.u),u=Object(ee.b)(),d=Object($.d)(),b=Object(R.a)("NoConfident"),m=b.hasNotificationKind,p=b.notificationConfig,g=Object(R.a)("MainlineRetentionGleam").hasNotificationKind,v=m||g,h=g?"MainlineRetentionGleam":"NoConfident",O=Object(D.a)(h,"NoConfidentNotificationContainer",void 0,!0),j=O.logImpression,E=O.logEngagementClick,x=O.logDismissClick,S=Object(qt.a)(),C=o.searchOptions,y=C.buildBingWorkVerticalUrl,_=C.initialSearchQuery;if(f.useEffect((function(){v&&S&&(p&&Object(M.b)(n,p,"Impression"),j())}),[v,S]),!v||!_)return null;return f.createElement(xr,{notificationCampaign:null==p?void 0:p.notificationCampaign,isMobile:"Small"===a&&!r&&!c,requeryStrings:null==p?void 0:p.requeryStrings,isFREV2:s,onDismiss:function(){t(),x()},onRequeryClick:function(e,t,n){E(),y?window.location.href=y({query:t},void 0,"BAWLOG"):l(e,t,n,void 0,{formCode:"BAWLOG"})},onLearnMoreClick:function(){i(Object(Vt.a)({isTourOpen:!0})),E()},logEngagementClick:E,tenantDisplayName:d,userGivenName:u,titleContent:null==p?void 0:p.titleContent,query:_,personaPart:f.createElement(ur.a,{size:le.c.size48})})},Cr=function(){return n.e(15).then(n.bind(null,3307)).then((function(e){return{default:e.BCENotification}}))},yr=function(e){return Object(Gt.b)(Cr,{chunkName:"bceserpnotification"},Object(k.a)())(e)},kr=function(e){var t=e.treatmentVariation,n=e.onDismiss,i=Object(ee.b)(),o=Object(_.t)(),a=Object(_.s)(),r=Object(R.a)("BCEMainline").hasNotificationKind,c=Object(D.a)("BCEMainline","BCENotificationContainer",void 0,!0),l=c.logImpression,s=c.logEngagementClick,u=c.logDismissClick;return f.useEffect((function(){r&&l()}),[r]),r?f.createElement(yr,{notificationKind:"BCEMainline",userGivenName:i,personaPart:f.createElement(ur.a,{size:le.c.size48}),logEngagementClick:s,isEduFaculty:o&&a,treatmentVariation:t,onDismiss:function(){n(),u()}}):null},wr=Object(v.a)((function(e,t,n,i){var o=t||"auto";return Object(E.K)({chatLogoImage:{width:"24px",height:"24px"},chatLogoText:[Object(O.A)(e),{paddingLeft:"8px",color:n,maxWidth:i?"".concat(i,"px"):"180px",maxHeight:"".concat(24,"px"),height:"auto",wordWrap:"break-word",whiteSpace:"initial",borderBottom:"".concat(o," solid transparent"),marginTop:"auto",marginBottom:"auto"}]})})),_r=function(e){var t=e.borderBottom,i=e.textIconColor,o=e.maxWidth,a=Object(p.a)(),r=n(2637),c=wr(a,t,i,o);return f.createElement(f.Fragment,null,f.createElement("img",{className:c.chatLogoImage,src:r,alt:Object(Nn.b)(),"aria-label":Object(Nn.b)(),height:24}),f.createElement("span",{className:c.chatLogoText},Object(Nn.c)()))},Nr=Object(v.a)((function(e,t){var n;return Object(E.K)({HeaderRow:{display:"block",height:"48px",paddingLeft:"20px",borderTopLeftRadius:me.a,borderTopRightRadius:me.a,backgroundColor:e,selectors:(n={},n[E.h]={"-ms-high-contrast-adjust":"none","forced-color-adjust":"none"},n)},masthead:{position:"relative",display:"flex",overflow:"hidden",height:"auto",paddingTop:"".concat(t,"px"),paddingBottom:"".concat(t,"px")}})})),Lr=function(){var e=Object(Z.e)(),t=Object(Z.b)(),n=Nr(t,12);return f.createElement("div",{className:n.HeaderRow},f.createElement("div",{className:n.masthead},f.createElement(_r,{borderBottom:12,textIconColor:e})))},Mr=function(e){var t=e.showFrameHeader,n=e.children,i=e.hideFeedbackButton,o=Object(p.a)(),a=Ha(),r=Ga(o,!i,!1),c=f.createElement("div",{className:r.feedback},a&&f.createElement(Va,null)),l=f.createElement(f.Fragment,null,c);return f.createElement(f.Fragment,null,t&&f.createElement(Lr,null),n,!i&&f.createElement("div",{className:r.mainlineFooter},l))},Tr=function(){return Promise.all([n.e(1),n.e(168)]).then(n.bind(null,3352)).then((function(e){return{default:e.EduDiscoverabilityPillListContainer}}))},Ir=function(e){return Object(Gt.b)(Tr,{chunkName:"serpedufre"})(e)},Fr=Object(v.a)((function(e){return Object(E.K)({scrollable:{paddingTop:e?"12px":void 0}})})),Pr=n(369),Ar=n(1180),Br=Object(v.a)((function(e){var t,n,i;return Object(E.K)({mainlinePillListContainer:{whiteSpace:"nowrap",selectors:(t={},t[".".concat("ms-search-mainlinePill",":first-child")]={marginLeft:"".concat(20,"px")},t[".".concat("ms-search-mainlinePill",":not(:first-child)")]={marginLeft:"8px"},t[".".concat("ms-search-mainlinePill",":last-child")]={marginRight:"".concat(20,"px")},t[".".concat(Ar.a,":hover, .").concat("ms-search-mainlinePillFrame",":hover")]={borderColor:e.palette.neutralTertiary,boxShadow:"0px 2px 3px rgba(0, 0, 0, 0.1)"},t)},mainlinePillFrame:["ms-search-mainlinePillFrame",Object(pe.s)(e),{display:"inline-block",verticalAlign:"middle",overflow:"hidden",textOverflow:"ellipses",padding:"0 10px",height:"50px",selectors:(n={i:{verticalAlign:"middle",marginTop:"-3px",color:e.palette.themePrimary},a:{color:e.palette.themePrimary,textDecoration:"none"}},n["&.".concat(Pr.b)]={lineHeight:"50px"},n)}],mainlinePill:["ms-search-mainlinePill",{verticalAlign:"middle",display:"inline-block",marginBottom:"12px",selectors:{a:{display:"inline-block"}}}],smallPill:{selectors:(i={},i[".".concat(Pr.a)]={width:"70px"},i)}})})),Rr=function(){var e=Object(k.a)(),t=Object(T.useSelector)(N.L),n=Object(p.a)(),i=H(),o=i.activeNotificationKind,a=i.activeNotificationConfig,r=Fr(t),c=Br(n),l=Object(D.a)(o,"MainlineEduDiscoverabilityContainer",void 0,!0),s="DiscoverabilityPillFre"===o;return f.createElement("div",{className:r.scrollable},f.createElement(Ir,{onShown:function(){a&&Object(M.b)(e,a,"Impression"),l.logImpression()},containerStyles:c.mainlinePillListContainer,pillStyles:c.mainlinePill,isFre:s}))},Dr=function(){var e=Object(R.a)("NoConfident").hasNotificationKind,t=Object(R.a)("BCEMainline").hasNotificationKind,n=Object(R.a)("MainlineRetentionGleam").hasNotificationKind,i=Object(T.useSelector)(Ot.c);i=i||"Pole";var o=Object(T.useSelector)(Ot.b),a=Object(qt.b)(),r=Object(_.H)(),c=Object(_.t)(),l=Object(_.u)(),s=Object(_.j)(),u=Object(R.a)("ScopeTabOverlay").hasNotificationKind,d=H().isEnabled;pt(i);var b=function(){ft(i,!1,o)};if(e||n){var m=f.createElement(Or,{showFrameHeader:!1,showPrivacyContainer:!1,showFrameFooter:!1,notification:"NoConfident"},f.createElement(Ke.a,{codeLocation:"TourContainer.Bing"},f.createElement(Qt.a,{notificationKind:"NoConfident",onDismiss:b})));return gt(),a?m:f.createElement(Or,{showFrameHeader:!0,showPrivacyContainer:!1,showFrameFooter:!1,notification:"NoConfident",hideTeaser:r},f.createElement(Ke.a,{codeLocation:"NoConfidentNotificationContainer.Bing"},f.createElement(Sr,{onDismiss:b})))}return c&&d?(gt(),f.createElement(Or,{showFrameHeader:!0,showPrivacyContainer:!0,showFrameFooter:!1,hideTeaser:!0},f.createElement(Rr,null))):!l&&s&&t?(gt(),f.createElement(Mr,{showFrameHeader:!0,hideFeedbackButton:!1},f.createElement(Ke.a,{codeLocation:"BCENotificationContainer.Bing"},f.createElement(kr,{treatmentVariation:s,onDismiss:b})))):(u||ft(),null)},Hr=n(943),Wr=Object(he.b)((function(e){return Object(E.K)({container:[je.a,Object(Pr.h)(e),Ln.a,{backgroundColor:e.palette.neutralLight}]})})),zr=Object(ve.a)((function(e){var t=Wr(e.theme);return f.createElement("div",{className:Object(Mn.a)(e.className,t.container)})})),Kr=n(1079),Qr=n(542),qr=n(866),Ur=n(847),Vr=function(e){var t=Object(Ur.a)(),n=e.className;return f.createElement("div",{className:Object(Mn.a)(t.container,n),"aria-hidden":!0},Object(Nn.s)())},Gr=n(246),Jr=n(2359),Yr=(Object(Qn.declareStringWithPlaceholders)("search-hostapp.search.scopeSummaryPillContainer.countWithPlus")),Xr=(Object(Qn.declareStringWithPlaceholders)("search-hostapp.search.scopeSummaryPillContainer.domainCountSummaryStr"));function $r(e){return 0===e.domainResultsCount}function Zr(e){return!(e.isLoading||$r(e))}function ec(e,t,n,i,o,a){return function(e){switch(e){case"Acronym":case"EmployeeOffer":return!0;case"Bookmark":case"Building":case"Calendar":case"CalendarAvailability":case"Connectors":case"EducationAssignment":case"EducationClass":case"EnterpriseLearning":case"External":case"FederatedSearch":case"File":case"FileEntity":case"FileInferenceAnswer":case"Flight":case"FloorPlan":case"Group":case"Link":case"MeetingRoomProposal":case"Message":case"Notification":case"PeopleAlsoAsk":case"Person":case"PowerBi":case"Qna":case"QueryReformulation":case"SharePoint":case"Site":case"Topic":case"Turing":case"TuringQnA":case"VivaQnA":return!1;default:return Object(nn.a)(e)}}(e)&&n&&e?function(e,t,n,i,o,a){var r={fontSize:Pr.d,fontFamily:t.fonts.small.fontFamily||O.z},c=o&&function(e,t,n){switch(e){case"EmployeeOffer":var i=void 0!==n?n+1:0;return t-(i||1)>0?Object(Nn.q)({count:(t-i).toString()}):void 0;case"Acronym":return t>1?(t-1).toString():void 0;default:return t.toString()}}(e,o,a),l=function(e){switch(e){case"EmployeeOffer":case"Acronym":return!1;default:return!0}}(e),s=Object(ra.b)(n,r),u=function(e,t,n){var i=125-n,o=250;"EmployeeOffer"===e&&(o=180);var a=o-t;return a>i?a:i}(e,s,c?Object(ra.b)(c,r):0),d=Object(ra.c)(n,u,r,Object(Nn.h)());return f.createElement(f.Fragment,null,l&&f.createElement("span",null,Object(Un.a)(e)),l&&f.createElement(Ba.a,{className:i,isLarge:!0}),f.createElement("span",null,d.text),o&&!!c&&f.createElement(f.Fragment,null,f.createElement(Vr,{className:i}),f.createElement("span",null,c)))}(e,t,n,i,o,a):void 0}var tc=Object(T.connect)((function(e,t){var n=t.domain,i=t.conversationProvenance,o=t.candidatePills,a=t.domainResultsCount,r=Object(N.f)(e);return{isSelected:"Small"===r&&Object(Hn.q)(e,n),isAnyScopeCardSelected:"Small"===r&&!!Object(Hn.b)(e),isLoading:Object(Jr.e)(n)&&Object(wt.D)(e),domainResultsCount:a||Object(wt.c)(e,n,void 0,void 0,i,Qr.a),domainTitle:Object(wt.q)(e,n),domainSubTitle:Object(wt.p)(e,n,null==o?void 0:o.length)}}),(function(e,t){return{toggleSelectScopeCardAction:function(n){var i=t.domain,o=t.conversationProvenance;e(Object(Bn.p)({source:"UserExplicit",selectedScopeCardDomain:n?i:void 0,selectedConversationProvenance:o}))},selectHeroDomainAction:function(t){e(Object(Gr.d)({domain:t,resultId:void 0,hideHero:!0}))}}}))((function(e){var t=e.isLoading,n=e.domainTitle,i=e.domainSubTitle,o=e.className,a=e.domain,r=e.domainResultsCount,c=e.conversationProvenance,l=e.isSelected,s=e.isAnyScopeCardSelected,u=e.toggleSelectScopeCardAction,d=e.selectHeroDomain,b=e.selectHeroDomainAction,m=e.onPillShown,g=e.noToggle,v=e.candidatePills,h=e.canaditeResults,O=e.href,j=e.title,E=e.iconName,x=(null==v?void 0:v.length)||(null==h?void 0:h.length),S=Object(w.c)(),C=Object(Dn.g)({clientSize:S}),y=Object(w.r)(),N=Object(p.a)(),L=Object(Ja.b)(),M=Object(T.useSelector)(ao.r),I=Object(_.X)(),F=L&&L.color||N.palette.themePrimary,P=f.useState(!1),A=P[0],B=P[1],R=Object(k.a)(),D=Object(hi.b)("MainlineSummaryPill",!0),H="Turing"===a?.8:void 0,W=Object(Ar.b)(C,H),z=Object(zn.d)(a,r,"List",!1,!1),K=z.shownCount,Q=z.showSeeMoreLink,q=Object(Wt.a)(e);f.useEffect((function(){q&&Zr(q)||!Zr(e)||!m||m(a)}),[q,m,a,e]),f.useEffect((function(){D&&!A&&(Object(Ne.r)(R,a,S),D.logImpression(),B(!0))}),[D]);if(t)return f.createElement(zr,{className:Object(Mn.a)(o,W.ghostPill)});if(I)return null;if($r(e))return null;var U,V,G,J=j||(n||Object(Un.a)(a,c,void 0,M)),Y=i||(U=Q,V=String(K),G=U?Yr({count:V}):V,Xr({countWithOptionalPlus:G}));if(!J)return null;var X=!O,$={primaryText:J,secondaryText:Y,secondaryContent:ec(a,N,Y,W.splitterClassName,K,x),isSelected:l,isSmall:C,tenantThemeColor:F,iconName:E||Object(zn.c)(a),iconColor:Object(zn.b)(a),className:Object(Mn.a)(o,W.scopePillFrame),isTabStopDisabled:s&&!l&&!y,onClick:function(){g||(u(!l),d&&b(a)),D.logClick()},href:O,isRoleTab:X,shouldRenderButton:!1};return f.createElement(qr.a,Object(mn.__assign)({},$))})),nc=function(){var e,t=Object(Ut.a)().searchOptions.buildBingWorkVerticalUrl,n=Object(w.c)(),i=Object(k.a)(),o=Object(Oi.b)(),a=Object(Oi.c)(),r=Object(p.a)(),c=Object(T.useSelector)(wt.K),l=f.useRef(Object(Hr.a)()),s=Object(T.useSelector)(N.Od);Object(Co.a)({pageNumber:hn.b,pageSize:hn.d,showResultCluster:!1,aggregations:void 0,refiningQueries:void 0,isEnabled:!0,isSerpUsingSubstrateUnifiedSearch:!1,isNLFileSearchEnabled:!1,isTuringMarkerEnabled:s});var u=Object(T.useSelector)((function(e){return Object(vi.a)(e)})),d=It(c,!1,u,void 0),b=d.shownCandidates,m=d.shownDomainResultsCount,g=Ft(b,m),v=Br(r),h=Object(T.useSelector)((function(e){return Object(Ot.c)(e)})),O=Object(T.useSelector)(Ot.b),j=Object(T.useSelector)(vi.l),E=Object(hi.b)(Object(hi.a)("Medium"),!0),x=f.useState(!1),S=x[0],C=x[1],y=f.useState(!1),_=y[0],L=y[1];f.useEffect((function(){i&&(_||(Object(M.a)(i,Object(hi.a)("Medium"),"MainlineMiniWorkScopePillListContainerImpression"),L(!0)),E&&n&&!S&&(Object(Ne.q)(i,n,"Medium"),E.logImpression(),C(!0)))}),[i,E,n,_]);if(j)return f.createElement(zr,null);if(m&&m[0]&&0===(null===(e=m[0].candidates)||void 0===e?void 0:e.length))return ft(h=h||"Pole",void 0,O),f.createElement(f.Fragment,null);var I=Object(z.a)(m,(function(e,t){var n;if(o)return f.createElement("div",{className:v.mainlinePill,key:t},f.createElement(tc,{domain:e.domain,selectHeroDomain:!0,impressionEventId:"Mainline_Pill_Impression",groupClickEventId:"Mainline_Pill_Click",groupReferenceId:l.current,noToggle:!1,index:t,candidatePills:e.candidates,domainResultsCount:null===(n=null==e?void 0:e.candidates)||void 0===n?void 0:n.length,title:o,iconName:Te.I}))})),F=a&&f.createElement(Kr.a,{text:Xa(),url:t&&t({query:a},void 0,Ya.d),className:Object(Mn.a)(v.mainlinePillFrame,v.mainlinePill),onClick:function(){E.logClick()}});return g&&o?f.createElement("div",{className:v.mainlinePillListContainer},I,F):null};var ic=n(1337),oc=n(1679),ac=function(){var e=Object(w.c)(),t=Object(k.a)(),n=Object(Oi.b)(),i=Object(Oi.c)(),o=Object(p.a)(),a=Object(T.useSelector)(wt.K),r=Object(T.useSelector)(N.eb),c=function(e){return Object(T.useSelector)((function(t){return Object(wt.a)(t,e)}))}(e),l=f.useRef(Object(Hr.a)()),s=Object(T.useSelector)((function(e){return Object(wt.e)(e)})),u=At(s),d=Object(T.useSelector)((function(e){return Object(wt.s)(e,u)})),b=Object(w.y)().buildBingWorkVerticalUrl,m=Pt(s),g=It(a,!1,c,d,m,r),v=g.shownCandidates,h=g.shownDomainResultsCount,O=Ft(v,h),j=Br(o),E=m?j.smallPill:void 0,x=Object(ic.a)(),S=Object(hi.b)(Object(hi.a)("Medium"),!0),C=f.useState(!1),y=C[0],_=C[1],L=f.useState(!1),I=L[0],F=L[1],P=v&&Object(z.a)(v.candidates,(function(e,t){return f.createElement("div",{className:j.mainlinePill,key:t},f.createElement(oc.a,{domain:v.domain,position:1,candidate:e,impressionEventId:"Mainline_RichPill_Impression",clickEventId:"Mainline_RichPill_Click",groupReferenceId:l.current,className:E,index:t,onCandidateClick:function(e){x(v.domain,e)}}))})),A=Object(z.a)(h,(function(e,t){var i;if(n)return!Rt(e.domain,r)||!e.candidates||v&&v.domain===e.domain?!Rt(e.domain,r)&&f.createElement("div",{className:j.mainlinePill,key:t},f.createElement(tc,{domain:e.domain,selectHeroDomain:!0,impressionEventId:"Mainline_Pill_Impression",groupClickEventId:"Mainline_Pill_Click",groupReferenceId:l.current,noToggle:!0,index:t,candidatePills:e.candidates,entitiesCount:null===(i=e.candidates)||void 0===i?void 0:i.length,href:b&&b({query:n},e.domain)})):f.createElement("div",{className:j.mainlinePill,key:t},f.createElement(oc.a,{domain:e.domain,position:1,candidate:e.candidates[0],impressionEventId:"Mainline_RichPill_Impression",clickEventId:"Mainline_RichPill_Click",className:E,groupReferenceId:l.current,index:t,onCandidateClick:function(t){x(e.domain,t)}}))}));f.useEffect((function(){t&&(I||(Object(M.a)(t,Object(hi.a)("Medium"),"MainlineScopePillListContainerImpression"),F(!0)),S&&e&&!y&&(Object(Ne.q)(t,e,"Medium"),S.logImpression(),_(!0)))}),[t,S,e]);var B=i&&f.createElement(Kr.a,{text:Xa(),url:b&&b({query:i},void 0,Ya.d),className:Object(Mn.a)(j.mainlinePillFrame,j.mainlinePill),onClick:function(){S.logClick()}});return O&&n?f.createElement("div",{className:j.mainlinePillListContainer},P,A,B):null},rc=function(){var e=Object(qt.b)(),t=Object(T.useSelector)(N.L),n=Object(ht.d)(),i=Object(T.useSelector)($o),o=Fr(t),a=f.createElement("div",{className:o.scrollable},f.createElement(na.a,{className:"ms-search-mainlineCarousel",carouselType:"HalfBleed",scrollAnimationDuration:1e3,renderCarouselContent:function(e){return f.createElement("div",{id:e},n?f.createElement(nc,null):f.createElement(ac,null))},minScrollDistance:20,scrollAmount:100,scrollArrowTopPosition:8}));return e?f.createElement(Or,{showFrameHeader:!1,showPrivacyContainer:!0,showFrameFooter:!1},f.createElement(Ke.a,{codeLocation:"TourContainer.Bing"},f.createElement(Qt.a,{notificationKind:"MainlineFirstRun"}))):i?f.createElement(Or,{showFrameHeader:!1,showPrivacyContainer:!1,showFrameFooter:!1,hideFeedbackButton:!0},f.createElement(Aa,{domain:"EnterpriseLearning"})):f.createElement(Or,{showFrameHeader:!0,showPrivacyContainer:!0,showFrameFooter:!1},a)},cc=function(){return f.createElement(Or,{showFrameHeader:!0,showPrivacyContainer:!0,showFrameFooter:!0,footerLinkDomain:"File",overwrittenConfidence:"High"},f.createElement("div",{className:lc},f.createElement(fo,null)))},lc="ms-search-noOverflowContent",sc=function(){var e=Object(A.b)(),t=Object(A.a)(),n=Object(_.B)(),i=Object(T.useSelector)(Kt.a),o=n&&t&&i&&i.length>0;return e?f.createElement(rc,null):o?f.createElement(cc,null):t?f.createElement(Dr,null):f.createElement(jr,null)},uc=n(1261),dc=n(384),bc=n(286),mc=Object(v.a)((function(e,t,n){var i,o,a;return Object(E.K)({mainlineContainer:[Object(Oe.f)(e),"ms-search-ribbon",n?{marginBottom:"20px"}:void 0,t?{border:"1px solid #ddd",boxShadow:"none"}:{},{paddingLeft:"0px",backgroundColor:e.palette.white,selectors:(i={},i["div#".concat("b_bfb-footerContent"," > a, div#").concat("b_bfb-footerContent"," > a:visited")]=[Object(O.o)(e),{display:"inline-block"}],i[".".concat("ms-search-scopeCardContent")]={marginBottom:"0px",borderBottom:"none"},i[".".concat(ri.a)]={paddingBottom:"0px",paddingTop:"".concat(Sn.d-ri.c,"px"),selectors:(o={},o["div.".concat(ri.b,":last-child")]={borderBottom:"none"},o["> div:last-child .ms-search-buttonWithInfoBubble-info"]={top:"-50px"},o)},i[".".concat(lc)]={overflow:"hidden"},i[".".concat(gi.b,", .").concat(dc.c,",\n              .").concat(uc.a)]={paddingTop:"".concat(Sn.d,"px")},i)}],contentRow:{marginLeft:"0px",selectors:(a={},a[".".concat(Yn.a)]={display:"none"},a[".".concat(bc.b)]={border:"none",borderRadius:0,maxWidth:"100%"},a)},header:{fontSize:"14px",lineHeight:"20px",marginLeft:"4px",marginBottom:"10px"}})})),pc=function(){var e=f.useState(!1),t=e[0],n=e[1],i=Object(k.a)(),o=Object(w.c)(),a=Object(_.C)(),r=Object(A.b)(),c=Object(p.a)(),l=Object(T.useSelector)(N.Pb),s=Object(T.useSelector)(Xo),u=Object(T.useSelector)(N.L),d=Object(T.useSelector)($o),b=Object(T.useSelector)((function(e){return Object(Ot.c)(e)})),m="RightRail"===(b=b||"Pole"),g=Object(T.useSelector)((function(e){return Object(jt.c)(e,m)})),v=Object(T.useSelector)(Ot.b),h=Object(T.useSelector)((function(e){return Yo(e,m)})),O=H().isEnabled,j=Object(_.t)()&&"Low"===v&&O,E=Object(_.B)(),x=h||j||E&&"Low"==v,S=Object(ht.d)();if(f.useEffect((function(){!x||t||S||(Object(Ne.o)(i,o),n(!0))}),[x,i,o,S]),!x)return ft(b,void 0,v),null;pt(b,v);var C=mc(c,l,m),y=g?f.createElement("div",{className:C.header},g):void 0;return d?f.createElement(sc,null):f.createElement(f.Fragment,null,s?f.createElement(zt,null):f.createElement(f.Fragment,null,y,f.createElement("div",{className:C.mainlineContainer},!u&&f.createElement(vt.a,null),!(r&&a)&&f.createElement("div",{className:C.contentRow},f.createElement(sc,null)))))},fc=function(e){var t=e.query;return f.createElement(Qe.a,null,f.createElement(bt.a,{query:t,onCleanUp:ft},f.createElement(pc,null),f.createElement(Ke.a,{codeLocation:"ScopeTabNotificationContainer.Bing"},f.createElement(st,null))))},gc=n(1645),vc=n(1994),hc=n(1366),Oc=n(1259),jc=n(1344),Ec=n(1345),xc=n(1126),Sc=n(842);var Cc=Object(Ea.a)("EnterpriseSubscription",(function(e,t){return Object(mn.__awaiter)(this,void 0,void 0,(function(){var n,i,o;return Object(mn.__generator)(this,(function(a){switch(a.label){case 0:return n=t.ResultCount,i=t.Filter,o=e.createRequestUrl("employee/subscription/all","v3",{ResultCount:"".concat(n),Filter:"".concat(i)}),[4,e.makeRequest(o,"GET",t)];case 1:return[2,a.sent()]}}))}))})),yc=Object(Oa.c)("EnterpriseSubscriptionStore",Cc),kc=n(145);function wc(e,t){var n,i;if(t){var o=null==e?void 0:e.getElementsByClassName("b_algoheader")[0],a=null==o?void 0:o.getElementsByTagName("a")[0];return null==a?void 0:a.href}var r=null==e?void 0:e.getElementsByTagName("h2"),c=null===(n=null==r?void 0:r[0])||void 0===n?void 0:n.getElementsByTagName("a");return null===(i=null==c?void 0:c[0])||void 0===i?void 0:i.href}function _c(e){if(e){var t="/"===e[e.length-1]?null==e?void 0:e.slice(0,-1):e;return null==t?void 0:t.replace(/^https?\:\/\//i,"")}return""}var Nc=function(e){var t={};if(e){var n=document.querySelectorAll("li.b_algo"),i={};Object(kc.a)(n,(function(e,t){var n=_c(wc(e));n&&(i[n]=t)}));var o=_c(wc(n[0])),a=Object(_t.a)(e,(function(e){return _c(e.url)===o}));Object(kc.a)(e,(function(e){if(e.url&&e.avgWeightedCTR&&e.avgWeightedSatScore&&!t.url){var o=_c(null==e?void 0:e.url),r=i[o];if(0===r){if(c=n[r],u=null===(l=document.getElementById("b_results"))||void 0===l?void 0:l.firstElementChild,d=null==u?void 0:u.nextElementSibling,u!==c&&(0!==(null===(s=null==u?void 0:u.getBoundingClientRect())||void 0===s?void 0:s.height)||d!==c))return void(t=e)}else if(r>0){if(!(a&&a.avgWeightedCTR&&a.avgWeightedSatScore))return void(t=e);if((null==e?void 0:e.avgWeightedCTR)>(null==a?void 0:a.avgWeightedCTR)&&(null==e?void 0:e.avgWeightedSatScore)>(null==a?void 0:a.avgWeightedSatScore))return void(t=e)}}var c,l,s,u,d}))}return t};var Lc=Object(Ea.a)("EnterpriseSuggestion",(function(e,t){return Object(mn.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(mn.__generator)(this,(function(o){switch(o.label){case 0:return n=e.createRequestUrl("enterprise/suggestions","v3"),[4,e.makeRequest(n,"POST",t)];case 1:return i=o.sent(),[2,Nc(null==i?void 0:i.suggestions)]}}))}))})),Mc=Object(Oa.c)("EnterpriseSuggestionStore",Lc);var Tc=n(840),Ic=n(665),Fc=n(989),Pc=n(1535),Ac=n(1273),Bc=n(1274),Rc=n(1275),Dc=n(1277),Hc=n(1276),Wc=n(1278),zc=n(1272),Kc=n(666),Qc=n(579),qc=n(1256),Uc=n(197),Vc=n(881),Gc=n(1521),Jc=n(229),Yc=function(){function e(){var e=this;this.isQFReady=!1;window.sj_evt.bind("msb:qf:rdy",(function t(){e.isQFReady=!0,Object(c.a)("QFReady Event fired"),window.sj_evt.unbind("msb:qf:rdy",t)}),!0,void 0,!0),this.qfDataProvider=window.BingAtWork}return e.prototype.getQueryFormulationSuggestions=function(){var e,t=null===(e=this.qfDataProvider)||void 0===e?void 0:e.getSuggestions;if(!t||!this.isQFReady)throw"getQueryFormulationSuggestions failed as window.BingAtWork.getSuggestions is undefined";var n=Object(Jc.g)("q");return n?new r.a((function(e,i){t(n,(function(t){e(t)}),(function(e){return i(e)}),{domains:["File"],count:10,scope:"MainlineQF"})})):r.a.resolve([])},e}(),Xc=n(1522),$c=n(1523),Zc=n(550),el=function(e,t,n,i){return new(n||(n=r.a))((function(o,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function c(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}l((i=i.apply(e,t||[])).next())}))},tl=function(e,t){var n,i,o,a,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof s.a&&(a[d.a]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(r=0)),r;)try{if(n=1,i&&(o=2&c[0]?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){r=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){r.label=c[1];break}if(6===c[0]&&r.label<o[1]){r.label=o[1],o=c;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(c);break}o[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(e){c=[6,e],i=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}};function nl(e){var t=e.reduxStore;if(t){var n,i,o=Object(Vc.a)(e),a=o.searchOptions,r=new Yc,c=o.logger,l=Object(F.a)(a.msbApiVariants,"bfbqfmlflhc"),s=Object(F.a)(a.msbApiVariants,"bfbqfmlft1")?4e3:5e3;n=!1,i=setTimeout((function(){n=!0,t.dispatch(Object(Xc.a)({isQFReady:!1,suggestionsFetchStatus:"Failed",suggestions:[]}))}),s),window.sj_evt.bind("msb:qf:rdy",(function(){return il(t,r,l,c,i,n)}),!0,void 0,!0)}}var il=function e(t,n,i,o,a,r){try{if(clearTimeout(a),r)return;t.dispatch(Object(Xc.a)({isQFReady:!0,suggestionsFetchStatus:"Started",suggestions:[]}));var l=Object(Uc.a)(),s=function(e,t,n){return el(this,void 0,void 0,(function(){return tl(this,(function(i){return[2,function(){return Object(Zc.i)(t,(function(){return e.getQueryFormulationSuggestions()}),"QueryFormulation_MainlineFileHero_RoundTripTime",!1,void 0,"File",n)}()]}))}))}(n,o,l);null==s||s.then((function(e){var n=i?Object($c.b)(e):e;if(n){var o="Mainline QF Suggestion Fetch  got ".concat(n.length," suggestions from qf");Object(c.a)(o),t.dispatch(Object(Xc.a)({isQFReady:!0,suggestionsFetchStatus:"Complete",suggestions:n,traceId:l}))}else Object(c.a)("Mainline QF has no eligible suggestions")})).catch((function(e){Object(c.a)("Mainline QF Suggestion Fetch Promise failed with error ",e),t.dispatch(Object(Xc.a)({isQFReady:!0,suggestionsFetchStatus:"Failed",suggestions:[]}))}))}catch(e){Object(c.a)("Mainline QF Suggestion Fetch Bind event failed with error ",e)}window.sj_evt.unbind("msb:qf:rdy",(function(){return e(t,n,i,o,a,r)}))};var ol=n(1252),al=n(1251),rl=n(499);function cl(){return{initialize:function(e){return function(e){var t=e.reduxStore,n=Object(Vc.a)(e),i=n.logger,o=n.searchOptions.isAjax;if(!t)return;var a=function(){window.sj_evt.bind("bfbMainlineRankingStarted",(function(){t.dispatch(Object(ol.b)({isStartedEventFired:!0}))}),!0,void 0,!0),window.sj_evt.bind("bfbMainlineRankingSucceeded",(function(e){var n=e[1];Object(rl.d)(i,n),t.dispatch(Object(ol.c)({isSucceededEventFired:!0,ranking:n}))}),!0,void 0,!0),window.sj_evt.bind("bfbMainlineRankingFailed",(function(){Object(rl.e)(i,"Failed"),t.dispatch(Object(ol.a)({isFailedEventFired:!0}))}),!0,void 0,!0)};o?window.sj_evt.bind("ajax.load",(function(){a()})):a()}(e)},stores:[al.a]}}var ll,sl=n(213);!function(e){e[e.Unknown=-1]="Unknown",e[e.Published=0]="Published",e[e.Expired=1]="Expired",e[e.Draft=2]="Draft",e[e.Suggested=4]="Suggested"}(ll||(ll={}));function ul(e){return yc.getSelectors(e).hasError({key:"EnterpriseSubscription"})}function dl(e){return yc.getSelectors(e).hasLoaded({key:"EnterpriseSubscription"})}function bl(e){return yc.getSelectors(e).isLoading({key:"EnterpriseSubscription"})}function ml(e){var t,n,i=function(e){return yc.getSelectors(e).getLatestSuccess({key:"EnterpriseSubscription"})}(e);return(null==i?void 0:i.subscriptionList)&&(t=null==i?void 0:i.subscriptionList.subscription,n={},Object(kc.a)(t,(function(e){var t=e.providerUrl.toLowerCase().replace("www.","");n[t]?n[t].push(e):n[t]=[e]})),n)}function pl(){var e=Object(mn.__read)(f.useState(!1),2),t=e[0],n=e[1],i=Object(sl.a)(bl,dl,ul,ml,(function(e){return function(e){var t=e.monitorStarter,n=e.msbRestProvider,i=e.logger,o={clientContext:Object(ja.g)(e),ResultCount:100,Filter:ll.Published},a={monitorStarter:t,logger:i,rttName:"EnterpriseSubscription_RoundTripTime",msbRestProvider:n,fetchSoftTimeout:5e3};return Object(Oa.a)(Cc)(a,{key:"EnterpriseSubscription"},o)}(e)}),"FetchEnterpriseSubscription",Object(_.db)(),t?function(){return n(!1)}:void 0),o=Object(T.useSelector)((function(e){return function(e){return!Object(de.a)(ml(e))}(e)}));return{subscriptionMap:i.data,isFetchingEnterpriseSubscription:i.isFetching,isFetchingEnterpriseSubscriptionFailed:i.isFetchFailed,hasFetchedEnterpriseSubscription:i.hasFetched,hasEnterpriseSubscription:o,retryRequests:function(){return n(!0)}}}function fl(e){return Mc.getSelectors(e).hasError({key:"EnterpriseSuggestion"})}function gl(e){return Mc.getSelectors(e).hasLoaded({key:"EnterpriseSuggestion"})}function vl(e){return Mc.getSelectors(e).isLoading({key:"EnterpriseSuggestion"})}function hl(e){return Mc.getSelectors(e).getLatestSuccess({key:"EnterpriseSuggestion"})}function Ol(){var e=Object(mn.__read)(f.useState(!1),2),t=e[0],n=e[1],i=Object(sl.a)(vl,gl,fl,hl,(function(e){return function(e){var t,n=e.monitorStarter,i=e.msbRestProvider,o=e.logger,a=e.searchOptions,r={query:null===(t=null==a?void 0:a.initialSearchQuery)||void 0===t?void 0:t.query,clientContext:Object(ja.g)(e)},c={monitorStarter:n,logger:o,rttName:"EnterpriseSuggestion_RoundTripTime",msbRestProvider:i,fetchSoftTimeout:5e3};return Object(Oa.a)(Lc)(c,{key:"EnterpriseSuggestion"},r)}(e)}),"FetchEnterpriseSuggestion",Object(_.fb)(),t?function(){return n(!1)}:void 0),o=Object(T.useSelector)((function(e){return function(e){return!Object(de.a)(hl(e))}(e)}));return{suggestion:i.data,isFetchingEnterpriseSuggestion:i.isFetching,isFetchingEnterpriseSuggestionFailed:i.isFetchFailed,hasFetchedEnterpriseSuggestion:i.hasFetched,hasEnterpriseSuggestion:o,retryRequests:function(){return n(!0)}}}var jl=n(198),El=n(182);function xl(e){var t;if(!Object(jt.i)(e,"Person")){var n=null===(t=function(e){return{results:Object(jt.b)(e,"Person")}}(e))||void 0===t?void 0:t.results,i=Object(El.f)(e);return i?Object(_t.a)(n,(function(e){return e.id===i})):Object(jl.a)(n)}}var Sl=Object(he.b)((function(e,t,n,i,o,a,r,c,l,s,u){var d,b=e.palette,m=b.neutralLighter,p=b.neutralSecondary,f=b.blueMid,g=b.white,v=b.black,h=n||f,j={content:"''",position:"absolute",width:i?"20.1px":"16.1px",height:i?"20.1px":"16.1px",borderRadius:i?"0 2px 2px 2px":"0 1px 2px 1px",transform:"rotate(-45deg) skew(10deg, 10deg)",background:"linear-gradient(-45deg, ".concat(f," 50%, transparent 50%)")};return Object(E.K)({popupHeader:{display:"flex",height:"48px",paddingLeft:"20px",backgroundColor:s?"none":h,borderTopLeftRadius:me.a,borderTopRightRadius:me.a},masthead:{maxWidth:"400px",selectors:(d={},d[".".concat("ms-search-tenantLogo")]={maxWidth:"360px"},d)},closeButton:{display:"inline-block",verticalAlign:"middle",float:"right",marginLeft:"auto",cursor:"pointer",marginRight:"18px",selectors:{i:{color:t}}},title:{marginTop:"15px",marginLeft:"20px",marginRight:"16px",fontSize:"15px",lineHeight:"18px",color:v},details:{marginTop:"12px",marginLeft:"20px",marginRight:"16px",fontSize:"13px",lineHeight:"18px",color:p,marginBottom:o?"":"20px"},anchorStyle:{marginTop:"8px",backgroundColor:"".concat(m," !important"),height:"64px"},primaryButton:{width:"157px",height:"32px",margin:"16px 41px 16px 42px",fontSize:"13px",backgroundColor:f,borderColor:f,selectors:{"&:hover, &:active":{backgroundColor:f,borderColor:f}}},popupContainer:{width:"240px",display:"flex",flexDirection:"column"},buttonContainer:[Object(pe.j)(e),{selectors:{":hover":{color:e.palette.black}}},Object(pe.t)(e),{display:"inline-block",height:"".concat(18,"px"),borderRadius:"2px",marginBottom:i?"20px":"0px",selectors:{"> button":{outline:"none",padding:"1px 0px 8px 0px"}}}],arrowButton:[Object(pe.t)(e),{borderRadius:"2px 0px 0px 2px",fontSize:i?"14px":"11px",lineHeight:i?"18px":"14px",cursor:u?void 0:"pointer",color:g,fontWeight:"bold",position:"relative",display:"inline-flex",background:f,height:i?"18px":"14px",padding:i?"2.2px 2px 2px 8px":"2px 2px 2px 4px",alignItems:"center",selectors:{"&::after":[j,{right:i?"-9.1px":"-7.1px"}],"&::before":[j,{right:i?"-10.1px":"-8.1px"}]}}],tenantLabel:[Object(O.n)(e),{color:f,fontSize:i?"14px":"13px",lineHeight:i?"18px":"17px",cursor:u?void 0:"pointer",textDecoration:u?void 0:"underline",marginLeft:i?"20px":"15px"}],splitter:{marginLeft:"4px",marginRight:"4px"},bubbleContainer:{top:"".concat(r,"px !important"),left:"".concat(a,"px !important"),selectors:{"::after":{borderBottom:"".concat(8,"px solid ").concat(!s&&h," !important"),borderLeft:"".concat(8,"px solid transparent !important"),borderRight:"".concat(8,"px solid transparent !important")}}},customButton:{position:"relative",background:"none",border:"none"},infoBubble:{display:c||l?"block":"none"},bubbleWrapper:{position:"relative"}})})),Cl=function(e){var t=e.id,n=e.decorationType,i=e.attachEventListener,o=Object(k.a)(),a=Object(w.c)();return f.useEffect((function(){"EnterpriseSuggestion"===n&&(Object(Ne.h)(o,t,"Enterprise_Suggestion_Impression","AlgoDecoration",a),i&&i()),"LinkedInDecoration"===n&&(Object(Ne.n)(o,t,"LinkedIn_AlgoDecoration_Impression","AlgoDecoration",a),i&&i())}),[o,a]),null},yl=n(2638),kl=function(e,t,n,i,o){if(t&&i&&e&&!o){var a=0,r=void 0;return Object(kc.a)(i,(function(e){var t,i,o=e.providerUrl.toLowerCase().replace("www.",""),c=e.providerUrlRelativePath?(e.providerUrlRelativePath.startsWith("/")?"":"/")+e.providerUrlRelativePath.toLowerCase():"",l=null===(t=null==n?void 0:n.domain)||void 0===t?void 0:t.toLowerCase(),s=null===(i=null==n?void 0:n.relativeUrl)||void 0===i?void 0:i.toLowerCase(),u=o===l;if(u&&c.length>0&&(u=0===(null==s?void 0:s.indexOf(c))),u){var d=o.length+c.length;d>a&&(a=d,r=e)}})),r}},wl=function(e,t,n,i,o){var a,r,c,l,s,u,d,b,m;if(t&&o&&e&&(null===(r=null===(a=null==n?void 0:n.domain)||void 0===a?void 0:a.toLowerCase())||void 0===r?void 0:r.includes("linkedin.com"))){var p=null===(s=null===(l=null===(c=e.getElementsByTagName("h2"))||void 0===c?void 0:c[0])||void 0===l?void 0:l.textContent)||void 0===s?void 0:s.toLowerCase(),f=null===(d=null===(u=e.getElementsByClassName("b_factrow b_twofr"))||void 0===u?void 0:u[0])||void 0===d?void 0:d.innerHTML.toLowerCase(),g={includeScore:!0,caseSensitive:!1,minMatchCharLength:3,threshold:.8,shouldSort:!0},v=[],h=[],O=null===(m=null===(b=e.getElementsByClassName("b_vlist2col"))||void 0===b?void 0:b[0])||void 0===m?void 0:m.getElementsByTagName("div");Object(kc.a)(O,(function(e){var t,n,i,o,a,r,c,l=null==e?void 0:e.textContent,s=null===(n=null===(t=null==e?void 0:e.getElementsByTagName("strong"))||void 0===t?void 0:t[0])||void 0===n?void 0:n.textContent,u="Occupation:"===(null===(o=null===(i=null==e?void 0:e.getElementsByTagName("strong"))||void 0===i?void 0:i[0])||void 0===o?void 0:o.textContent)||"Title:"===(null===(r=null===(a=null==e?void 0:e.getElementsByTagName("strong"))||void 0===a?void 0:a[0])||void 0===r?void 0:r.textContent);if(l&&s&&u){var d=l.slice(s.length+1),b=null===(c=d.match(/\b[A-Z](?=[a-z])|, \b\w*/g))||void 0===c?void 0:c.join("");v.push(d),b&&h.push(b)}}));var j=new yl(v,g),E=new yl(h,g),x=Object(F.a)(p+f,i.toLowerCase()),S=Object(F.a)(p+f,o.fullName.toLowerCase()),C=!1;if(o.jobTitle&&x&&S){var y=j.search(o.jobTitle)[0],k=E.search(o.jobTitle)[0];y&&"string"!=typeof y?C=(null==y?void 0:y.score)<.5:k&&"string"!=typeof k&&(C=(null==k?void 0:k.score)<.7)}return x&&S&&C?o:void 0}};function _l(e,t){var n=null==e?void 0:e.getElementsByTagName("a")[0];return n.addEventListener("click",t),function(){n.removeEventListener("click",t)}}var Nl=n(2435),Ll=n(1165),Ml=n(347),Tl=n(2342),Il=n(346),Fl=(Object(Qn.declareString)("search-answer-decorator.search.algoDecoration.getAccess")),Pl=(Object(Qn.declareString)("search-answer-decorator.search.algoDecoration.freeLabel")),Al=(Object(Qn.declareString)("search-answer-decorator.search.algoDecoration.subscriptionMessage")),Bl=(Object(Qn.declareStringWithPlaceholders)("search-answer-decorator.search.algoDecoration.trendingInEnterprise")),Rl=(Object(Qn.declareStringWithPlaceholders)("search-answer-decorator.search.algoDecoration.suggestionDescription")),Dl=(Object(Qn.declareString)("search-answer-decorator.search.algoDecoration.suggestionLabel")),Hl=(Object(Qn.declareString)("search-answer-decorator.search.algoDecoration.colleagueLabel")),Wl=(Object(Qn.declareString)("search-answer-decorator.search.algoDecoration.defaultTenantText")),zl=(Object(Qn.declareStringWithPlaceholders)("search-answer-decorator.search.algoDecoration.subscriptionForTenantLabel")),Kl=(Object(Qn.declareStringWithPlaceholders)("search-answer-decorator.search.algoDecoration.forTenantLabel")),Ql=(Object(Qn.declareStringWithPlaceholders)("search-answer-decorator.search.algoDecoration.atTenantLabel")),ql=(Object(Qn.declareStringWithPlaceholders)("search-answer-decorator.search.algoDecoration.atTenantLabelForSuggestions")),Ul=n(3013),Vl=function(e){var t=e.title,n=e.details,i=e.buttonText,o=e.setVisibility,a=e.setIsPopupFading,r=e.url,c=e.BrandMasthead,l=e.onClick,s=e.onClose,u=Object(p.a)(),d=Object(w.r)(),b=Object(Z.e)(),m=Object(T.useSelector)(N.L),g=Object(Z.b)(),v=Sl(u,b,m?g:void 0,void 0,r,void 0,void 0,void 0,void 0,d);return f.createElement("div",{className:v.popupContainer},f.createElement("div",{className:v.popupHeader},f.createElement(c,{isPrivacyMessageEnabled:!1,className:v.masthead,selectedHeight:48}),f.createElement(wn.a,{iconName:"ChromeClose",onClick:function(){o&&o(!1),a&&a(!1),s&&s(!1)},className:v.closeButton})),f.createElement("div",{className:v.title}," ",t),f.createElement("div",{className:v.details}," ",n),r&&f.createElement("a",{href:r,target:"_blank",onClick:l?function(){return l()}:void 0,className:v.anchorStyle},f.createElement(Ul.a,{className:v.primaryButton,text:i,onClick:void 0})))},Gl=!1,Jl=!1,Yl=function(e){var t=e.tenantName,n=e.algoItem,i=e.id,o=e.subscription,a=e.hasNoDecorationContent,r=e.onPopupButtonClick,c=e.logOnClick,l=e.logOnHover,s=e.logOnClose,u=e.BrandMasthead,d=e.bubbleClassName,b=e.attachEventListener,g=Object(mn.__read)(f.useState(!1),2),v=g[0],h=g[1],O=Object(mn.__read)(f.useState(!1),2),j=O[0],E=O[1],x=t&&t.length<18?t:Wl(),S=f.useRef(null),C=f.useRef(null),y=function(e){h(e),e||(Gl=!1)},_=function(e){E(e),Jl=e},L=f.useCallback((function(){var e=!Gl||!v;y(e),c&&c(e),Gl=e}),[y,Gl,v,c]),M=function(e){"Esc"!==e.key&&"Escape"!==e.key||y(!1)},I=f.useCallback((function(){Gl||v||Jl||W&&z||(l&&l(!0),_(!0),setTimeout((function(){l&&l(!1),_(!1)}),4e3))}),[Gl,_]);f.useEffect((function(){return window.addEventListener("keydown",M),function(){window.removeEventListener("keydown",M)}}),[]);var F=f.useCallback((function(){Gl||v||(y(!0),l&&l(!0))}),[Gl,y]),P=f.useCallback((function(e){var t,i,o,a;Gl||!v||Object(V.d)(null==e?void 0:e.relatedTarget,null===(t=null==n?void 0:n.getElementsByClassName("b_algo_bfb_deco_popup"))||void 0===t?void 0:t[0])||Object(V.d)(null==e?void 0:e.relatedTarget,null===(a=null===(o=null===(i=null==n?void 0:n.getElementsByClassName("b_algo_bfb_deco"))||void 0===i?void 0:i[0])||void 0===o?void 0:o.firstElementChild)||void 0===a?void 0:a.firstElementChild)||(y(!1),l&&l(!1))}),[Gl,y]);f.useEffect((function(){function e(e){v&&(e&&e.target&&S.current&&C.current&&(Object(V.d)(e.target,S.current)||Object(V.d)(e.target,C.current))||(y(!1),s&&s(!0),Gl=!1))}return document.addEventListener("mouseup",e),function(){document.removeEventListener("mouseup",e)}}),[S.current,C.current,v,y,Gl]);var A=Object(p.a)(),B=Object(Z.e)(),R=Object(k.a)(),D=Object(w.c)(),H=Object(w.d)(),W="Small"===D,z="Bing"===H,K=Object(Di.e)(),Q=Object(T.useSelector)(N.L),q=Object(Z.b)(),U=W?100:50,G=Sl(A,B,Q?q:void 0,void 0,void 0,void 0,void 0,v,j,void 0);if(f.useEffect((function(){o&&n&&(Object(Ne.g)(R,i,"Enterprise_Subscription_Impression","AlgoDecoration",D),b())}),[R,D,K,o]),f.useEffect((function(){Il.render(f.createElement((function(){return f.createElement(Ml.a,null,(function(e){var t,n,i;return f.createElement(Nl.a,{context:e},f.createElement("div",{ref:C,className:G.bubbleWrapper},f.createElement(Ll.a,{isSmall:W,className:Object(Mn.a)(G.infoBubble,d),targetHeight:(null===(t=S.current)||void 0===t?void 0:t.offsetHeight)||void 0,targetWidth:(null===(n=S.current)||void 0===n?void 0:n.offsetWidth)?(null===(i=S.current)||void 0===i?void 0:i.offsetWidth)-U:void 0,isLeftAligned:!0,isTriangleAbsent:!1,noPadding:!0,onMouseEnter:F,onMouseLeave:P},function(e,t,n){return f.createElement(Vl,{setVisibility:t,setIsPopupFading:n,title:zl({tenant:x}),details:Al(),buttonText:Fl(),url:Object(Tl.c)(null==o?void 0:o.providerAccessHelpUrl)?null==o?void 0:o.providerAccessUrl:null==o?void 0:o.providerAccessHelpUrl,BrandMasthead:u,onClick:r,onClose:s})}(0,y,_))))}))}),null),null==n?void 0:n.getElementsByClassName("b_algo_bfb_deco_popup")[0])})),(null==n?void 0:n.getElementsByTagName("a")[0]).onmouseenter=I,o&&n){var J=f.createElement(f.Fragment,null,f.createElement("span",{className:G.arrowButton},Pl()),f.createElement("span",{className:G.tenantLabel},Kl({tenant:x})));return f.createElement(f.Fragment,null,f.createElement("div",{ref:S,className:G.buttonContainer,role:"group",onMouseEnter:F,onMouseLeave:P},f.createElement("button",{"aria-expanded":v,tabIndex:0,onClick:L,onKeyPress:function(e){Object(m.o)(e,L)},"aria-label":Pl(),className:G.customButton},J)),f.createElement(Ba.a,{className:G.splitter,isLarge:!0}))}return a(n),null},Xl=!1,$l=function(e){var t=e.tenantName,n=e.algoItem,i=e.id,o=e.hasNoDecorationContent,a=e.BrandMasthead,r=e.bubbleClassName,c=e.logOnClick,l=e.logOnHover,s=e.logOnClose,u=e.attachEventListener,d=Object(mn.__read)(f.useState(!1),2),b=d[0],g=d[1],v=t&&t.length<18?t:Wl(),h=f.useRef(null),O=f.useRef(null),j=function(e){g(e),e||(Xl=!1)},E=f.useCallback((function(){var e=!Xl||!b;j(e),c&&c(e),Xl=e}),[j,Xl,b,c]),x=function(e){"Esc"!==e.key&&"Escape"!==e.key||j(!1)};f.useEffect((function(){return window.addEventListener("keydown",x),function(){window.removeEventListener("keydown",x)}}),[]);var S=f.useCallback((function(){Xl||b||(j(!0),l&&l(!0))}),[Xl,j]),C=f.useCallback((function(e){var t,i,o,a;Xl||!b||Object(V.d)(null==e?void 0:e.relatedTarget,null===(t=null==n?void 0:n.getElementsByClassName("b_algo_bfb_deco_popup"))||void 0===t?void 0:t[0])||Object(V.d)(null==e?void 0:e.relatedTarget,null===(a=null===(o=null===(i=null==n?void 0:n.getElementsByClassName("b_algo_bfb_deco"))||void 0===i?void 0:i[0])||void 0===o?void 0:o.firstElementChild)||void 0===a?void 0:a.firstElementChild)||(j(!1),l&&l(!1))}),[Xl,j]);f.useEffect((function(){function e(e){b&&(e&&e.target&&h.current&&O.current&&(Object(V.d)(e.target,h.current)||Object(V.d)(e.target,O.current))||(j(!1),s&&s(!0),Xl=!1))}return document.addEventListener("mouseup",e),function(){document.removeEventListener("mouseup",e)}}),[h.current,O.current,b,j,Xl]);var y=Object(p.a)(),_=Object(Z.e)(),L=Object(k.a)(),M=Object(w.c)(),I=Object(Di.e)(),F=Object(T.useSelector)(N.L),P=Object(Z.b)(),A="Small"===M?100:50,B=Sl(y,_,F?P:void 0,!0,void 0,void 0,void 0,b);if(f.useEffect((function(){n&&(Object(Ne.h)(L,i,"Enterprise_Suggestion_Impression","AlgoDecoration",M),u())}),[L,M,I]),f.useEffect((function(){Il.render(f.createElement((function(){return f.createElement(Ml.a,null,(function(e){var t,n,i,o;return f.createElement(Nl.a,{context:e},f.createElement("div",{ref:O,className:B.bubbleWrapper},f.createElement(Ll.a,{isSmall:!1,className:Object(Mn.a)(B.infoBubble,r),targetHeight:(null===(t=h.current)||void 0===t?void 0:t.offsetHeight)||void 0,targetWidth:(null===(n=h.current)||void 0===n?void 0:n.offsetWidth)?(null===(i=h.current)||void 0===i?void 0:i.offsetWidth)-A:void 0,isLeftAligned:!0,isTriangleAbsent:!1,noPadding:!0,onMouseEnter:S,onMouseLeave:C},(o=j,f.createElement(Vl,{setVisibility:o,title:Bl({tenant:v}),details:Rl({tenant:v}),buttonText:Fl(),BrandMasthead:a,onClose:s})))))}))}),null),null==n?void 0:n.getElementsByClassName("b_algo_bfb_deco_popup")[0])})),!n)return o(n),null;var R=f.createElement(f.Fragment,null,f.createElement("span",{className:B.arrowButton},Dl()),f.createElement("span",{className:B.tenantLabel},ql({tenant:v})));return f.createElement(f.Fragment,null,f.createElement("div",{ref:h,className:B.buttonContainer,role:"group",onMouseEnter:S,onMouseLeave:C},f.createElement("button",{"aria-expanded":b,tabIndex:0,onClick:E,onKeyPress:function(e){Object(m.o)(e,E)},"aria-label":Dl(),className:B.customButton},R)))},Zl=function(e){var t=e.id,n=e.tenantName,i=e.attachEventListener,o=Object(p.a)(),a=Object(k.a)(),r=Object(w.c)(),c=Object(Z.e)(),l=Object(Di.e)(),s=Sl(o,c,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,!0);f.useEffect((function(){Object(Ne.n)(a,t,"LinkedIn_AlgoDecoration_Impression","AlgoDecoration",r),i()}),[a,r,l]);var u=n&&n.length<18?n:Wl(),d=f.createElement(f.Fragment,null,f.createElement("span",{className:s.arrowButton},Hl()),f.createElement("span",{className:s.tenantLabel},Ql({tenant:u})));return f.createElement(f.Fragment,null,f.createElement("div",{className:s.buttonContainer,role:"group"},f.createElement("div",{tabIndex:0,"aria-label":Hl(),className:s.customButton},d)),f.createElement(Ba.a,{className:s.splitter,isLarge:!0}))},es=function(e){var t,n,i,o,a,r=e.algoItem,c=e.index,l=e.hasNoDecorationContent,s=e.BrandMasthead,u=e.isCouponsOrRebatesDecorationEnabled,d=Object($.d)(),b=Object(T.useSelector)((function(e){return xl(e)})),m=pl().subscriptionMap,g=Ol().suggestion,v=Object(_.db)(),h=Object(_.fb)(),O=Object(_.h)(),j=Object(_.z)(),E=Object(_.A)(),x=Object(p.a)(),S=Object(Z.e)(),C=Object(w.r)(),y=Object(T.useSelector)(N.L),L=Object(Z.b)(),M=y?L:void 0,I=Object(k.a)(),F=Object(w.c)(),P="Small"===F,A=P?-1:18,B=Object(Di.e)(),R=c.toString(),D=Object(mn.__read)(f.useState(!1),2),H=D[0],W=D[1];if(!v&&!h&&!E)return l(r),null;var z=function(e,t){var n=function(e,t){var n,i;if(t){var o=null==e?void 0:e.getElementsByClassName("b_algoheader")[0],a=null==o?void 0:o.getElementsByTagName("a")[0];return null==a?void 0:a.href}var r=null==e?void 0:e.getElementsByTagName("h2"),c=null===(n=null==r?void 0:r[0])||void 0===n?void 0:n.getElementsByTagName("a");return null===(i=null==c?void 0:c[0])||void 0===i?void 0:i.href}(e,t);if(n){var i,o="";try{o=new URL(n).hostname}catch(e){var a=n.split(/[/?#]/);o=n.indexOf("//")>-1?a[2]:a[0]}finally{i=o?o.split(":")[0].replace("www.",""):void 0;var r=n.substring(n.indexOf(o)+o.length);return{url:n,domain:i,relativeUrl:r}}}}(r,P);if(!z||!z.domain)return null;var K=m&&m[z.domain],Q=function(e,t,n,i,o,a,r,c,l){var s=o&&kl(e,n,t,o,l);return s?{answer:s,eventScope:"EnterpriseSubscription"}:(_c(t.url)===_c(null==a?void 0:a.url)?a:void 0)?{eventScope:"EnterpriseSuggestion"}:wl(e,i,t,c,r)?{eventScope:"LinkedInDecoration"}:void 0}(r,z,v,E,K,g,b,d,u);if(!Q)return null;var q=Q.eventScope,U=null===(t=r.getElementsByTagName("p"))||void 0===t?void 0:t[0],V=null===(n=r.getElementsByClassName("b_algo_bfb_deco_popup"))||void 0===n?void 0:n[0],G=null===(i=r.getElementsByClassName("b_algo_bfb_deco"))||void 0===i?void 0:i[0];if(U.style.maxHeight="fit-content","EnterpriseSuggestion"===q&&!H){var J=null===(o=r.getElementsByClassName("b_caption"))||void 0===o?void 0:o[0];null===(a=J.parentNode)||void 0===a||a.insertBefore(G,J.nextSibling),W(!0)}u&&(U.style.display="inline");var Y=G.getBoundingClientRect().left-V.getBoundingClientRect().left+A,X=G.getBoundingClientRect().top-V.getBoundingClientRect().top+28,ee=Sl(x,S,M,void 0,void 0,Y,X,void 0,void 0,C),te=function(){!function(e,t,n,i,o){var a={cardType:"AlgoDecoration",clientSize:t,eventScope:n,traceId:i,target:o};Object(Dt.l)(e,{eventId:"Algo_Decoration_Url_Click",properties:a})}(I,F,q,B,R)},ne={tenantName:d,algoItem:r,id:R,hasNoDecorationContent:l,BrandMasthead:s,bubbleClassName:ee.bubbleContainer,logOnClick:function(e){return function(e,t,n,i,o,a){var r=a?"Algo_Decoration_Popup_Open_BannerClick":"Algo_Decoration_Popup_Close_BannerClick",c={cardType:"AlgoDecoration",clientSize:t,eventScope:n,traceId:i,target:o};Object(Dt.l)(e,{eventId:r,properties:c})}(I,F,q,B,R,e)},logOnHover:function(e){return function(e,t,n,i,o,a){var r=a?"Algo_Decoration_Popup_Open_Hover":"Algo_Decoration_Popup_Close_Hover",c={cardType:"AlgoDecoration",clientSize:t,eventScope:n,traceId:i,target:o};Object(Dt.l)(e,{eventId:r,properties:c})}(I,F,q,B,R,e)},logOnClose:function(e){return function(e,t,n,i,o,a){var r=a?"Algo_Decoration_Popup_Close_ExternalClick":"Algo_Decoration_Popup_Close_CloseButtonClick",c={cardType:"AlgoDecoration",clientSize:t,eventScope:n,traceId:i,target:o};Object(Dt.l)(e,{eventId:r,properties:c})}(I,F,q,B,R,e)},attachEventListener:function(){return _l(r,te)}};switch(q){case"EnterpriseSubscription":return f.createElement(Yl,Object(mn.__assign)({},ne,{subscription:Q.answer,onPopupButtonClick:function(){!function(e,t,n,i,o){var a={cardType:"AlgoDecoration",clientSize:t,eventScope:n,traceId:i,target:o};Object(Dt.l)(e,{eventId:"Algo_Decoration_Popup_GetAccessClick",properties:a})}(I,F,q,B,R)}}));case"LinkedInDecoration":return j?f.createElement(Cl,{id:R,decorationType:"LinkedInDecoration",attachEventListener:function(){return _l(r,te)}}):f.createElement(Zl,{id:R,tenantName:d,attachEventListener:function(){return _l(r,te)}});case"EnterpriseSuggestion":return O?f.createElement(Cl,{id:R,decorationType:"EnterpriseSuggestion",attachEventListener:function(){return _l(r,te)}}):f.createElement($l,Object(mn.__assign)({},ne));default:return null}};var ts=function(e){var t=null==e?void 0:e.getElementsByClassName("b_attribution")[0],n=null==e?void 0:e.getElementsByClassName("b_deco")[0];if(n&&t){Il.unmountComponentAtNode(n);try{t.removeChild(n)}catch(e){Object(c.b)(e)}}};function ns(){var e=document.querySelectorAll("li.b_algo");Object(kc.a)(e,(function(e,t){!function(e,t){var n,i,o,a=null===(n=e.getElementsByTagName("p"))||void 0===n?void 0:n[0];if(a){var r=document.createElement("span");r.className="b_algo_bfb_deco";var c=document.createElement("div");c.className="b_algo_bfb_deco_popup",e.insertBefore(c,e.childNodes[0]),a.insertBefore(r,a.childNodes[0]);var l=a.firstElementChild,s=!(!(null===(i=e.getElementsByClassName("cp_anno"))||void 0===i?void 0:i[0])&&!(null===(o=e.getElementsByClassName("rebateContainer"))||void 0===o?void 0:o[0]));null!==l&&Il.render(f.createElement(Qe.a,null,f.createElement(es,{algoItem:e,index:t,hasNoDecorationContent:ts,BrandMasthead:dr.a,isCouponsOrRebatesDecorationEnabled:s})),l)}}(e,t)}))}var is=n(1217),os=n(1349),as=n(546),rs=n(547),cs=function(e,t,n,i){return new(n||(n=r.a))((function(o,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function c(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}l((i=i.apply(e,t||[])).next())}))};function ls(){return cs(this,void 0,void 0,o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ti.a.startMSBAnswerProfiling(),t={all:{prefetch:as.u},isMainlineQFFileHeroEnabled:Object(rs.L)()},i=t,n={reduxExtensions:Object(Qc.a)({stores:[Fc.b,Pc.a,Ic.b,Kc.c,Tc.b]},Object(qc.a)(),cl(),(null==i?void 0:i.isMainlineQFFileHeroEnabled)?{initialize:nl,stores:[Gc.a]}:void 0,Object(Sc.b)(null==i?void 0:i.all),{stores:[Mc,yc]}),searchEntityPlugins:{Message:Object(Oc.a)(),People:Object(jc.a)(),EnterpriseLearning:{entityType:"EnterpriseLearning",components:{},redux:{selectors:{getResults:pa},actionCreators:{fetchResults:ya},stores:[Ca]}},Event:Object(hc.a)(),MeetingRoomProposal:Object(hc.b)(),Acronym:Object(gc.a)(),Topic:Object(Ec.b)(),TuringQnA:Object(xc.a)()},restUtilPlugins:{PersonPhoto:Object(zc.a)(),FloorPlan:Object(Ac.a)(),GroupMembers:Object(Bc.a)(),GroupPhoto:Object(Rc.a)(),PersonGroups:Object(Hc.a)(),PersonCalendar:Object(Dc.a)(),PersonListDetails:Object(Wc.a)(),AssignmentInfo:Object(vc.a)()}},e.next=5,Object(os.a)(us,"Serp",n);case 5:if(ds(),!Object(rs.N)()){e.next=9;break}return e.next=9,ss();case 9:case"end":return e.stop()}var i}),e)})))}function ss(){return cs(this,void 0,void 0,o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(rs.F)();case 2:t=e.sent,Object(rs.J)()?t?Il.render(f.createElement(Ue,null),t):Object(c.a)("BingAtWork context region answer was not placed"):Object(c.a)("BingAtWork context region component disabled on non-1st page");case 4:case"end":return e.stop()}}),e)})))}function us(e,t){return cs(this,void 0,void 0,o.a.mark((function n(){var i,a;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(Object(rs.J)()){n.next=3;break}return Object(c.a)("BingAtWork component disabled on non-1st page"),n.abrupt("return");case 3:if(e){n.next=6;break}return n.abrupt("return");case 6:return i=new Error("MSB: root element was not found for MainlineInitializer"),n.next=9,Object(rs.p)(t,i);case 9:if(a=n.sent){n.next=13;break}throw ft(void 0,!1),i;case 13:Il.render(f.createElement(fc,{query:e}),a),Object(rs.h)()&&ns();case 15:case"end":return n.stop()}}),n)})))}function ds(){var e=this;Object(is.a)((function(t,n,i,a){return cs(e,void 0,void 0,o.a.mark((function e(){var i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(c.a)("handleAjaxSerp on mainline",{eventName:t,relativeUrl:n,isPersistentAjaxRequest:a}),"ajax.load"!==t||!a){e.next=8;break}return Object(c.a)("handleAjaxSerp on mainline, processing persistent ajax"),i=new Error("MSB: root element was not found for MainlineInitializer's prepareAjaxSerp"),e.next=6,Object(rs.p)(os.b,i);case 6:e.sent&&Object(c.a)("handleAjaxSerp on mainline, setting up mainline features");case 8:case"end":return e.stop()}}),e)})))}))}}}]);